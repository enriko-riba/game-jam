(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{128:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(6),s=function(){function t(){}return t.IsAtlas=function(t){return t.frame.width!=t.baseTexture.width||t.frame.height!=t.baseTexture.height},t.resourceCache={},t.Get=function(e,i){void 0===i&&(i=!1);var s=e.indexOf(".json@"),a=s>0?e.substr(s+6):e,o=s>0?e.substr(0,s+5):e;t.resourceCache[o]||(t.resourceCache[o]=n.PIXI.loader.resources[o],t.resourceCache[o].spritesheet.baseTexture.mipmap=i,t.resourceCache[o].spritesheet.baseTexture.scaleMode=n.PIXI.SCALE_MODES.LINEAR);var r=t.resourceCache[o];if(!r)return console.error("Resource:'"+e+"' not found!"),null;switch(r.loadType){case 1:return r.textures[a];case 2:return r.texture}return console.error("Resource:'"+e+"' unknown load type!",r),null},t}();e.TextureLoader=s},129:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,s=i(5),a=i(0),o=i(43),r=i(21);!function(t){t[t.Texture=0]="Texture",t[t.Filter=1]="Filter"}(n=e.OutlineMode||(e.OutlineMode={}));var u=function(t){function e(e,i,s,a,o){void 0===i&&(i=0),void 0===s&&(s=0),void 0===a&&(a=128),void 0===o&&(o=32);var r=t.call(this)||this;return r._outlineMode=n.Filter,r._isHighlighted=!1,r._isPressed=!1,r._isDisabled=!1,r._isClickStarted=!1,r.requestedWidth=0,r.requestedHeight=0,r.onButtonDown=function(){r._isDisabled||(r._isClickStarted=!0,r.texture=r.textureDown)},r.onButtonUp=function(t){r._isDisabled||(r._isClickStarted&&(r._isClickStarted=!1,r.onClickHandler(t)),r.applyTexture())},r.onButtonUpOutside=function(){r._isDisabled||(r.applyTexture(),r._isClickStarted=!1)},r.onButtonOver=function(t){r._isDisabled||(r.texture=r.textureHighlight,r.mouseover&&r.mouseover(t))},r.onButtonOut=function(t){r._isDisabled||(r._isClickStarted=!1,r.applyTexture(),r.mouseout&&r.mouseout(t))},r.position.set(i||0,s||0),r.requestedHeight=o,r.requestedWidth=a,r.setTexture(e),r.buttonMode=!1,r.interactive=!0,r.cursor="hover",r.on("pointerdown",r.onButtonDown),r.on("pointerup",r.onButtonUp),r.on("pointerupoutside",r.onButtonUpOutside),r.on("pointerover",r.onButtonOver),r.on("pointerout",r.onButtonOut),r.isPressed=!1,r}return s.__extends(e,t),Object.defineProperty(e.prototype,"outlineMode",{get:function(){return this._outlineMode},set:function(t){this._outlineMode=t,this.filters=this._outlineMode==n.Filter?[new o.OutlineFilter(1,this._outlineColor,.5)]:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"outlineColor",{get:function(){return this._outlineColor},set:function(t){this._outlineColor=t,this.filters=this._outlineMode==n.Filter?[new o.OutlineFilter(1,this._outlineColor,.5)]:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"disabled",{get:function(){return this._isDisabled},set:function(t){this._isDisabled=t,this.cursor=t?"":"hover",this.applyTexture()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isPressed",{get:function(){return this._isPressed},set:function(t){this._isPressed=t,this.applyTexture()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isHighlighted",{get:function(){return this._isHighlighted},set:function(t){this._isHighlighted=t,this.applyTexture()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"text",{get:function(){return this._text},set:function(t){if(this._text&&this.removeChild(this._text),this._text=t,this._text){this._text.anchor.set(.5,.5);var e=this.width/this.scale.x/2,i=this.height/this.scale.y/2;this._text.position.set(e,i),this.addChild(this._text)}},enumerable:!0,configurable:!0}),e.prototype.onClickHandler=function(t){this.onClick?this.onClick(t):console.warn("onClick() empty, did you forget to attach a handler?")},e.prototype.applyTexture=function(){this._isDisabled?(this.texture=this.textureUp,this.tint=6316128):this._isHighlighted?(this.texture=this.textureHighlight,this.tint=6710886):(this.texture=this._isPressed?this.textureDown:this.textureUp,this.tint=16777215)},e.prototype.performClick=function(t){this.onClickHandler(t)},e.prototype.setTexture=function(t){var e=r.TextureLoader.Get(t);e.baseTexture.scaleMode=a.SCALE_MODES.NEAREST;var i=e.height/3,n=e.width;this.textureUp=new a.Texture(e.baseTexture,new a.Rectangle(e.frame.x,e.frame.y,n,i)),this.textureHighlight=new a.Texture(e.baseTexture,new a.Rectangle(e.frame.x,e.frame.y+1*i,n,i)),this.textureDown=new a.Texture(e.baseTexture,new a.Rectangle(e.frame.x,e.frame.y+2*i,n,i));var s=(this.requestedWidth||n)/n,o=(this.requestedHeight||i)/i;this.scale.set(s,o),this.applyTexture()},e}(a.Sprite);e.Button=u},130:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(0),s=i(32);!function(t){t[t.GLOBAL=0]="GLOBAL",t[t.MENU=1]="MENU",t[t.IN_GAME=2]="IN_GAME",t[t.CUSTOM1=3]="CUSTOM1",t[t.CUSTOM2=4]="CUSTOM2",t[t.CUSTOM3=5]="CUSTOM3",t[t.CUSTOM4=6]="CUSTOM4",t[t.CUSTOM5=7]="CUSTOM5"}(e.State||(e.State={}));var a=function(){function t(t,e,i,a){var r=this;this.currentScene=null,this.scenes=[],this.startTime=null,this.animationFrameHandle=-1,this.Destroy=function(){cancelAnimationFrame(r.animationFrameHandle),r.currentScene&&r.currentScene.pause(),r.scenes.forEach(function(t){r.RemoveScene(t)}),r.renderer.destroy(!0)},this.resizeHandler=function(){var t=r.sceneResizer.GetAvailableSize(),e=r.sceneResizer.GetAspectRatio(),i=r.sceneResizer.CalculateSize(t,e);r.renderer.resize(i.x,i.y),r.currentScene&&(r.currentScene.scale.set(r.sceneResizer.CalculateScale(i)),r.currentScene.onResize()),r.masterHudOverlay&&r.masterHudOverlay.scale.set(r.sceneResizer.CalculateScale(i))},this.render=function(t){if(r.animationFrameHandle=requestAnimationFrame(r.render),s.update(t),r.currentScene&&!r.currentScene.isPaused()){r.startTime||(r.startTime=t);var e=t-r.startTime;e>50&&(e=50),r.currentScene.onUpdate(e),r.startTime=t,r.renderer.render(r.masterContainer,void 0,r.currentScene.clear)}},this.designWidth=t,this.designHeight=e,this.sceneResizer=a||new o(this.designWidth,this.designHeight),this.masterContainer=new n.Container,i||(i={antialias:!1,roundPixels:!0,backgroundColor:74037,transparent:!0}),this.renderer=n.autoDetectRenderer(t,e,i),this.renderer.autoResize=!0,this.render.textureGC&&(this.render.textureGC.mode=n.GC_MODES.AUTO),window.removeEventListener("resize",this.resizeHandler),window.addEventListener("resize",this.resizeHandler,!0),this.render(0)}return Object.defineProperty(t.prototype,"Renderer",{get:function(){return this.renderer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"CurrentScene",{get:function(){return this.currentScene},enumerable:!0,configurable:!0}),t.prototype.AddScene=function(t){this.scenes.push(t),t.sceneManager=this},t.prototype.RemoveAllScenes=function(){this.scenes.forEach(function(t){t.sceneManager=void 0,t.onDestroy(!0)}),this.scenes=[],this.currentScene=null},t.prototype.RemoveScene=function(t){this.scenes=this.scenes.filter(function(e,i,n){return e!==t}),t.sceneManager=void 0},t.prototype.HasScene=function(t){var e=this.scenes.filter(function(e){return e.Name===t});return e&&e.length>0},t.prototype.GetScene=function(t){var e=this.scenes.filter(function(e){return e.Name===t});if(!e||0===e.length)throw Error("Scene: '"+t+"' not found");if(e.length>1)throw Error("Multiple scenes: '"+t+"' found");return e[0]},t.prototype.ActivateScene=function(t){var e;if("string"==typeof t){var i=this.scenes.filter(function(e){return e.Name===t});if(!i||0===i.length)throw Error("Scene: '"+t+"' not found");if(i.length>1)throw Error("Multiple scenes: '"+t+"' found");e=i[0]}else e=t;this.currentScene&&this.currentScene!==e&&(console.log("DeactivateScene "+this.currentScene.Name),this.currentScene.onDeactivate()),console.log("ActivateScene "+e.Name),this.startTime=null,this.lastScene=this.currentScene!=e?this.currentScene:this.lastScene,this.currentScene=e,this.renderer.backgroundColor=e.BackGroundColor,this.resizeHandler(),e.onActivate(),this.masterContainer.removeChildren(),this.masterContainer.addChild(this.currentScene),this.masterHudOverlay&&this.masterContainer.addChild(this.masterHudOverlay),n.settings.RESOLUTION=window.devicePixelRatio},t.prototype.ActivatePreviousScene=function(){this.ActivateScene(this.lastScene)},Object.defineProperty(t.prototype,"MasterHudOverlay",{get:function(){return this.masterHudOverlay},set:function(t){this.masterHudOverlay=t,this.masterContainer.removeChildren(),this.masterContainer.addChild(this.currentScene),this.masterHudOverlay&&this.masterContainer.addChild(this.masterHudOverlay),this.resizeHandler()},enumerable:!0,configurable:!0}),t.prototype.CaptureScene=function(){console.log("Capturing scene, width: "+this.renderer.width+", height: "+this.renderer.height);var t=n.RenderTexture.create(this.renderer.width,this.renderer.height);return this.renderer.render(this.currentScene,t),t},t}();e.SceneManager=a;var o=function(){function t(t,e){this.designedWidth=t,this.designedHeight=e}return t.prototype.GetAvailableSize=function(){return{x:window.innerWidth,y:window.innerHeight}},t.prototype.GetAspectRatio=function(){return this.designedWidth/this.designedHeight},t.prototype.CalculateSize=function(t,e){var i,n;return i=Math.floor(e*t.y),n=Math.floor(window.innerHeight),{x:Math.min(i,t.x),y:Math.min(n,t.y)}},t.prototype.CalculateScale=function(t){return t.x/this.designedWidth},t}();e.DefaultResizer=o},131:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(5),s=function(t){function e(e,i){var n=t.call(this)||this;return n.paused=!1,n.hudScene=null,n._clear=!0,n.sceneManager=e,n.backgroundColor=0,n.Name=i,n}return n.__extends(e,t),e.prototype.onActivate=function(){},e.prototype.onDeactivate=function(){},e.prototype.onResize=function(){},e.prototype.onUpdate=function(t){},e.prototype.onDestroy=function(t){},Object.defineProperty(e.prototype,"BackGroundColor",{get:function(){return this.backgroundColor},set:function(t){this.backgroundColor=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"HudOverlay",{get:function(){return this.hudScene},set:function(t){if(this.hudScene&&this.removeChild(this.hudScene),this.hudScene=t,this.hudScene){var e=this.children.length;this.addChildAt(this.hudScene,e)}},enumerable:!0,configurable:!0}),e.prototype.addChild=function(e){var i=t.prototype.addChild.call(this,e);if(this.hudScene){var n=this.children.length-1;this.setChildIndex(this.hudScene,n)}return i},e.prototype.addChildAt=function(e,i){var n=t.prototype.addChildAt.call(this,e,i);if(this.hudScene){var s=this.children.length-1;this.setChildIndex(this.hudScene,s)}return n},e.prototype.pause=function(){this.paused=!0},e.prototype.resume=function(){this.paused=!1},e.prototype.isPaused=function(){return this.paused},Object.defineProperty(e.prototype,"clear",{get:function(){return this._clear},set:function(t){this._clear=t},enumerable:!0,configurable:!0}),e}(i(0).Container);e.Scene=s},132:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(5);function s(t,e){var i=null,s=null,a={name:null,displayObject:{typeName:"Sprite"},body:null,trigger:null,drop:null},o=t.filter(function(t){return t.name===e.template});o&&o.length>0&&(a=o[0]),i=n.__assign({},a.displayObject,e),a.drop&&(i=n.__assign({},i,{drop:a.drop})),a.body&&(s=a.body);var r=void 0;return(a.trigger||i.trigger)&&(r=n.__assign({},a.trigger,i.trigger)),{templateName:a.name,doDef:i,bdDef:s,trigger:r}}function a(t){for(var e={},i=[],n=0;n<t.length;n++)e[t[n]]||(e[t[n]]=!0,i.push(t[n]));return i}e.GetLevelAssets=function(t,e){for(var i=[],o=void 0,r=0;r<t.levels.length;r++)if(t.levels[r].id===e){o=t.levels[r];break}if(o){o.parallax.forEach(function(t){i=i.concat(t.textures)}),o.assets&&o.assets.length>0&&(i=i.concat(o.assets));var u=t.templates.concat(o.map.templates);o.map.templates.forEach(function(t){if(!t.type||"spawn_point"!==t.type){var e=t.displayObject;e.texture&&("string"==typeof e.texture?i.push(e.texture):i=i.concat(e.texture)),e.sequences&&e.sequences.forEach(function(t){i.push(t.texture)})}}),o.map.entities.forEach(function(t){var e=s(u,t);e.doDef.texture&&("string"==typeof e.doDef.texture?i.push(e.doDef.texture):i=i.concat(e.doDef.texture)),e.doDef.sequences&&e.doDef.sequences.forEach(function(t){i.push(t.texture)})}),o.map.NPC=o.map.NPC||[],o.map.NPC.forEach(function(t){if(t.type&&"spawn_point"===t.type)   ;else{var e=t;e.attack&&(i=i.concat(e.attack));var s=u.filter(function(t){return t.name===e.template});if(s&&s.length>0){var a=s[0],o=n.__assign({},a.displayObject,e);o.texture&&("string"==typeof o.texture?i.push(o.texture):i=i.concat(o.texture)),o.attack&&(i=i.concat(o.attack)),o.sequences&&o.sequences.forEach(function(t){t.texture&&i.push(t.texture)})}}})}return i=a(i=i.map(function(t){var e=t.indexOf(".json@");return e>0?t.substr(0,e+5):t}))},e.getEntityDefinition=s,e.getUniqueItems=a},15:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SCENE_WIDTH=1920,e.SCENE_HEIGHT=1080,e.SCENE_HALF_WIDTH=e.SCENE_WIDTH/2,e.SCENE_HALF_HEIGHT=e.SCENE_HEIGHT/2,e.BTN_WIDTH=120,e.BTN_HEIGHT=60,e.MENU_LINE_HEIGHT=60,e.GUI_FONT="Orbitron",e.SCENE_BACKCOLOR=1122867,e.ANIMATION_FPS_NORMAL=14,e.ANIMATION_FPS_SLOW=4,e.BTN_STYLE={align:"center",padding:0,fontSize:28,fontFamily:e.GUI_FONT,fill:4652029,strokeThickness:1,stroke:0},e.TEXT_STYLE={align:"left",font:"21px Orbitron",tint:15066395},e.MSG_COIN_STYLE={align:"left",font:"22px Orbitron",tint:16711492},e.MSG_HP_STYLE={align:"center",font:"24px Orbitron",tint:16716049},e.MSG_EXP_STYLE={align:"center",font:"24px Orbitron",tint:8700418},e.MSG_WARN_STYLE={align:"center",font:"27px Orbitron",tint:16711697},e.QUEST_ITEM_STYLE={align:"center",padding:0,fontSize:28,fontFamily:"Farsan",fill:8700658,strokeThickness:4,stroke:1118497},e.QUEST_STYLE={align:"left",font:"24px Orbitron",tint:16711628}},160:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(5),s=i(42),a=i(161),o=i(36),r=i(285),u=i(25),l=i(18),c=48,h=function(t){function e(e){var i=t.call(this)||this;return i.textureName=e,i._isDead=!1,i.isLoading=!1,i.attack=function(){var t=i.currentSequence,e=i.fps;o.snd.atkMagic1(),i._direction==l.DirectionH.Left?i.play("latk",e,!1):i.play("ratk",e,!1),i.onComplete=function(n){i.onComplete=null,i.fireBullet(),i.play(t.sequenceName,e)}},i.addAnimations(new s.AnimationSequence("left",i.textureName,[0,1,2],c,c)),i.addAnimations(new s.AnimationSequence("right",i.textureName,[3,4,5],c,c)),i.addAnimations(new s.AnimationSequence("latk",i.textureName,[6,7,8],c,c)),i.addAnimations(new s.AnimationSequence("ratk",i.textureName,[9,10,11],c,c)),i.addAnimations(new s.AnimationSequence("lsquish",i.textureName,[12,13,14,15,16,17],c,c)),i.addAnimations(new s.AnimationSequence("rsquish",i.textureName,[18,19,20,21,22,23],c,c)),i.play("left"),i._direction=l.DirectionH.Left,i}return n.__extends(e,t),Object.defineProperty(e.prototype,"isDead",{get:function(){return this._isDead},set:function(t){t!=this._isDead&&(this._isDead=t,this._isDead&&this.onDeathCallBack&&this.onDeathCallBack())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"onDeath",{get:function(){return this.onDeathCallBack},set:function(t){this.onDeathCallBack=t},enumerable:!0,configurable:!0}),e.prototype.squish=function(t){this.isDead=!0;var e=this._direction==l.DirectionH.Left?"lsquish":"rsquish";this.onComplete=t,this.play(e,12,!1),o.snd.mobSquish()},Object.defineProperty(e.prototype,"direction",{get:function(){return this._direction},set:function(t){this._direction!=t&&(this._direction=t,t===l.DirectionH.Left?this.play("left"):this.play("right"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"attributes",{get:function(){return this._attributes},set:function(t){this._attributes=t},enumerable:!0,configurable:!0}),e.prototype.fireBullet=function(){this.atkTexture.constructor===Array||a.Bullet.emitBullet(this.atkTexture,this.position,u.wp2.playerBody.position,this._attributes[l.AtrType.Atk])},e.prototype.createAI=function(t){switch(t.toLowerCase()){case"basic_static":this._ai=new r.BasicStaticAI(this)}},e.prototype.onUpdate=function(e){t.prototype.onUpdate.call(this,e),this.isDead||this.isLoading||this._ai.onUpdate(e)},e}(s.AnimatedSprite);e.Mob=h},161:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(5),s=i(45),a=i(75),o=i(25),r=i(6),u=i(21),l=function(t){function e(e,i,n,s){var a=t.call(this,e)||this;return a.velocity=i,a.damage=s,a.direction=new PIXI.Point,a.interactionType=666,a.onUpdate=function(){if(!a.isDead){var t=performance.now()/1e3-a.startTime;a.IsDead=a.ttl<t}},a.ttl=n,a.IsDead=!1,a}return n.__extends(e,t),Object.defineProperty(e.prototype,"Direction",{get:function(){return this.direction},set:function(t){var e=t.x*t.x+t.y*t.y;e=1/Math.sqrt(e),this.direction.set(t.x*e,t.y*e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsDead",{get:function(){return this.isDead},set:function(t){t!=this.isDead&&(this.isDead=t,this.isDead?this.body&&(this.body.velocity=[0,0]):(this.startTime=performance.now()/1e3,this.body&&(this.body.position=[this.position.x,this.position.y])),this.isDead&&this.onDeath&&this.onDeath(),this.visible=!this.isDead)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"OnDeath",{get:function(){return this.onDeath},set:function(t){this.onDeath=t},enumerable:!0,configurable:!0}),e.reset=function(){e.bullets=[]},e.bullets=[],e.emitBullet=function(t,i,n,l){var c=e.findDeadBullet();if(!c){(c=new e(u.TextureLoader.Get(t),200,5,l)).anchor.set(.5),c.scale.set(.5,-.5),e.bullets.push(c),r.Global.worldContainer.addChild(c);var h=new s.Circle({radius:c.width/2});h.collisionGroup=a.COL_GRP_BULLET,h.collisionMask=a.COL_GRP_PLAYER|a.COL_GRP_SCENE|a.COL_GRP_GROUND,h.sensor=!0;var d={mass:0,position:[i.x,i.y],angle:0,fixedRotation:!1,angularDamping:0,damping:0},p=new s.Body(d);p.addShape(h),p.setDensity(0),p.gravityScale=0,p.angularVelocity=2,p.collisionResponse=!1,p.type=s.Body.DYNAMIC,p.DisplayObject=c,c.body=p,o.wp2.addBody(p)}c.position=i;var f=n instanceof Float32Array?new PIXI.Point(n[0]-i.x,n[1]-i.y):new PIXI.Point(n.x-i.x,n.y-i.y);return c.Direction=f,c.damage=l,c.IsDead=!1,c.body.velocity[0]=c.Direction.x*c.velocity,c.body.velocity[1]=c.Direction.y*c.velocity,c},e.findDeadBullet=function(){for(var t=0,i=e.bullets.length;t<i;t++){var n=e.bullets[t];if(n.IsDead)return n}return null},e}(PIXI.Sprite);e.Bullet=l},162:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(6),s=i(269),a=["Permanent Marker","Orbitron","Farsan"];console.log("initializing google webfont loader ...",a);try{var o={google:{families:a},active:function(){console.log("fonts preload finished!");var t=n.Global.getScm(),e=new s.BootScene(t);t.AddScene(e),t.ActivateScene(e)}};window.WebFontConfig=o}catch(t){console.log(t)}var r=("https:"===document.location.protocol?"https":"http")+"://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js",u=document.createElement("script");u.src=r,u.type="text/javascript",u.async=!0;var l=document.getElementsByTagName("script")[0];l.parentNode&&l.parentNode.insertBefore(u,l)},18:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.MaxHP=0]="MaxHP",t[t.MaxDust=1]="MaxDust",t[t.RegenHP=2]="RegenHP",t[t.RegenDust=3]="RegenDust"}(e.BaseStatType||(e.BaseStatType={})),function(t){t[t.MaxHP=0]="MaxHP",t[t.HP=1]="HP",t[t.MaxDust=2]="MaxDust",t[t.Dust=3]="Dust",t[t.RegenHP=4]="RegenHP",t[t.RegenDust=5]="RegenDust",t[t.Coins=6]="Coins",t[t.Gold=7]="Gold",t[t.LevelExp=8]="LevelExp",t[t.LevelMaxExp=9]="LevelMaxExp",t[t.TotalExp=10]="TotalExp",t[t.AttributePoints=11]="AttributePoints",t[t.CharacterLevel=12]="CharacterLevel"}(e.StatType||(e.StatType={})),function(t){t[t.LavaBorder=1e3]="LavaBorder",t[t.Lava=1001]="Lava",t[t.Poison=1002]="Poison"}(e.DamageType||(e.DamageType={})),function(t){t[t.HP=0]="HP",t[t.Atk=1]="Atk",t[t.AtkCD=2]="AtkCD",t[t.Def=3]="Def"}(e.AtrType||(e.AtrType={})),function(t){t[t.Left=0]="Left",t[t.Right=1]="Right"}(e.DirectionH||(e.DirectionH={}))},20:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,s=i(5),a=i(0),o=i(264),r=i(21),u=i(15);e.getScm=function(){if(!n){var t={view:document.getElementById("stage"),backgroundColor:0,antialias:!1,transparent:!1,roundPixels:!1,resolution:window.devicePixelRatio};n=new r.SceneManager(u.SCENE_WIDTH,u.SCENE_HEIGHT,t)}return n},e.deleteScm=function(){n&&n.Renderer.destroy(),n=void 0},e.position=new a.Point,e.createParticleEmitter=function(t,e,i){var n={alpha:{start:.8,end:.03},color:{start:"#dcff09",end:"#9f1f1f"},scale:{start:.1,end:.4,minimumScaleMultiplier:1},speed:{start:50,end:3,minimumSpeedMultiplier:1},acceleration:new a.Point,startRotation:{min:0,max:360},rotationSpeed:{min:5,max:20},lifetime:{min:.4,max:1},blendMode:"add",frequency:.01,emitterLifetime:-1,maxParticles:200,pos:new a.Point(0,-24),addAtBack:!1,spawnType:"circle",spawnCircle:{x:0,y:0,r:10}};i&&(n=s.__assign({},n,i));var r=new o.Emitter(t,e,n);return r.emit=!1,r},e.LevelDefinitions={templates:void 0,levels:void 0,quests:void 0}},21:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(42);e.AnimatedSprite=n.AnimatedSprite,e.AnimationSequence=n.AnimationSequence;var s=i(129);e.Button=s.Button,e.OutlineMode=s.OutlineMode;var a=i(68);e.Dictionary=a.Dictionary;var o=i(265);e.KeyboardMapper=o.KeyboardMapper;var r=i(266);e.LinkedList=r.LinkedList;var u=i(267);e.Parallax=u.Parallax;var l=i(131);e.Scene=l.Scene;var c=i(130);e.SceneManager=c.SceneManager,e.DefaultResizer=c.DefaultResizer;var h=i(268);e.Slider=h.Slider;var d=i(128);e.TextureLoader=d.TextureLoader},22:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(20),s=i(33),a=i(44),o=i(18),r=function(){function t(){var e=this;this.baseStats=[],this.attributeStats=[],this.stats=[],this.accumulator=0,this.dpsDecreaseAmount=0,this.hasJumpAttack=!1,this.hasMagicAttack=!1,this.characterLevel=0,this.currentGameLevel=0,this.expForNextLevel=0,this.isBurningBuff=!1,this.buffs=[],this.onUpdate=function(t){for(var i=performance.now()/1e3,n=1e3,a=e.buffs.length;n<a;n++)if(e.buffs[n]&&e.buffs[n]>i){var r=0;switch(n){case o.DamageType.LavaBorder:r=5;break;case o.DamageType.Lava:r=15;break;case o.DamageType.Poison:r=10}var u=.001*t*r;e.dpsDecreaseAmount+=u}if(e.accumulator+=t,e.accumulator>500){if(e.accumulator-=500,e.stats[o.StatType.Dust]<e.stats[o.StatType.MaxDust]){var l=.5*e.stats[o.StatType.RegenDust];e.increaseStat(o.StatType.Dust,l)}if(e.stats[o.StatType.HP]<e.stats[o.StatType.MaxHP]){l=.5*e.stats[o.StatType.RegenHP];e.increaseStat(o.StatType.HP,l)}if(e.dpsDecreaseAmount>=1){var c=Math.floor(e.dpsDecreaseAmount),h={OldValue:e.stats[o.StatType.HP],Amount:-c};s.eventEmitter.emit(s.DAMAGE_TOPIC,h),e.increaseStat(o.StatType.HP,-c),e.dpsDecreaseAmount-=c}}var d=e.isBurningBuff;e.isBurningBuff=e.buffs[o.DamageType.LavaBorder]>i||e.buffs[o.DamageType.Lava]>i,d!==e.isBurning&&s.eventEmitter.emit(s.BURN_TOPIC,{wasBurning:d,isBurning:e.isBurningBuff})},this.scevent={Type:o.StatType.Coins,OldValue:0,NewValue:0,Stats:[]},this.id=0,this.attributeStats[o.BaseStatType.RegenHP]=0,this.attributeStats[o.BaseStatType.RegenDust]=0,this.attributeStats[o.BaseStatType.MaxHP]=0,this.attributeStats[o.BaseStatType.MaxDust]=0,this.stats[o.StatType.Coins]=0,this.stats[o.StatType.Dust]=600,this.stats[o.StatType.TotalExp]=0,this.stats[o.StatType.AttributePoints]=0,this.stats[o.StatType.HP]=120;t.expForLevel[0]=0;for(var i=1;i<1e4;i++)t.expForLevel[i]=t.expForLevel[i-1]+1e3*i;this.rebuildStats()}return Object.defineProperty(t.prototype,"LevelLoader",{get:function(){return this.levelLoader||(this.levelLoader=new a.LevelLoader(n.LevelDefinitions)),this.levelLoader},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isBurning",{get:function(){return this.isBurningBuff},enumerable:!0,configurable:!0}),t.prototype.loadLevel=function(){this.loadUserState(),this.currentLevel=this.LevelLoader.buildLevel(this.currentGameLevel)},t.prototype.saveUserState=function(t){t&&(this.currentGameLevel+=1);this.id,this.stats[o.StatType.Coins],this.stats[o.StatType.Gold],Math.floor(this.stats[o.StatType.Dust]),this.stats[o.StatType.TotalExp],this.stats[o.StatType.AttributePoints],this.stats[o.StatType.HP],this.currentGameLevel},t.prototype.loadUserState=function(){this.id;var t={HP:this.getStat(o.StatType.MaxHP),Exp:this.getStat(o.StatType.TotalExp),Coins:this.getStat(o.StatType.Coins),Dust:this.getStat(o.StatType.MaxDust),Gold:0,AtrPts:0,LastLevel:this.currentGameLevel};console.log("loadUserState() response",t),e.stats.currentGameLevel=t.LastLevel,t.HP<=0&&(t.HP=this.stats[o.StatType.MaxHP]),this.setStat(o.StatType.HP,t.HP),this.setStat(o.StatType.Coins,t.Coins),this.setStat(o.StatType.Gold,t.Gold),this.setStat(o.StatType.Dust,t.Dust),this.setStat(o.StatType.AttributePoints,t.AtrPts),this.setStat(o.StatType.TotalExp,t.Exp),this.rebuildStats()},Object.defineProperty(t.prototype,"HasJumpAtack",{get:function(){return this.hasJumpAttack},set:function(t){this.hasJumpAttack=t},enumerable:!0,configurable:!0}),t.prototype.setStat=function(e,i){this.stats[e]=i,e===o.StatType.TotalExp&&(this.characterLevel=t.findExpLevel(i),this.stats[o.StatType.LevelMaxExp]=t.expForLevel[this.characterLevel+1]-t.expForLevel[this.characterLevel],this.stats[o.StatType.LevelExp]=this.stats[o.StatType.TotalExp]-t.expForLevel[this.characterLevel],this.expForNextLevel=t.expForLevel[this.characterLevel+1]),this.updateEvent(e,i),s.eventEmitter.emit(s.STATCHANGE_TOPIC,this.scevent)},t.prototype.getStat=function(t){return this.stats[t]},t.prototype.increaseStat=function(e,i,n){var a=this.stats[e]+i;n&&a>n&&(a=n),a<0&&(a=0),this.updateEvent(e,a),this.stats[e]=a,e===o.StatType.TotalExp&&(this.stats[o.StatType.LevelExp]=a-t.expForLevel[this.characterLevel],a>=this.expForNextLevel&&(this.characterLevel=t.findExpLevel(a),this.expForNextLevel=t.expForLevel[this.characterLevel+1],this.stats[o.StatType.LevelMaxExp]=this.expForNextLevel-t.expForLevel[this.characterLevel],this.stats[o.StatType.LevelExp]=a-t.expForLevel[this.characterLevel],this.scevent.Type=o.StatType.CharacterLevel,this.scevent.OldValue=this.characterLevel-1,this.scevent.NewValue=this.characterLevel,this.scevent.Stats=this.stats,s.eventEmitter.emit(s.STATCHANGE_TOPIC,this.scevent),a=this.stats[o.StatType.AttributePoints]+5,this.scevent.Type=o.StatType.AttributePoints,this.scevent.OldValue=this.getStat(o.StatType.AttributePoints),this.scevent.NewValue=a,this.setStat(o.StatType.AttributePoints,a),this.scevent.Stats=this.stats,s.eventEmitter.emit(s.STATCHANGE_TOPIC,this.scevent),this.setStat(o.StatType.Dust,this.stats[o.StatType.MaxDust]),this.setStat(o.StatType.HP,this.stats[o.StatType.MaxHP]),this.scevent.Type=e,this.scevent.OldValue=0,this.scevent.NewValue=this.stats[o.StatType.LevelExp],this.scevent.Stats=this.stats)),s.eventEmitter.emit(s.STATCHANGE_TOPIC,this.scevent)},t.findExpLevel=function(e){for(var i=0,n=t.expForLevel.length;i<n;i++)if(e<t.expForLevel[i])return i-1},t.prototype.rebuildStats=function(){this.baseStats[o.BaseStatType.MaxHP]=150+10*this.characterLevel,this.baseStats[o.BaseStatType.MaxDust]=600+50*this.characterLevel,this.baseStats[o.BaseStatType.RegenDust]=2+this.characterLevel/2,this.baseStats[o.BaseStatType.RegenHP]=1+this.characterLevel/2,this.stats[o.StatType.MaxHP]=this.baseStats[o.BaseStatType.MaxHP]*(1+this.attributeStats[o.BaseStatType.MaxHP]/10),this.stats[o.StatType.MaxDust]=this.baseStats[o.BaseStatType.MaxDust]*(1+this.attributeStats[o.BaseStatType.MaxDust]/10),this.stats[o.StatType.RegenHP]=this.baseStats[o.BaseStatType.RegenHP]*(1+this.attributeStats[o.BaseStatType.RegenHP]/10),this.stats[o.StatType.RegenDust]=this.baseStats[o.BaseStatType.RegenDust]*(1+this.attributeStats[o.BaseStatType.RegenDust]/10)},t.prototype.updateEvent=function(t,e){this.scevent.Type=t,this.scevent.OldValue=this.stats[t],this.scevent.NewValue=e,this.scevent.Stats=this.stats},t.expForLevel=[],t}();e.stats=new r},25:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(45),s=i(6),a=i(68),o=i(75),r=function(){return function(t,e){this.BodyA=t,this.BodyB=e}}();e.ContactPair=r;var u=function(){function t(){var t=this;this.contactPairs=[],this.contactWatch=[],this.playerBodyContacts=[],this.fixedTimeStep=1/60,this.beginContact=function(e){var i=null,n=null;if(e.bodyA.shapes[0].collisionGroup===o.COL_GRP_BULLET?(i=e.bodyA,n=e.bodyB):e.bodyB.shapes[0].collisionGroup===o.COL_GRP_BULLET&&(i=e.bodyB,n=e.bodyA),i)t.world.emit({type:"bulletContact",playerHit:n===t.playerBody,bulletBody:i,otherBody:n});else{if(t.playerBody===e.bodyA)return t.playerBodyContacts.push(e.bodyB),void t.world.emit({type:"playerContact",velocity:t.playerBody.velocity,body:e.bodyB});if(t.playerBody===e.bodyB)return t.playerBodyContacts.push(e.bodyA),void t.world.emit({type:"playerContact",velocity:t.playerBody.velocity,body:e.bodyA});var s=t.contactWatch.filter(function(t){return t===e.bodyA.id||t===e.bodyB.id});if(s&&s.length>0){var a=new r(e.bodyA,e.bodyB);t.contactPairs.push(a)}}},this.endContact=function(e){if(!(e.bodyA.shapes[0].collisionGroup===o.COL_GRP_BULLET||e.bodyB.shapes[0].collisionGroup===o.COL_GRP_BULLET)){if(t.playerBody===e.bodyA){var i=t.playerBodyContacts.indexOf(e.bodyB);return t.playerBodyContacts.splice(i,1),void t.world.emit({type:"playerContactEnd",velocity:t.playerBody.velocity,body:e.bodyB})}if(t.playerBody===e.bodyB){i=t.playerBodyContacts.indexOf(e.bodyB);return t.playerBodyContacts.splice(i,1),void t.world.emit({type:"playerContactEnd",velocity:t.playerBody.velocity,body:e.bodyA})}for(var n=-1,s=0;s<t.contactPairs.length;s++){var a=t.contactPairs[s];if(a.BodyA===e.bodyA&&a.BodyB===e.bodyB||a.BodyA===e.bodyB&&a.BodyB===e.bodyA){n=s;break}}n>=0&&t.contactPairs.splice(n,1)}},this.world=new n.World({gravity:[0,-1500]}),this.setupMaterials(),this.ground=new n.Body({mass:0});var e=new n.Plane;e.material=this.materials.get("ground_default"),e.collisionGroup=o.COL_GRP_GROUND,e.collisionMask=o.COL_GRP_SCENE|o.COL_GRP_NPC|o.COL_GRP_PLAYER|o.COL_GRP_BULLET,this.ground.addShape(e),this.world.addBody(this.ground),this.playerBody=new n.Body({mass:42,fixedRotation:!0}),this.playerBody.damping=.001,(e=new n.Circle({radius:24})).collisionGroup=o.COL_GRP_PLAYER,e.collisionMask=o.COL_GRP_GROUND|o.COL_GRP_SCENE|o.COL_GRP_NPC|o.COL_GRP_BULLET,e.material=this.materials.get("player"),this.playerBody.addShape(e),this.world.addBody(this.playerBody),this.world.sleepMode=n.World.BODY_SLEEPING,this.world.on("beginContact",this.beginContact,this),this.world.on("endContact",this.endContact,this)}return t.prototype.clearLevel=function(){for(var t=this.world.bodies,e=t.length-1;e>=0;e--){var i=t[e];i!==this.playerBody&&i!==this.ground&&this.world.removeBody(i)}},Object.defineProperty(t.prototype,"bodies",{get:function(){return this.world.bodies},enumerable:!0,configurable:!0}),t.prototype.on=function(t,e,i){i=i||this,this.world.on(t,e,i)},t.prototype.update=function(t){this.world.step(this.fixedTimeStep,t/1e3),s.Global.position.x=this.playerBody.interpolatedPosition[0],s.Global.position.y=this.playerBody.interpolatedPosition[1]},t.prototype.removeBody=function(t){this.world.removeBody(t)},t.prototype.addBody=function(t){if(t.shapes&&t.shapes.length>0)for(var e=0,i=t.shapes.length;e<i;e++){var n=t.shapes[e];n.materialName&&!n.material&&(n.material=this.materials.get(n.materialName))}this.world.addBody(t)},t.prototype.clearContactsForBody=function(t){if(t!==this.playerBody)for(var e=0;e>-1;){e=-1;for(var i=0;i<this.contactPairs.length;i++){var n=this.contactPairs[i];if(n.BodyA===t||n.BodyB===t){e=i;break}}e>=0&&this.contactPairs.splice(e,1)}else this.playerBodyContacts=[]},t.prototype.getContactsForBody=function(t){for(var e=[],i=0,n=this.contactPairs.length;i<n;i++){var s=this.contactPairs[i];s.BodyA!==t&&s.BodyB!==t||e.push(s)}return e},t.prototype.addContactWatch=function(t){this.contactWatch.push(t.id)},Object.defineProperty(t.prototype,"playerContacts",{get:function(){return this.playerBodyContacts},enumerable:!0,configurable:!0}),t.prototype.setupMaterials=function(){this.materials=new a.Dictionary,this.materials.set("player",new n.Material(n.Material.idCounter++)),this.materials.set("ground_default",new n.Material(n.Material.idCounter++)),this.materials.set("box_default",new n.Material(n.Material.idCounter++)),this.materials.set("box_highfriction",new n.Material(n.Material.idCounter++)),this.materials.set("mob_default",new n.Material(n.Material.idCounter++)),this.materials.set("bumper",new n.Material(n.Material.idCounter++));var t=new n.ContactMaterial(this.materials.get("player"),this.materials.get("ground_default"),{friction:.85,restitution:.1,stiffness:n.Equation.DEFAULT_STIFFNESS,relaxation:n.Equation.DEFAULT_RELAXATION,frictionStiffness:n.Equation.DEFAULT_STIFFNESS,frictionRelaxation:n.Equation.DEFAULT_RELAXATION,surfaceVelocity:0});this.world.addContactMaterial(t);var e=new n.ContactMaterial(this.materials.get("player"),this.materials.get("mob_default"),{friction:.1,restitution:.4,stiffness:n.Equation.DEFAULT_STIFFNESS,relaxation:n.Equation.DEFAULT_RELAXATION,frictionStiffness:n.Equation.DEFAULT_STIFFNESS,frictionRelaxation:n.Equation.DEFAULT_RELAXATION,surfaceVelocity:0});this.world.addContactMaterial(e);var i=new n.ContactMaterial(this.materials.get("player"),this.materials.get("box_default"),{friction:.2,restitution:.25,stiffness:n.Equation.DEFAULT_STIFFNESS,relaxation:n.Equation.DEFAULT_RELAXATION,frictionStiffness:n.Equation.DEFAULT_STIFFNESS,frictionRelaxation:n.Equation.DEFAULT_RELAXATION,surfaceVelocity:0});this.world.addContactMaterial(i);var s=new n.ContactMaterial(this.materials.get("player"),this.materials.get("box_highfriction"),{friction:.7,restitution:.2,stiffness:n.Equation.DEFAULT_STIFFNESS,relaxation:n.Equation.DEFAULT_RELAXATION,frictionStiffness:n.Equation.DEFAULT_STIFFNESS,frictionRelaxation:n.Equation.DEFAULT_RELAXATION,surfaceVelocity:0});this.world.addContactMaterial(s);var o=new n.ContactMaterial(this.materials.get("player"),this.materials.get("bumper"),{friction:.35,restitution:.75,stiffness:Number.MAX_VALUE,relaxation:n.Equation.DEFAULT_RELAXATION,frictionStiffness:Number.MAX_VALUE,frictionRelaxation:n.Equation.DEFAULT_RELAXATION,surfaceVelocity:0});this.world.addContactMaterial(o);var r=new n.ContactMaterial(this.materials.get("box_default"),this.materials.get("ground_default"),{friction:.8,restitution:.3,stiffness:n.Equation.DEFAULT_STIFFNESS,relaxation:n.Equation.DEFAULT_RELAXATION,frictionStiffness:n.Equation.DEFAULT_STIFFNESS,frictionRelaxation:n.Equation.DEFAULT_RELAXATION,surfaceVelocity:0});this.world.addContactMaterial(r)},t}();e.WorldP2=u,e.wp2=new u},265:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(130),s=function(){function t(){var t=this;this.ALT_KEY=18,this.SHIFT_KEY=16,this.CTRL_KEY=17,this.addKeyboardActionHandler=function(e,i){t.stateActions[i]||(t.stateActions[i]=[]),t.stateActions[i].push(e)},this.stateActions={},this.keyboard=[];for(var e=0;e<256;e++)this.keyboard[e]=!1;document.addEventListener("keydown",this.keydown.bind(this),!1),document.addEventListener("keyup",this.keyup.bind(this),!1)}return t.prototype.update=function(t){var e=this.stateActions[t];this.findHandlerAndInvoke(e),e=this.stateActions[n.State.GLOBAL],this.findHandlerAndInvoke(e)},t.prototype.findHandlerAndInvoke=function(t){if(t)for(var e=t.length,i=0;i<e;i++){var n=t[i];n&&n.isAssigned()&&n.handler&&this.keyboard[n.key]&&this.keyboard[this.ALT_KEY]==n.altKey&&this.keyboard[this.SHIFT_KEY]==n.shiftKey&&this.keyboard[this.CTRL_KEY]==n.ctrlKey&&(n.handler(),n.releaseKeyAfterInvoke&&(this.keyboard[n.key]=!1))}},t.prototype.keydown=function(t){this.keyboard[t.which]=!0},t.prototype.keyup=function(t){this.keyboard[t.which]=!1},t.prototype.isKeyDown=function(t){return this.keyboard[t]},t}();e.KeyboardMapper=s;var a=function(){function t(t,e,i,n,s,a,o){void 0===i&&(i=void 0),void 0===n&&(n=!0),void 0===s&&(s=!1),void 0===a&&(a=!1),void 0===o&&(o=!1),this.key=t,this.name=e,this.handler=i,this.releaseKeyAfterInvoke=n,this.shiftKey=s,this.ctrlKey=a,this.altKey=o}return t.prototype.isAssigned=function(){return void 0!==this.handler},t}();e.KeyboardAction=a},266:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){var t=this;this.first=null,this.last=null,this.length=0,this.AddNode=function(e){var i=new s;return i.data=e,i.previous=i.next=null,i.list=t,t.first?(i.previous=t.last,t.last.next=i,t.last=i):(t.first=i,t.last=i),t.length++,i},this.InsertNode=function(e){var i=new s;return i.data=e,i.previous=i.next=null,i.list=t,t.first?(i.next=t.first,t.first.previous=i,t.first=i):(t.first=i,t.last=i),t.length++,i}}return Object.defineProperty(t.prototype,"First",{get:function(){return this.first},set:function(t){this.first=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Last",{get:function(){return this.last},set:function(t){this.last=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Length",{get:function(){return this.length},enumerable:!0,configurable:!0}),t.prototype.RemoveNode=function(t){t.previous&&(t.previous.next=t.next),t.next&&(t.next.previous=t.previous),this.length--},t.prototype.RollLeft=function(){var t=this.first,e=this.first.next;t.next=null,t.previous=this.last,this.last.next=t,this.last=t,this.first=e,this.first.previous=null},t.prototype.forEach=function(t){for(var e=this.first;e;)t(e),e=e.next},t}();e.LinkedList=n;var s=function(){function t(){this.previous=null,this.next=null}return t.prototype.InsertBefore=function(t){var e=this.list.AddNode(t),i=this.previous;e.next=this,e.previous=i,this.previous=e,i&&(i.next=e),e.list=this.list,this.list.First=this.FindFirst()},t.prototype.InsertAfter=function(t){var e=this.list.AddNode(t),i=this.next;e.previous=this,e.next=i,this.next=e,i&&(i.previous=e),e.list=this.list,this.list.Last=this.FindLast()},t.prototype.FindFirst=function(){for(var t=this;t.previous;)t=t.previous;return t},t.prototype.FindLast=function(){for(var t=this;t.next;)t=t.next;return t},t}();e.LinkedListNode=s},267:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(5),s=i(0),a=i(21),o=function(t){function e(e,i,n,a){var o=t.call(this)||this;return o.textureScale=a,o.worldPosition=0,o.spriteBuffer=[],o.spriteOrderList=[],o.totalWidth=0,o.recalculatePosition=function(t){var e=o.spriteOrderList[0],i=o.spriteBuffer[e],n=o.spriteOrderList[o.spriteOrderList.length-1],s=o.spriteBuffer[n],a=(o.worldPosition-t)*o.parallaxFactor;o.updatePositions(a),t>o.worldPosition?i.x+i.width<0&&(o.spriteOrderList.push(o.spriteOrderList.shift()),i.x=s.x+s.width):s.x>o.viewPortSize.x&&(o.spriteOrderList.unshift(o.spriteOrderList.pop()),s.x=i.x-s.width),o.worldPosition=t},o.ViewPortSize=e||new s.Point(100,100),o.parallaxFactor=i||1,o.textureScale=o.textureScale||1,o.setTextures(n),o.worldPosition=0,o.SetViewPortX(1),o}return n.__extends(e,t),Object.defineProperty(e.prototype,"WorldPosition",{get:function(){return this.worldPosition},enumerable:!0,configurable:!0}),e.prototype.SetViewPortX=function(t){this.worldPosition!==t&&this.recalculatePosition(t)},Object.defineProperty(e.prototype,"ViewPortSize",{get:function(){return this.viewPortSize},set:function(t){this.viewPortSize=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ParallaxFactor",{get:function(){return this.parallaxFactor},set:function(t){this.parallaxFactor=t},enumerable:!0,configurable:!0}),e.prototype.setTextures=function(t){for(var e,i=0,n=this.getTexture(t,0),a=n.width*this.textureScale;this.spriteBuffer.length<3||this.spriteBuffer.length<t.length||this.totalWidth<=this.viewPortSize.x+a;){e=i%t.length,(n=this.getTexture(t,e)).rotate=8;var o=new s.Sprite(n);o.x=this.totalWidth,o.scale.set(this.textureScale,this.textureScale),o.anchor.set(0,0),this.spriteBuffer.push(o),this.spriteOrderList.push(this.spriteBuffer.length-1),this.addChild(o),this.totalWidth+=o.width,console.log(n.baseTexture.imageUrl+" -> width: "+n.width+" spr width: "+o.width+", total width: "+this.totalWidth),i++}},e.prototype.getTexture=function(t,e){return"string"==typeof t[e]?a.TextureLoader.Get(t[e]):t[e]},e.prototype.updatePositions=function(t){for(var e=0;e<this.spriteBuffer.length;e++)this.spriteBuffer[e].position.x+=t},e}(s.Container);e.Parallax=o},268:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(5),s=i(0),a=i(43),o=i(21),r=function(t){function e(e,i,n,a,o,r){void 0===n&&(n=0),void 0===a&&(a=0);var u=t.call(this)||this;return u.isPressed=!1,u.value=0,u.onClick=function(t){return u.setSliderFromeEvent(t),u.Value=u.getCalculatedValue(),!1},u.dragOffsetX=0,u.isDragging=!1,u.onDragStart=function(t){u.isDragging=!0;var e=t.data.getLocalPosition(u.handle);u.dragOffsetX=e.x},u.onDragEnd=function(t){u.isDragging=!1,u.Value=u.getCalculatedValue(),t.stopped=!0},u.onDragMove=function(t){if(u.isDragging)return u.setSliderFromeEvent(t),!1},u.onButtonDown=function(){u.textureControl.frame=u.frameDownControl,u.textureHandle.frame=u.frameDownHandle},u.onButtonUp=function(t){u.applyTextureFrames()},u.onButtonUpOutside=function(){u.applyTextureFrames()},u.onButtonOver=function(){u.control.texture.frame=u.frameHighlightControl,u.textureHandle.frame=u.frameHighlightHandle},u.onButtonOut=function(){u.applyTextureFrames()},u.position.set(n||0,a||0),u.requestedHeight=r,u.requestedWidth=o,u.control=new s.Sprite,u.control.anchor.set(0),u.control.interactive=!0,u.control.buttonMode=!1,u.control.cursor="hover",u.addChild(u.control),u.control.on("pointerdown",u.onButtonDown).on("pointerup",u.onButtonUp).on("pointertap",u.onClick).on("pointerupoutside",u.onButtonUpOutside).on("mouseover",u.onButtonOver).on("mouseout",u.onButtonOut),u.handleWidth=i,u.handle=new s.Sprite,u.handle.position.set(0,u.requestedHeight/2),u.handle.anchor.set(0,.5),u.addChild(u.handle),u.handle.interactive=!0,u.handle.buttonMode=!1,u.handle.cursor="hover",u.handle.on("pointerdown",u.onDragStart).on("pointerup",u.onDragEnd).on("pointerupoutside",u.onDragEnd).on("pointermove",u.onDragMove),u.SetTexture(e,i),u.IsPressed=!1,u.applyTextureFrames(),u.Value=.1,u}return n.__extends(e,t),Object.defineProperty(e.prototype,"Value",{get:function(){return this.value},set:function(t){this.value!==t&&(this.value=t,this.handle.position.x=this.maxX*t,this.emit("valueChange",t),this.emit("valueChanged",t))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"outlineColor",{get:function(){return this._outlineColor},set:function(t){this._outlineColor=t,this.control.filters=[new a.OutlineFilter(1,this._outlineColor,.5)]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsPressed",{get:function(){return this.isPressed},set:function(t){this.isPressed=t,this.applyTextureFrames()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Text",{get:function(){return this.text},set:function(t){if(this.text&&this.removeChild(this.text),this.text=t,this.text){this.text.anchor.set(.5,.5);var e=this.width/this.scale.x/2,i=this.height/this.scale.y/2;this.text.position.set(e,i),this.addChild(this.text)}},enumerable:!0,configurable:!0}),e.prototype.getCalculatedValue=function(){var t=(this.handle.x-this.minX)/this.maxX;return this.precise_round(t,2)},e.prototype.setSliderFromeEvent=function(t){var e=t.data.getLocalPosition(this.handle.parent);this.isDragging&&this.dragOffsetX&&(e.x-=this.dragOffsetX),this.handle.x=Math.min(this.maxX,Math.max(this.minX,e.x)),this.emit("valueChange",this.getCalculatedValue())},e.prototype.precise_round=function(t,e){var i=Math.pow(10,e),n=(Math.round(t*i+(e>0?1:0)*(Math.sign(t)*(10/Math.pow(100,e))))/i).toFixed(e);return parseFloat(n)},e.prototype.applyTextureFrames=function(){this.textureControl.frame=this.isPressed?this.frameDownControl:this.frameUpControl,this.textureHandle.frame=this.isPressed?this.frameDownHandle:this.frameUpHandle},e.prototype.SetTexture=function(t,e){var i=o.TextureLoader.Get(t);this.textureControl=new s.Texture(i.baseTexture),this.textureControl.baseTexture.scaleMode=s.SCALE_MODES.NEAREST,this.textureHandle=new s.Texture(i.baseTexture);var n=this.textureControl.height/3,a=this.textureControl.width-e-1;this.frameUpControl=new s.Rectangle(0,0*n,a,n),this.frameHighlightControl=new s.Rectangle(0,1*n,a,n),this.frameDownControl=new s.Rectangle(0,2*n,a,n);var r=a+1;this.frameUpHandle=new s.Rectangle(r,0*n,e,n),this.frameHighlightHandle=new s.Rectangle(r,1*n,e,n),this.frameDownHandle=new s.Rectangle(r,2*n,e,n),this.applyTextureFrames(),this.control.texture=this.textureControl,this.control.width=this.requestedWidth,this.control.height=this.requestedHeight,this.handle.texture=this.textureHandle,this.handle.height=this.requestedHeight,this.maxX=this.requestedWidth-this.handleWidth,this.minX=0},e}(s.Container);e.Slider=r},269:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(5),s=i(6),a=i(270),o=i(6),r=["assets/cur_default.png","assets/cur_hover.png","assets/cur_target.png","assets/levels.json","assets/quests.json"],u=function(t){function e(e){var i=t.call(this,e,"Boot")||this;return i.onUpdate=function(t){i.spinner&&(i.spinner.rotation+=.05)},i.onActivate=function(){i.loadingMessage=new s.PIXI.Text("booting ...",{fontSize:"36px",fontFamily:"Permanent Marker",fill:65280,dropShadow:!0,stroke:4521796,strokeThickness:1}),i.loadingMessage.anchor.set(.5,.5),i.loadingMessage.position.set(o.SCENE_HALF_WIDTH,o.SCENE_HALF_HEIGHT-80),i.addChild(i.loadingMessage),s.PIXI.loader.reset().add("assets/loading.png").load(i.startPreloading)},i.startPreloading=function(){return n.__awaiter(i,void 0,void 0,function(){var t;return n.__generator(this,function(e){return t=s.PIXI.Texture.fromImage("assets/loading.png"),this.spinner=new s.PIXI.Sprite(t),this.spinner.position.set(o.SCENE_HALF_WIDTH,o.SCENE_HALF_HEIGHT),this.spinner.anchor.set(.5,.5),this.spinner.scale.set(.5),this.addChild(this.spinner),console.log("initializing common assets preloading ...",r),s.PIXI.loader.add(r).load(this.onPreloadFinished),[2]})})},i.onPreloadFinished=function(){return n.__awaiter(i,void 0,void 0,function(){var t,e,i;return n.__generator(this,function(n){return t="url('assets/cur_default.png'),auto","url('assets/cur_hover.png'),auto","url('assets/cur_target.png') 24 24, auto",this.sceneManager.Renderer.plugins.interaction.cursorStyles.default=t,this.sceneManager.Renderer.plugins.interaction.cursorStyles.hover="url('assets/cur_hover.png'),auto",this.sceneManager.Renderer.plugins.interaction.cursorStyles.target="url('assets/cur_target.png') 24 24, auto",document.body.style.cursor=t,s.Global.LevelDefinitions=s.PIXI.loader.resources["assets/levels.json"].data,e=s.PIXI.loader.resources["assets/quests.json"].data,s.Global.LevelDefinitions.quests=e.quests,s.Global.LevelDefinitions.quests.forEach(function(t){t.itemId=t.itemId||0,t.itemsNeeded=t.itemsNeeded||0,t.itemsCollected=0,t.rewardCoins=t.rewardCoins||0,t.rewardExp=t.rewardExp||0}),i=new a.LoaderScene(this.sceneManager),this.sceneManager.AddScene(i),this.sceneManager.ActivateScene(i),[2]})})},i.BackGroundColor=0,i}return n.__extends(e,t),e}(s.Scene);e.BootScene=u},270:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(5),s=i(6),a=i(132),o=i(22),r=i(15),u=i(287),l=i(288),c=i(297),h=i(298),d=function(t){function e(e){var i=t.call(this,e,"Loader")||this;i.preloadAssets=["assets/gui-atlas.json","assets/objects-atlas.json","assets/entities-atlas.json","assets/background-atlas.json"],i.onUpdate=function(t){i.spinner&&(i.spinner.rotation+=.05)},i.onActivate=function(){console.log("downloading level "+o.stats.currentGameLevel+"...");var t=a.GetLevelAssets(s.Global.LevelDefinitions,o.stats.currentGameLevel);t=t.concat(i.preloadAssets,"assets/font/orbitron.fnt","assets/font/orbitron_outline.fnt","assets/font/bauhaus.fnt"),t=a.getUniqueItems(t),s.PIXI.loader.reset().add(t).load(i.handleLevelLoading).on("progress",i.onProgress)},i.handleLevelLoading=function(){i.sceneManager.HasScene("Main")||(console.log("adding scenes..."),i.sceneManager.AddScene(new l.MainScene(i.sceneManager)),i.sceneManager.AddScene(new c.OptionsScene(i.sceneManager)),i.sceneManager.AddScene(new h.CutScene(i.sceneManager)),i.sceneManager.MasterHudOverlay=new u.MasterHud(i.sceneManager));try{i.sceneManager.GetScene("Main").startLevel()}catch(t){console.log("exception: ",t)}},i.onProgress=function(t,e){var n=t.progress;console.log("progress: "+n.toFixed(0)+"%, asset: "+e.name),i.loadingMessage.text="Loading "+n.toFixed(0)+" %"},i.BackGroundColor=0,i.loadingMessage=new s.PIXI.Text("loading ...",{fontSize:36,fontFamily:"Permanent Marker",fill:65280,dropShadow:!0,align:"center",stroke:4521796,strokeThickness:1}),i.loadingMessage.anchor.set(.5,.5),i.loadingMessage.position.set(r.SCENE_HALF_WIDTH,r.SCENE_HALF_HEIGHT-80),i.addChild(i.loadingMessage);var n=s.PIXI.Texture.fromImage("assets/loading.png");return i.spinner=new s.PIXI.Sprite(n),i.spinner.position.set(r.SCENE_HALF_WIDTH,r.SCENE_HALF_HEIGHT),i.spinner.anchor.set(.5,.5),i.spinner.scale.set(.5),i.addChild(i.spinner),i}return n.__extends(e,t),e}(s.Scene);e.LoaderScene=d},283:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(44),s=i(25),a=i(42),o=i(22),r=i(6),u=function(){function t(t,e,i,n,s,a,o,r){void 0===r&&(r=!0),this.name=t,this.x=e,this.y=i,this.area=n,this.maxMobCount=s,this.respawnSeconds=a,this.entity=o,this.active=r,this.mobCount=0,this.nextSpawn=0,this.nextSpawn=performance.now()/1e3}return Object.defineProperty(t.prototype,"IsActive",{get:function(){return this.active},set:function(t){this.active=t},enumerable:!0,configurable:!0}),t.prototype.onUpdate=function(t){var e=this;if(this.active&&this.mobCount<this.maxMobCount){var i=performance.now()/1e3;if(this.nextSpawn<=i){this.worldContainer||(this.worldContainer=r.Global.getScm().GetScene("Main").worldContainer);var u=n.LevelLoader.createMob(o.stats.currentLevel.templates,this.entity),l=u.DisplayObject,c=this.x+Math.random()*this.area-this.area/2,h=this.y;u.position=[c,h],s.wp2.addBody(u),l.position.set(c,h),l.visible=!1,l.isLoading=!0,this.worldContainer.addChild(l);var d=new a.AnimatedSprite;d.addAnimations(new a.AnimationSequence("load","assets/entities-atlas.json@load.png",[0,1,2,3],64,64)),d.anchor.set(.5),d.position.set(c,h+10),d.play("load",4,!0),d.scale.set(1,-1),this.worldContainer.addChild(d),setTimeout(function(){e.worldContainer.removeChild(d),l.isLoading=!1,l.visible=!0},3e3),l.onDeath=function(){console.log("mob died"),e.mobCount--},this.mobCount++,this.nextSpawn=performance.now()/1e3+this.respawnSeconds}}},t}();e.SpawnPoint=u},285:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(5),s=function(t){function e(e){return t.call(this,e)||this}return n.__extends(e,t),e.prototype.canFire=function(){var t=performance.now(),e=2e3*Math.random(),i=this.lastFire+this.attackCD+e<=t;if(i){var n=Math.random();i=i&&n>.3,this.lastFire=performance.now()}return i},e}(i(286).AI);e.BasicStaticAI=s},286:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(20),s=i(18),a=800,o=1050,r=function(){function t(t){var e=this;this.mobEntity=t,this.lastFire=0,this.onUpdate=function(t){e.calcDistance(),e.targetDistance<o&&e.turnTowardsTarget(),e.targetDistance<a?(e.hasTarget=!0,e.canFire()&&(e.mobEntity.attack(),e.lastFire=performance.now())):e.hasTarget=!1},this.attackCD=t.attributes[s.AtrType.AtkCD]}return t.prototype.calcDistance=function(){var t=n.position.x-this.mobEntity.x,e=n.position.y-this.mobEntity.y;this.targetDistance=Math.sqrt(t*t+e*e)},t.prototype.turnTowardsTarget=function(){var t=n.position.x-this.mobEntity.x;t<0&&this.mobEntity.direction!=s.DirectionH.Left?this.mobEntity.direction=s.DirectionH.Left:t>0&&this.mobEntity.direction!=s.DirectionH.Right&&(this.mobEntity.direction=s.DirectionH.Right)},t.prototype.canFire=function(){var t=performance.now();return this.lastFire+this.attackCD<=t},t}();e.AI=r},287:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(5),s=i(6),a=s.SCENE_WIDTH-48,o=4,r=1,u=function(t){function e(e){var i=t.call(this)||this;i.sceneManager=e,["","webkit","moz","ms"].forEach(function(t){return document.addEventListener(t+"fullscreenchange",function(t){i.isFullScreen?n.setTexture("assets/gui-atlas.json@gui_fs_exit.png"):n.setTexture("assets/gui-atlas.json@gui_fs_enter.png"),n.scale.set(r)},!1)});var n=new s.Button("assets/gui-atlas.json@gui_fs_enter.png",a,o);n.onClick=function(){return i.toggleFullScreen()},n.scale.set(r),i.addChild(n);var u=new s.Button("assets/gui-atlas.json@gui_options.png",a-48,o);return u.onClick=function(){return i.sceneManager.ActivateScene("Options")},u.name="BTN_OPTIONS",u.scale.set(r),i.addChild(u),i}return n.__extends(e,t),Object.defineProperty(e.prototype,"isFullScreen",{get:function(){var t=document;return!!(t.fullscreenElement||t.mozFullScreenElement||t.webkitFullscreenElement||t.msFullscreenElement)},enumerable:!0,configurable:!0}),e.prototype.toggleFullScreen=function(){var t=document,e=document.documentElement,i=e.requestFullscreen||e.mozRequestFullScreen||e.webkitRequestFullScreen||e.msRequestFullscreen,n=t.exitFullscreen||t.mozCancelFullScreen||t.webkitExitFullscreen||t.msExitFullscreen;this.isFullScreen?n.call(t):i.call(e)},e}(PIXI.Container);e.MasterHud=u},288:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(5),s=i(45),a=i(32),o=i(6),r=i(25),u=i(289),l=i(291),c=i(22),h=i(161),d=i(33),p=i(15),f=i(292),m=i(44),y=i(293),v=i(294),g=i(36),S=i(295),x=i(18),b=function(t){function e(e){var i=t.call(this,e,"Main")||this;return i.shakeDuration=0,i.shakeEnd=0,i.nextShake=0,i.magnitude=0,i.SHAKE_COUNT=15,i.startGroundShake=function(t){i.shakeEnd=performance.now()+t.milliSeconds,i.magnitude=t.magnitudeInPixels,i.shakeDuration=t.milliSeconds/i.SHAKE_COUNT},i.BackGroundColor=p.SCENE_BACKCOLOR,i.setup(),i}return n.__extends(e,t),e.prototype.onUpdate=function(t){r.wp2.update(t),this.worldContainer.x=p.SCENE_HALF_WIDTH-this.hero.x,this.worldContainer.y=p.SCENE_HEIGHT-70,c.stats.currentLevel.parallax.forEach(function(t){t.SetViewPortX(o.Global.position.x),t.position.x=o.Global.position.x-p.SCENE_HALF_WIDTH});for(var e=r.wp2.bodies,i=0,n=e.length;i<n;i++){var a=(d=e[i]).DisplayObject;if(a&&a.visible&&d.type!==s.Body.STATIC&&(a.position.set(Math.floor(d.interpolatedPosition[0]),Math.floor(d.interpolatedPosition[1])),a.rotation=d.interpolatedAngle),d.Trigger&&"distance"===d.Trigger.type&&this.questMngr.canActivateTrigger(d.Trigger)){var u=this.hero.position.x-d.position[0],l=this.hero.position.y-d.position[1],h=Math.sqrt(u*u+l*l);d.Trigger.distance>=h&&this.questMngr.handleTriggerEvent(d)}}for(i=0,n=r.wp2.playerContacts.length;i<n;i++){var d;(d=r.wp2.playerContacts[i]).DisplayObject&&d.DisplayObject.interactionType&&this.handleInteractiveCollision(d),d.Trigger&&"collision"===d.Trigger.type&&this.questMngr.handleTriggerEvent(d)}for(i=0,n=this.worldContainer.children.length;i<n;i++){var f=this.worldContainer.children[i];f&&f.onUpdate&&f.onUpdate(t)}for(i=0,n=c.stats.currentLevel.spawnPoints.length;i<n;i++)c.stats.currentLevel.spawnPoints[i].onUpdate(t);this.hud.onUpdate(t),c.stats.onUpdate(t);var m=performance.now();if(c.stats.getStat(x.StatType.HP)<=0){this.IsHeroInteractive=!1,this.hero.visible=!1;var y=this.sceneManager.GetScene("CutScene"),v=this.sceneManager.CaptureScene();y.SetBackGround(v,this.scale),y.DeathScene=!0,this.sceneManager.ActivateScene(y)}else if(this.shakeEnd>=m){if(this.nextShake<=m){u=p.SCENE_HALF_WIDTH-this.hero.x,l=p.SCENE_HEIGHT-70;this.shakeX=u+this.randomRange(-this.magnitude/2,this.magnitude/2),this.shakeY=l+this.randomRange(-this.magnitude,this.magnitude),this.magnitude-=this.magnitude/this.SHAKE_COUNT,this.nextShake=m+this.shakeDuration}this.worldContainer.x=this.shakeX,this.worldContainer.y=this.shakeY}},e.prototype.setup=function(){this.worldContainer=new o.PIXI.Container,this.worldContainer.scale.y=-1,this.addChild(this.worldContainer),o.Global.worldContainer=this.worldContainer,this.hero=new u.HeroCharacter(this.worldContainer),this.hero.name="hero",this.hero.x=p.SCENE_HALF_WIDTH,this.worldContainer.addChild(this.hero),this.hero.play("idle",p.ANIMATION_FPS_SLOW),this.hud=new l.StatsHud,this.HudOverlay=this.hud,m.LevelLoader.registerFactory("Lava",function(t){return new f.Lava(t.texture)}),m.LevelLoader.registerFactory("Platform",function(t){return"string"==typeof t.texture?new y.Platform(t.tilesX||1,1,[t.texture]):new y.Platform(t.tilesX||1,t.tilesY||1,t.texture)}),m.LevelLoader.registerFactory("Bumper",function(t){return new v.Bumper}),this.questMngr=new S.QuestManager(this),d.eventEmitter.on(d.BURN_TOPIC,function(t){return t.isBurning?g.snd.burn():g.snd.burnStop()}),d.eventEmitter.on(d.GROUND_SHAKE,this.startGroundShake)},e.prototype.startLevel=function(){var t=this;this.clearLevel(),c.stats.loadLevel(),g.snd.playTrack(c.stats.currentLevel.audioTrack||0),c.stats.currentLevel.parallax.forEach(function(e,i){t.worldContainer.addChildAt(e,i),e.SetViewPortX(c.stats.currentLevel.start[0])}),c.stats.currentLevel.entities.forEach(function(e){t.worldContainer.addChild(e.DisplayObject),e.shapes&&e.shapes.length>0&&r.wp2.addBody(e)}),r.wp2.playerBody.position[0]=c.stats.currentLevel.start[0],r.wp2.playerBody.position[1]=c.stats.currentLevel.start[1],this.questMngr.reset(),this.hero.visible=!0,this.IsHeroInteractive=!0,this.hud.visible=!0,this.sceneManager.ActivateScene(this)},Object.defineProperty(e.prototype,"IsHeroInteractive",{set:function(t){this.hero.IsInteractive!==t&&(this.hero.IsInteractive=t,this.hero.IsInteractive||(this.hero.play("idle",p.ANIMATION_FPS_SLOW),g.snd.idle()))},enumerable:!0,configurable:!0}),e.prototype.collectObject=function(t){var e=this,i=t.DisplayObject,n=i.scale.x,s=i.position.x+45,o=i.position.y+160,r=i.position.x-p.SCENE_HALF_WIDTH,u=p.SCENE_HEIGHT,l=new a.Tween(i.position).to({x:s,y:o},150),c=new a.Tween(i.scale).to({x:n+.5,y:n+.5},500).easing(a.Easing.Linear.None),h=new a.Tween(i.position).to({x:r,y:u},2e3).easing(a.Easing.Back.In).onComplete(function(){return e.worldContainer.removeChild(i)});l.chain(c,h).start(),this.removeEntity(t)},e.prototype.handleInteractiveCollision=function(t){var e=t.DisplayObject;switch(t.DisplayObject.interactionType){case 1:c.stats.increaseStat(x.StatType.Coins,1),this.collectObject(t),this.hud.addInfoMessage(e.position,"+1 coin",p.MSG_COIN_STYLE,-100),g.snd.coin();break;case 2:c.stats.increaseStat(x.StatType.Coins,10),this.collectObject(t),this.hud.addInfoMessage(e.position,"+10 coins",p.MSG_COIN_STYLE,-100),g.snd.coin();break;case 3:c.stats.increaseStat(x.StatType.Coins,100),this.collectObject(t),this.hud.addInfoMessage(e.position,"+100 coins",p.MSG_COIN_STYLE,-100),g.snd.gem();break;case 201:this.hud.addInfoMessage(e.position,"Kendo knowledge acquired!",p.MSG_COIN_STYLE),this.collectObject(t),g.snd.questItem(),this.questMngr.acquireItem(201);break;case 202:this.hud.addInfoMessage(e.position,"1 Ki acquired!",p.MSG_COIN_STYLE),this.collectObject(t),g.snd.questItem(),this.questMngr.acquireItem(202);break;case x.DamageType.LavaBorder:var i=performance.now()/1e3;(!c.stats.buffs[x.DamageType.LavaBorder]||c.stats.buffs[x.DamageType.LavaBorder]<i)&&this.hud.addInfoMessage(e.position,"Burning",p.MSG_WARN_STYLE,100),c.stats.buffs[x.DamageType.LavaBorder]=this.secondsFromNow(1);break;case x.DamageType.Lava:i=performance.now()/1e3;(!c.stats.buffs[x.DamageType.Lava]||c.stats.buffs[x.DamageType.Lava]<i)&&this.hud.addInfoMessage(e.position,"Burning",p.MSG_WARN_STYLE,100),c.stats.buffs[x.DamageType.Lava]=this.secondsFromNow(4)}},e.prototype.secondsFromNow=function(t){var e=performance.now()/1e3;return e+=t},e.prototype.removeEntity=function(t,e){void 0===e&&(e=!1),r.wp2.removeBody(t),e&&this.worldContainer.removeChild(t.DisplayObject),t.DisplayObject=null},e.prototype.clearLevel=function(){var t=this;c.stats.currentLevel&&(c.stats.currentLevel.parallax.forEach(function(e,i){t.worldContainer.removeChild(e)}),c.stats.currentLevel.entities.forEach(function(e){e!==r.wp2.playerBody&&(t.worldContainer.removeChild(e.DisplayObject),r.wp2.removeBody(e),e.DisplayObject=null)}),this.worldContainer.children.filter(function(t){return"hero"!==t.name}).forEach(function(e){t.worldContainer.removeChild(e)}),r.wp2.clearLevel(),h.Bullet.reset())},e.prototype.randomRange=function(t,e){return t+Math.random()*(e-t)},e}(o.Scene);e.MainScene=b},289:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(5),s=i(32),a=i(20),o=i(6),r=i(33),u=i(6),l=i(290),c=i(25),h=i(22),d=i(160),p=i(44),f=i(36),m=i(18),y=64,v=function(t){function e(e){var i=t.call(this)||this;i.container=e,i.onUpdate=function(e){switch(i.position.x=u.Global.position.x,i.position.y=u.Global.position.y,i.IsInteractive&&i.movementCtrl.update(e),i.movementCtrl.MovementState){case l.MovementState.Idle:i.emitterPixies.emit=!1;break;case l.MovementState.Left:case l.MovementState.JumpLeft:i.emitterPixies.emit=i.movementCtrl.IsRunning,i.emitterPixies.minStartRotation=-25,i.emitterPixies.maxStartRotation=25;break;case l.MovementState.Right:case l.MovementState.JumpRight:i.emitterPixies.emit=i.movementCtrl.IsRunning,i.emitterPixies.minStartRotation=155,i.emitterPixies.maxStartRotation=205;break;case l.MovementState.JumpUp:i.emitterPixies.emit=i.movementCtrl.IsRunning,i.emitterPixies.minStartRotation=245,i.emitterPixies.maxStartRotation=295}if(i.emitterPixies.update(.001*e),i.emitterPixies.updateOwnerPos(i.position.x,i.position.y),i.emitterBurn.update(.001*e),i.movementCtrl.IsRunning&&i.movementCtrl.MovementState!==l.MovementState.Idle){h.stats.increaseStat(m.StatType.Dust,.005*-e);var n=8*Math.PI/180;i.rotation=i.movementCtrl.MovementState===l.MovementState.Left?n:-n}else i.rotation=0;i.emitterBurn.emit=h.stats.isBurning,t.prototype.onUpdate.call(i,e)},i.onPlayerMove=function(t){var e=t.newState,n=t.isRunning?1.6*o.ANIMATION_FPS_NORMAL:o.ANIMATION_FPS_NORMAL;switch(e){case l.MovementState.Idle:i.idleAnimationTimeoutHandle&&clearTimeout(i.idleAnimationTimeoutHandle),i.idleAnimationTimeoutHandle=setTimeout(function(){i.play("idle",o.ANIMATION_FPS_SLOW),f.snd.idle()},300);break;case l.MovementState.Left:clearTimeout(i.idleAnimationTimeoutHandle),i.play("left",n),f.snd.walk(t.isRunning);break;case l.MovementState.Right:clearTimeout(i.idleAnimationTimeoutHandle),i.play("right",n),f.snd.walk(t.isRunning);break;case l.MovementState.JumpLeft:clearTimeout(i.idleAnimationTimeoutHandle),i.play("jumpleft",n),f.snd.jump();break;case l.MovementState.JumpRight:clearTimeout(i.idleAnimationTimeoutHandle),i.play("jumpright",n),f.snd.jump();break;case l.MovementState.JumpUp:clearTimeout(i.idleAnimationTimeoutHandle),i.play("jumpup",n),f.snd.jump();break;case l.MovementState.JumpDownLeft:clearTimeout(i.idleAnimationTimeoutHandle),i.play("jumpdownleft",n,!1),f.snd.jumpAttack();break;case l.MovementState.JumpDownRight:clearTimeout(i.idleAnimationTimeoutHandle),i.play("jumpdownright",n,!1),f.snd.jumpAttack();break;case l.MovementState.JumpDown:clearTimeout(i.idleAnimationTimeoutHandle),i.play("jumpdown",n,!1),f.snd.jumpAttack()}},i.movementCtrl=new l.MovementController(c.wp2),c.wp2.on("playerContact",i.onPlayerContact,i),c.wp2.on("bulletContact",i.onBulletContact,i);var n={alpha:{start:.7,end:0},blendMode:"normal",frequency:.01,startRotation:{min:265,max:275},color:{start:"#ffffff",end:"#ff5050"},speed:{start:1,end:.5,minimumSpeedMultiplier:1},scale:{start:.2,end:.6},maxParticles:20,lifetime:{min:.25,max:.75},spawnType:"circle",spawnCircle:{x:0,y:y-25,r:25}};i.emitterBurn=a.createParticleEmitter(i,[o.TextureLoader.Get("assets/entities-atlas.json@flame.png")],n),i.emitterPixies=a.createParticleEmitter(e,[o.TextureLoader.Get("assets/objects-atlas.json@star.png")]);var s="assets/objects-atlas.json@hero.png";return i.addAnimations(new u.AnimationSequence("right",s,[18,19,20,21,22,23],y,y)),i.addAnimations(new u.AnimationSequence("left",s,[12,13,14,15,16,17],y,y)),i.addAnimations(new u.AnimationSequence("jumpleft",s,[24,25,26,27,28,29],y,y)),i.addAnimations(new u.AnimationSequence("jumpright",s,[30,31,32,33,34,35],y,y)),i.addAnimations(new u.AnimationSequence("jumpup",s,[1,3,4,6],y,y)),i.addAnimations(new u.AnimationSequence("idle",s,[1,1,0,1,2,3,,4,5,13,12,6,7,11,18,19,0],y,y)),i.addAnimations(new u.AnimationSequence("jumpdownleft",s,[36,37,38],y,y)),i.addAnimations(new u.AnimationSequence("jumpdownright",s,[39,40,41],y,y)),i.addAnimations(new u.AnimationSequence("jumpdown",s,[42,43,44],y,y)),i.anchor.set(.5,.58),i.scale.y*=-1,r.eventEmitter.on(r.MOVE_TOPIC,i.onPlayerMove),i}return n.__extends(e,t),Object.defineProperty(e.prototype,"IsInteractive",{get:function(){return this.movementCtrl.isInteractive},set:function(t){this.movementCtrl.isInteractive=t},enumerable:!0,configurable:!0}),e.prototype.onPlayerContact=function(t){var e=this,i=t.body,n=t.body.DisplayObject,s=Math.abs(t.velocity[1]);if(s>505){n instanceof d.Mob&&(n.isLoading||this.handleMobInteraction(n,i));var a=this.movementCtrl.MovementState;if(a===l.MovementState.JumpDown||a===l.MovementState.JumpDownLeft||a===l.MovementState.JumpDownRight)return f.snd.jumpContact(),void r.eventEmitter.emit(r.GROUND_SHAKE,{milliSeconds:600,magnitudeInPixels:9})}if(s>450){console.log("Vert velocity: "+s);var o=new u.AnimatedSprite;o.addAnimations(new u.AnimationSequence("smoke","assets/entities-atlas.json@jump_smoke.png",[0,1,2,3,4,5],y,y)),o.anchor.set(.5),o.pivot.set(.5),o.x=this.x,o.y=this.y-25,o.alpha=.7,o.rotation=Math.random()*Math.PI,this.container.addChild(o),o.onComplete=function(){return e.container.removeChild(o)},o.play("smoke",6,!1)}s>400&&(f.snd.jumpContact(),console.log("velocity: "+t.velocity))},e.prototype.onBulletContact=function(t){var e=this,i=t.bulletBody.DisplayObject;if(!i.IsDead){if(t.playerHit)f.snd.hitPain(),h.stats.increaseStat(m.StatType.HP,-i.damage);else{var n=new u.AnimatedSprite;n.addAnimations(new u.AnimationSequence("exp","assets/entities-atlas.json@slime_atk_exp.png",[0,1,2,3,4,5],32,32)),n.anchor.set(.5),n.pivot.set(.5),n.x=i.x,n.y=i.y,n.alpha=.7,n.rotation=Math.random()*Math.PI,this.container.addChild(n),n.onComplete=function(){return e.container.removeChild(n)},n.play("exp",10,!1),f.snd.bulletHitWall()}i.IsDead=!0}},e.prototype.handleMobInteraction=function(t,e){var i=this,n=e.DisplayObject,s=n;if(s.drop&&Math.random()<=s.drop.chance){var a=p.LevelLoader.createEntity(h.stats.currentLevel.templates,s.drop.entity);this.addDropItem(t,a)}this.removeEntity(e),t.squish(function(){return i.container.removeChild(n)});var o=t.attributes[m.AtrType.HP]/2;h.stats.increaseStat(m.StatType.TotalExp,o)},e.prototype.addDropItem=function(t,e){var i=e.DisplayObject;i.x=t.x,i.y=t.y+40,this.container.addChild(i);var n=i.position.x+75,a=i.position.y+200,o=new s.Tween(i.position).to({x:n,y:a},400).onComplete(function(){e.position=[i.position.x,i.position.y],c.wp2.addBody(e)}),r=i.scale.x,u=i.scale.y,l=new s.Tween(i.scale).to({x:r+.3,y:r+.3},350).easing(s.Easing.Linear.None),h=this.x,d=this.y+8,p=new s.Tween(i.position).to({x:h,y:d},350).easing(s.Easing.Back.In).onUpdate(function(t){e.position=[i.position.x,i.position.y]}).onComplete(function(){return i.scale.set(r,u)});o.chain(l,p).start()},e.prototype.removeEntity=function(t,e){void 0===e&&(e=!1),c.wp2.removeBody(t),e&&this.container.removeChild(t.DisplayObject),t.DisplayObject=null},e}(u.AnimatedSprite);e.HeroCharacter=v},290:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,s=i(6),a=i(22),o=i(33),r=i(18),u=function(){function t(t){this.VELOCITY=150,this.JUMP_FORCE=17e3,this.JUMP_ATTACK_FORCE=-17e3,this.JUMP_COOLDOWN=500,this.JUMP_ATTACK_COOLDOWN=1e3,this.JUMP_ATTACK_FREEZE=800,this.nextJumpAllowed=0,this.nextJumpDownAllowed=0,this.movementState=-1,this.kbd=new s.KeyboardMapper,this.isRunning=!1,this.isJumping=!1,this.newState=n.Idle,this._isInteractive=!0,this.world=t}return Object.defineProperty(t.prototype,"isInteractive",{get:function(){return this._isInteractive},set:function(t){this._isInteractive=t,this._isInteractive||(this.isRunning=!1,this.movementState=n.Idle)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"IsJumping",{get:function(){return this.isJumping},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"CanJump",{get:function(){return!this.isJumping&&this.nextJumpAllowed<performance.now()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"IsRunning",{get:function(){return this.isRunning},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"MovementState",{get:function(){return this.movementState},enumerable:!0,configurable:!0}),t.prototype.StartJump=function(t){var e;t===n.JumpUp?e=[0,this.JUMP_FORCE]:t===n.JumpLeft?e=[.1*-this.JUMP_FORCE,this.JUMP_FORCE]:t===n.JumpRight&&(e=[.1*this.JUMP_FORCE,this.JUMP_FORCE]),this.world.playerBody.applyImpulse(e),this.world.clearContactsForBody(this.world.playerBody),this.nextJumpAllowed=performance.now()+this.JUMP_COOLDOWN},t.prototype.StartJumpDown=function(){var t=this;switch(this.movementState){case n.Left:case n.JumpLeft:this.newState=n.JumpDownLeft;break;case n.Right:case n.JumpRight:this.newState=n.JumpDownRight;break;default:this.newState=n.JumpDown}console.log("state change: "+n[this.movementState]+" -> "+n[this.newState]);var e=[0,this.JUMP_ATTACK_FORCE];this.world.playerBody.setZeroForce(),this.world.playerBody.applyImpulse(e),this.nextJumpDownAllowed=performance.now()+this.JUMP_ATTACK_COOLDOWN,this.isInteractive=!1,setTimeout(function(){return t.isInteractive=!0},this.JUMP_ATTACK_FREEZE),o.eventEmitter.emit(o.MOVE_TOPIC,{newState:this.newState,oldState:this.movementState,isJumping:!0,isRunning:!1}),this.movementState=this.newState},t.prototype.update=function(t){if(this.newState=n.Idle,Math.abs(this.world.playerBody.velocity[1])>.01){var e=this.world.playerContacts.every(function(t){return t.shapes[0].sensor});this.isJumping=e}else this.isJumping=!1;var i=this.calcMovementVelocity();if(this.isJumping&&this._isInteractive)return(this.kbd.isKeyDown(83)||this.kbd.isKeyDown(40))&&a.stats.HasJumpAtack&&this.nextJumpDownAllowed<performance.now()&&this.StartJumpDown(),void(this.world.playerBody.velocity[0]+=i);this.world.playerBody.velocity[0]=i;var s=a.stats.getStat(r.StatType.Dust)>1,u=this.kbd.isKeyDown(16)&&s&&this._isInteractive;if(this.kbd.isKeyDown(65)||this.kbd.isKeyDown(37)?this.newState=n.Left:(this.kbd.isKeyDown(68)||this.kbd.isKeyDown(39))&&(this.newState=n.Right),(this.kbd.isKeyDown(87)||this.kbd.isKeyDown(38)||this.kbd.isKeyDown(32))&&this.CanJump&&(this.movementState===n.Left?this.newState=n.JumpLeft:this.movementState===n.Right?this.newState=n.JumpRight:this.movementState===n.Idle&&(this.newState=n.JumpUp,u=!1)),this.newState!==this.movementState||u!==this.IsRunning){var l=!1;switch(this.newState){case n.JumpLeft:this.StartJump(n.JumpLeft),l=!0;break;case n.JumpRight:this.StartJump(n.JumpRight),l=!0;break;case n.JumpUp:this.StartJump(n.JumpUp),l=!0}o.eventEmitter.emit(o.MOVE_TOPIC,{newState:this.newState,oldState:this.movementState,isJumping:l,isRunning:u})}this.movementState=this.newState,this.isRunning=u},t.prototype.calcMovementVelocity=function(){var t=0;return this.movementState===n.Left||this.movementState===n.JumpLeft?t=-1:this.movementState!==n.Right&&this.movementState!==n.JumpRight||(t=1),this.IsJumping?.2*t:t*this.VELOCITY*(this.IsRunning?2:1)},t}();e.MovementController=u,function(t){t[t.Left=0]="Left",t[t.Right=1]="Right",t[t.Idle=2]="Idle",t[t.JumpLeft=3]="JumpLeft",t[t.JumpRight=4]="JumpRight",t[t.JumpUp=5]="JumpUp",t[t.JumpDownLeft=6]="JumpDownLeft",t[t.JumpDownRight=7]="JumpDownRight",t[t.JumpDown=8]="JumpDown"}(n=e.MovementState||(e.MovementState={}))},291:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(5),s=i(32),a=i(6),o=i(20),r=i(22),u=i(33),l=i(15),c=i(18),h=function(t){function e(){var e=t.call(this)||this;return e.questMsgEndTime=0,e.handleDpsChange=function(t){e.addInfoMessage(a.Global.position,t.Amount+" HP",l.MSG_HP_STYLE,50)},e.handleStatChange=function(t){switch(t.Type){case c.StatType.Coins:e.txtCoins.text=t.NewValue.toString();break;case c.StatType.Dust:e.txtDust.text=t.NewValue.toFixed(0)+" / "+t.Stats[c.StatType.MaxDust].toFixed(0);break;case c.StatType.MaxDust:e.txtDust.text=Math.floor(t.Stats[c.StatType.Dust])+" / "+t.NewValue.toFixed(0);break;case c.StatType.HP:e.txtHP.text=Math.round(t.NewValue)+" / "+t.Stats[c.StatType.MaxHP];break;case c.StatType.MaxHP:e.txtHP.text=Math.round(t.Stats[c.StatType.HP])+" / "+t.NewValue;break;case c.StatType.TotalExp:var i=t.NewValue-t.OldValue;0!=i&&e.addInfoMessage({x:0,y:90},"+"+i+" exp",l.MSG_EXP_STYLE,-50),e.renderExp(t);break;case c.StatType.CharacterLevel:e.handleLevelUp(t)}},e.handleLevelUp=function(t){e.txtExp.text=Math.round(t.Stats[c.StatType.LevelExp])+" / "+t.Stats[c.StatType.LevelMaxExp],e.expFiller.width=1,e.addLvlUpMessage("Level "+t.NewValue),e.txtLevel.text="Level "+r.stats.characterLevel},e.setup(),e}return n.__extends(e,t),e.prototype.setup=function(){this.txtPlayerPosition=new PIXI.extras.BitmapText("",l.QUEST_STYLE),this.txtPlayerPosition.position=new PIXI.Point(l.SCENE_WIDTH,l.SCENE_HEIGHT),this.txtPlayerPosition.anchor.set(1,1),this.addChild(this.txtPlayerPosition),this.statContainer=new PIXI.Sprite(a.TextureLoader.Get("assets/gui-atlas.json@panel_stats.png",!0)),this.statContainer.position.set(4),this.statContainer.name="TriggerMessage",this.statContainer.anchor.set(0),this.addChild(this.statContainer),this.questPanel=new PIXI.Sprite(a.TextureLoader.Get("assets/gui-atlas.json@panel.png")),this.questPanel.anchor.set(0),this.questPanel.position.set(4,88),this.addChild(this.questPanel),this.txtQuestMessage=new PIXI.extras.BitmapText("",l.QUEST_STYLE),this.txtQuestMessage.position.set(14),this.txtQuestMessage.anchor.set(0),this.questPanel.addChild(this.txtQuestMessage);var t,e={font:"26px Orbitron",tint:16711424};this.statContainer.height;this.txtHP=new PIXI.extras.BitmapText("0",e),this.txtHP.anchor.set(0,.5),this.txtHP.position=new PIXI.Point(84,this.statContainer.height/2),this.statContainer.addChild(this.txtHP),(t=new PIXI.Sprite(a.TextureLoader.Get("assets/gui-atlas.json@heart.png"))).anchor.set(.5),t.position.set(45,this.statContainer.height/2),this.statContainer.addChild(t),this.txtDust=new PIXI.extras.BitmapText("0",e),this.txtDust.anchor.set(0,.5),this.txtDust.position=new PIXI.Point(334,this.statContainer.height/2),this.statContainer.addChild(this.txtDust),this.emitter=o.createParticleEmitter(this.statContainer,[a.TextureLoader.Get("assets/objects-atlas.json@star.png")]),this.emitter.updateOwnerPos(292,64),this.emitter.maxLifetime=.6,this.emitter.maxParticles=50,this.emitter.emit=!0,this.txtCoins=new PIXI.extras.BitmapText("0",e),this.txtCoins.anchor.set(0,.5),this.txtCoins.position=new PIXI.Point(586,this.statContainer.height/2),this.statContainer.addChild(this.txtCoins),(t=new PIXI.Sprite(a.TextureLoader.Get("assets/gui-atlas.json@coin.png"))).anchor.set(.5),t.position.set(544,this.statContainer.height/2),this.statContainer.addChild(t);var i=new PIXI.Sprite(a.TextureLoader.Get("assets/gui-atlas.json@exp_panel.png"));i.position.set(0,l.SCENE_HEIGHT-i.height),this.addChild(i),this.expPreFiller=new PIXI.Sprite(a.TextureLoader.Get("assets/gui-atlas.json@exp_prefill.png")),this.expPreFiller.position.set(3,3),i.addChild(this.expPreFiller),this.expFiller=new PIXI.Sprite(a.TextureLoader.Get("assets/gui-atlas.json@exp_fill.png")),this.expFiller.position.set(3,3),i.addChild(this.expFiller),this.fillLen=i.width-6;var n={font:"18px Bauhaus"};this.txtExp=new PIXI.extras.BitmapText("0 / 1000",n),this.txtExp.pivot.set(.5),this.txtExp.anchor.set(.5),this.txtExp.position=new PIXI.Point(i.width/2,i.height/2),this.txtExp.tint=16711492,i.addChild(this.txtExp),this.txtLevel=new PIXI.extras.BitmapText("Level "+r.stats.characterLevel,n),this.txtLevel.position.set(i.x+i.width+4,i.y),this.txtLevel.tint=16711492,this.addChild(this.txtLevel),u.eventEmitter.on(u.STATCHANGE_TOPIC,this.handleStatChange),u.eventEmitter.on(u.DAMAGE_TOPIC,this.handleDpsChange)},e.prototype.onUpdate=function(t){this.emitter.update(.001*t),this.questPanel.visible&&this.questMsgEndTime<performance.now()&&(this.questPanel.visible=!1,this.onCompleteCB&&this.onCompleteCB()),this.txtPlayerPosition.text=a.Global.position.x.toFixed(0)+", "+a.Global.position.y.toFixed(0)},e.prototype.addInfoMessage=function(t,e,i,a){var o=this,r=n.__assign({font:"24px Orbitron",tint:16777215},i),u=new PIXI.extras.BitmapText(e,r);a=a||0,u.position.set(l.SCENE_HALF_WIDTH+a,l.SCENE_HEIGHT-t.y-70),u.scale.set(1,1),this.addChild(u);var c=t.y>l.SCENE_HALF_HEIGHT?250:-250,h=l.SCENE_HEIGHT-t.y+c;new s.Tween(u.position).to({y:h},2e3).start();var d=new s.Tween(u.scale).to({x:1.6,y:1.6},2200).easing(s.Easing.Linear.None),p=new s.Tween(u).to({alpha:0},3e3).onComplete(function(){return o.removeChild(u)});d.chain(p).start()},e.prototype.addQuestItemMessage=function(t){var e=this,i=l.QUEST_ITEM_STYLE,n=new PIXI.Text(t,i);n.anchor.set(.5,.5),n.position.set(l.SCENE_HALF_WIDTH,150),this.addChild(n);var a=new s.Tween(n.scale).to({x:1.8,y:1.8},2200).easing(s.Easing.Linear.None),o=new s.Tween(n).to({alpha:0},3e3).onComplete(function(){return e.removeChild(n)});a.chain(o).start()},e.prototype.setQuestMessage=function(t,e,i){void 0===e&&(e=8e3),void 0===i&&(i=null),this.txtQuestMessage.text=t,this.questPanel.visible=!0,this.questMsgEndTime=performance.now()+e,this.onCompleteCB=i},e.prototype.addLvlUpMessage=function(t){var e=this,i={align:"center",padding:0,fontSize:"64px",fontFamily:l.GUI_FONT,fill:3364147,strokeThickness:6,stroke:13421823},n=new PIXI.Text(t,i);n.scale.set(1),n.anchor.set(.5),n.position.set(l.SCENE_HALF_WIDTH,l.SCENE_HEIGHT-a.Global.position.y-70),this.addChild(n);var o=a.Global.position.y>l.SCENE_HALF_HEIGHT?450:-450,r=l.SCENE_HEIGHT-a.Global.position.y+o;new s.Tween(n.position).to({y:r},2e3).start();var u=new s.Tween(n.scale).to({x:1.6,y:1.6},1500).easing(s.Easing.Linear.None),c=new s.Tween(n).to({alpha:.4},6e3).onComplete(function(){return e.removeChild(n)});u.chain(c).start()},e.prototype.renderExp=function(t){this.txtExp.text=Math.round(t.Stats[c.StatType.LevelExp])+" / "+t.Stats[c.StatType.LevelMaxExp],this.txtLevel.text="Level "+r.stats.characterLevel;var e=Math.min(t.Stats[c.StatType.LevelExp]/t.Stats[c.StatType.LevelMaxExp],1);if(0===e)return this.expFiller.width=1,void(this.expPreFiller.position.x=1+this.expFiller.x);this.expPreFiller.position.x=this.expFiller.width+this.expFiller.x;var i=this.fillLen*e|0,n=i-this.expFiller.width;this.expPreFiller.width=1;var a=new s.Tween(this.expPreFiller).to({width:n},1500).easing(s.Easing.Linear.None),o=new s.Tween(this.expFiller).to({width:i},2e3).easing(s.Easing.Bounce.Out);a.chain(o).start()},e}(PIXI.Container);e.StatsHud=h},292:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(5),s=i(42),a=function(t){function e(e){var i=t.call(this)||this;return i.FRAME_SIZE_X=64,i.FRAME_SIZE_Y=128,i.addAnimations(new s.AnimationSequence("lava",e,[0,1,2,3],i.FRAME_SIZE_X,i.FRAME_SIZE_Y)),i.play("lava",3),i}return n.__extends(e,t),e}(s.AnimatedSprite);e.Lava=a},293:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(5),s=i(6),a=function(t){function e(e,i,n){void 0===e&&(e=1),void 0===i&&(i=1);var a,o,r,u,l,c=t.call(this)||this;c.scale.y*=-1;var h,d=n[0];(e>1||n.length>1)&&(a=n[1],o=n[2]),i>1&&(r=n[3],u=n[4],l=n[5]);var p=0;a&&(f=s.TextureLoader.Get(a),(h=new PIXI.Sprite(f)).position.set(p+1,0),p+=f.width,c.addChild(h));var f=s.TextureLoader.Get(d);if(e>1){var m=f.width*e,y=f.height;(h=new PIXI.extras.TilingSprite(f,m,y)).position.set(p,0),p+=m}else(h=new PIXI.Sprite(f)).position.set(p,0),p+=h.width;c.addChild(h),o&&(f=s.TextureLoader.Get(o),(h=new PIXI.Sprite(f)).position.set(p-1,0),p+=h.width,c.addChild(h));var v=e+2;if(i>1)for(p=0;p<v;p++){var g;g=0===p?u:p===v-1?l:r;for(var S=1;S<i;S++)f=s.TextureLoader.Get(g),(h=new PIXI.Sprite(f)).position.set(p*h.width,S*h.height),c.addChild(h)}return c}return n.__extends(e,t),e}(PIXI.Container);e.Platform=a},294:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(5),s=i(6),a="assets/objects-atlas.json@bumper_01.png",o="assets/objects-atlas.json@bumper_rotor_01.png",r=Math.PI/8,u=function(t){function e(){var e=t.call(this,s.TextureLoader.Get(a))||this;return e.onUpdate=function(t){var i=e.rotor.rotation-r*t/1e3;e.rotor.rotation=i%Math.PI},e.rotor=new PIXI.Sprite(s.TextureLoader.Get(o)),e.rotor.anchor.set(.5),e.rotor.pivot.set(.5),e.addChild(e.rotor),e.anchor.set(.5),e}return n.__extends(e,t),e}(PIXI.Sprite);e.Bumper=u},295:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(20),s=i(296),a=i(22),o=i(25),r=i(36),u=i(18),l=function(){function t(t){this.gameScene=t,this.questState=[],this.hud=this.gameScene.HudOverlay}return t.prototype.reset=function(){var t=this;this.questState.forEach(function(e,i){e!=s.QuestState.None&&(t.findQuest(i).itemsCollected=0)}),this.questState=[]},t.prototype.acquireItem=function(t){var e=this.findQuestWithItem(t);e&&(e.itemsCollected++,this.hud.addQuestItemMessage("collected "+e.itemsCollected+" / "+e.itemsNeeded),e.itemsCollected>=e.itemsNeeded&&(this.setQuestState(e.id,s.QuestState.Completed),e.completedMsg&&this.hud.setQuestMessage(e.completedMsg)))},t.prototype.canActivateTrigger=function(t){if(!t||!t.questId)return!1;if(Array.isArray(t.dependsOn))for(var e=0;e<t.dependsOn.length;e++){var i=t.dependsOn[e],n=this.questState[i];if(!n||n!=s.QuestState.Rewarded)return!1}return(t.lastActive||-1e4)+1e4<performance.now()},t.prototype.handleTriggerEvent=function(t){var e=this,i=n.getScm(),o=t.Trigger,u=Math.max(this.getQuestState(o.questId),o.state||0);if(this.canActivateTrigger(o)){o.lastActive=performance.now();var l=this.findQuest(o.questId);switch(o.questId){case 1:u===s.QuestState.None&&(this.setQuestState(o.questId,s.QuestState.Completed),this.gameScene.IsHeroInteractive=!1,this.hud.setQuestMessage(l.welcomeMsg,2e3,function(){e.hud.setQuestMessage(l.completedMsg,2e3,function(){e.gameScene.IsHeroInteractive=!0,e.setQuestState(o.questId,s.QuestState.Finished),e.giveRewards(l),e.setQuestState(o.questId+1,s.QuestState.InProgress),l=e.findQuest(o.questId+1),e.hud.setQuestMessage(l.welcomeMsg,4e3)})}));break;case 2:this.getQuestState(1)>s.QuestState.Finished&&(u===s.QuestState.InProgress?(this.setQuestState(o.questId,s.QuestState.Completed),this.hud.setQuestMessage(l.completedMsg,4e3,function(){e.gameScene.IsHeroInteractive=!0,e.setQuestState(o.questId,s.QuestState.Finished),e.giveRewards(l),l=e.findQuest(o.questId+1),e.setQuestState(o.questId+1,s.QuestState.InProgress),e.hud.setQuestMessage(l.welcomeMsg)})):u>=s.QuestState.Finished&&(l=this.findQuest(o.questId+1),this.hud.setQuestMessage(l.welcomeMsg,4e3)));break;case 3:u===s.QuestState.InProgress&&(this.setQuestState(o.questId,s.QuestState.Finished),this.giveRewards(l),this.gameScene.IsHeroInteractive=!1,this.hud.setQuestMessage(l.completedMsg,4e3,function(){n.getScm().ActivateScene("Loader")}),a.stats.saveUserState(!0),r.snd.win());break;case 201:this.genericQuestHandler(l,u,t,[function(){n.worldContainer.getChildByName("quest_item_201").visible=!0;var t=e.findBodyByName("lock");e.gameScene.removeEntity(t,!0)},function(){},function(){e.setQuestState(o.questId,s.QuestState.Finished),e.giveRewards(l),e.gameScene.IsHeroInteractive=!1,a.stats.saveUserState(!0),r.snd.win(),e.hud.visible=!1;var t=i.GetScene("CutScene");t.SetText(l.finishedMsg);var n=i.CaptureScene();t.SetBackGround(n,e.gameScene.scale),i.ActivateScene(t)}]);break;case 203:this.genericQuestHandler(l,u,t,[function(){a.stats.HasJumpAtack=!0},function(){},function(){},function(){}]);break;default:this.genericQuestHandler(l,u,t)}}},t.prototype.genericQuestHandler=function(t,e,i,n){var a=i.Trigger;switch(e){case s.QuestState.None:this.setQuestState(t.id,s.QuestState.InProgress),this.hud.setQuestMessage(t.welcomeMsg);break;case s.QuestState.InProgress:this.hud.setQuestMessage(t.objectiveMsg);break;case s.QuestState.Completed:t.itemId&&t.itemsCollected>=t.itemsNeeded?(this.setQuestState(t.id,s.QuestState.Finished),a.lastActive=0):this.hud.setQuestMessage(t.completedMsg);break;case s.QuestState.Finished:this.hud.setQuestMessage(t.finishedMsg),this.giveRewards(t),this.gameScene.removeEntity(i,!0)}n&&n[e]&&n[e]()},t.prototype.giveRewards=function(t){r.snd.questItem(),t.rewardExp&&a.stats.increaseStat(u.StatType.TotalExp,t.rewardExp),t.rewardCoins&&a.stats.increaseStat(u.StatType.Coins,t.rewardCoins),this.setQuestState(t.id,s.QuestState.Rewarded)},t.prototype.findQuest=function(t){return n.LevelDefinitions.quests.filter(function(e){return e.id===t})[0]},t.prototype.findQuestWithItem=function(t){var e=this,i=n.LevelDefinitions.quests.filter(function(i){if(i.itemId===t){var n=e.getQuestState(i.id);return n<s.QuestState.Completed&&n>s.QuestState.None}return!1});return i.length>0?i[0]:null},t.prototype.setQuestState=function(t,e){this.questState[t]=e},t.prototype.getQuestState=function(t){return this.questState[t]||s.QuestState.None},t.prototype.findBodyByName=function(t){var e=void 0;return o.wp2.bodies.forEach(function(i){var n=i.DisplayObject;n&&n.name===t&&(e=i)}),e},t}();e.QuestManager=l},296:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.None=0]="None",t[t.InProgress=1]="InProgress",t[t.Completed=2]="Completed",t[t.Finished=3]="Finished",t[t.Rewarded=4]="Rewarded"}(e.QuestState||(e.QuestState={}))},297:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(5),s=i(6),a=i(15),o=function(t){function e(e){var i=t.call(this,e,"Options")||this;return i.currentMusicTrack=0,i.onActivate=function(){i.sceneManager.MasterHudOverlay.children.find(function(t,e){return"BTN_OPTIONS"==t.name}).visible=!1},i.onDeactivate=function(){i.sceneManager.MasterHudOverlay.children.find(function(t,e){return"BTN_OPTIONS"==t.name}).visible=!0},i.setup=function(){var t=new s.PIXI.extras.BitmapText("Options",a.TEXT_STYLE);i.addChild(t),t.anchor.set(.5),t.x=a.SCENE_HALF_WIDTH,t.y=20;var e=a.BTN_WIDTH/3,n=a.SCENE_HEIGHT-a.BTN_HEIGHT-e,o=new s.Button("assets/gui-atlas.json@gui_button1.png",e,n,a.BTN_WIDTH,a.BTN_HEIGHT);o.text=new s.PIXI.Text("Back to game",a.BTN_STYLE),o.onClick=function(){i.sceneManager.ActivatePreviousScene()},i.addChild(o)},i.BackGroundColor=a.SCENE_BACKCOLOR,i.setup(),i}return n.__extends(e,t),e}(s.Scene);e.OptionsScene=o},298:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(5),s=i(131),a=i(129),o=i(36),r=i(6),u=i(15),l=function(t){function e(e){var i=t.call(this,e,"CutScene")||this;return i.deathScene=!1,i.onActivate=function(){if(i.btnContinue.visible=!i.deathScene,i.callout.visible=!i.deathScene,i.corpse.visible=i.deathScene,i.corpse.scale.set(.1),i.btnContinue.text.text=i.deathScene?"Retry":"Continue",i.deathScene){var t=o.snd.getTrack("Carrousel");o.snd.playTrack(t)}},i.deathMessages=["Life sucks and you just died!","You decided to check the afterlife.\nGuess what? You are dead!","Owned!\nMore luck next time.","You have died!\nRest in peace.","Your quest has failed.\nMay you find more peace in\nthat world than you found in this one.","Here's a picture of your corpse.\nNot pretty!","Yep, you're dead.\nMaybe you should consider\nplaying a Barbie game!","Died..."],i.BackGroundColor=1087931,i.corpse=new PIXI.Sprite(r.TextureLoader.Get("assets/objects-atlas.json@hero-dead.png")),i.corpse.anchor.set(.5),i.corpse.pivot.set(.5),i.corpse.position.set(r.SCENE_HALF_WIDTH,r.SCENE_HALF_HEIGHT),i.addChild(i.corpse),i.corpseBlurFilter=new PIXI.filters.BlurFilter,i.corpse.filters=[i.corpseBlurFilter],i.callout=new PIXI.Sprite(r.TextureLoader.Get("assets/gui-atlas.json@rect.png")),i.callout.anchor.set(.5),i.callout.position.set(r.SCENE_HALF_WIDTH,r.SCENE_HEIGHT/5),i.addChild(i.callout),i.textMessage=new PIXI.extras.BitmapText("",u.QUEST_STYLE),i.textMessage.anchor.set(.5),i.textMessage.position.set(0,0),i.callout.addChild(i.textMessage),i.btnContinue=new a.Button("assets/gui-atlas.json@gui_button1.png",(r.SCENE_WIDTH-r.BTN_WIDTH)/2,i.callout.height+r.BTN_HEIGHT,r.BTN_WIDTH,r.BTN_HEIGHT),i.btnContinue.text=new PIXI.Text("Continue",r.BTN_STYLE),i.btnContinue.onClick=function(){i.sceneManager.ActivateScene("Loader")},i.addChild(i.btnContinue),i}return n.__extends(e,t),e.prototype.onUpdate=function(t){if(this.deathScene)if(this.corpse.scale.x<2.5){this.corpse.rotation+=.03;var e=this.corpse.scale.x+.01;this.corpse.scale.set(e)}else this.deathScene=!1,this.textMessage.text=this.deathMessages[0|Math.random()*this.deathMessages.length],this.callout.visible=!0,this.btnContinue.visible=!0;else this.corpse.rotation+=.005;var i=Math.max(5,this.corpseBlurFilter.blur+4e-5);this.corpseBlurFilter.blur=i},Object.defineProperty(e.prototype,"DeathScene",{get:function(){return this.deathScene},set:function(t){if(this.deathScene=t,this.deathScene){this.corpseBlurFilter.blur=0;var e=new PIXI.filters.ColorMatrixFilter;e.sepia(),this.backSprite.filters=[e]}else this.backSprite.filters=null},enumerable:!0,configurable:!0}),e.prototype.SetBackGround=function(t,e){this.backSprite?this.backSprite.texture=t:(this.backSprite=new PIXI.Sprite(t),this.addChildAt(this.backSprite,0)),this.backSprite.scale.set(1/e.x,1/e.y)},e.prototype.SetText=function(t){this.textMessage.text=t},e}(s.Scene);e.CutScene=l},33:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.eventEmitter=new PIXI.utils.EventEmitter,e.MOVE_TOPIC="MOVE",e.BURN_TOPIC="BURN",e.STATCHANGE_TOPIC="STATCHANGE",e.DAMAGE_TOPIC="DAMAGE",e.GROUND_SHAKE="SHAKE"},36:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(284),s=function(){function t(){this.musicTrackNames=["assets/audio/Two-Finger-Johnny.mp3","assets/audio/Bumbling-Burglars_Looping.mp3","assets/audio/Bama-Country.mp3","assets/audio/Beachfront-Celebration.mp3","assets/audio/Easy-Jam.mp3","assets/audio/Whiskey-on-the-Mississippi.mp3","assets/audio/ZigZag.mp3","assets/audio/Carrousel.mp3","assets/audio/Disco-Break.mp3"],this.musicTracks=[],this.currentTrack=0,this.previousMusicVolume=.6,this.previousFxVolume=1,this.musicVolume=.6,this.fxVolume=1;for(var t=0,e=this.musicTrackNames.length;t<e;t++){var i=this.musicTrackNames[t];this.musicTracks.push(new n.Howl({preload:!1,src:[i],autoplay:!1,loop:!0,volume:.6}))}this.walkSnd=new n.Howl({src:["assets/audio/effects/step.mp3"],preload:!0,autoplay:!1,loop:!0,volume:1}),this.jumpSnd1=new n.Howl({src:["assets/audio/effects/jump1.mp3"],preload:!0,autoplay:!1,loop:!1,volume:1}),this.jumpSnd2=new n.Howl({src:["assets/audio/effects/jump2.mp3"],preload:!0,autoplay:!1,loop:!1,volume:1}),this.burnSnd=new n.Howl({src:["assets/audio/effects/burn.mp3"],preload:!0,autoplay:!1,loop:!0,volume:1}),this.hurtSnd=new n.Howl({src:["assets/audio/effects/hurt.mp3"],preload:!0,autoplay:!1,loop:!1,volume:1}),this.coinSnd=new n.Howl({src:["assets/audio/effects/coin.mp3"],preload:!0,autoplay:!1,loop:!1,volume:1}),this.gemSnd=new n.Howl({src:["assets/audio/effects/gem.mp3"],preload:!0,autoplay:!1,loop:!1,volume:1}),this.questItemSnd=new n.Howl({src:["assets/audio/effects/quest-item.mp3"],autoplay:!1,loop:!1,volume:1}),this.winSnd=new n.Howl({src:["assets/audio/effects/win.mp3"],autoplay:!1,loop:!1,volume:1}),this.atkMag1=new n.Howl({src:["assets/audio/effects/atk-mag01.mp3"],autoplay:!1,loop:!1,volume:1}),this.hitMag1=new n.Howl({src:["assets/audio/effects/hit-mag01.mp3"],autoplay:!1,loop:!1,volume:1}),this.jumpAtk=new n.Howl({src:["assets/audio/effects/jump-atk01.mp3"],autoplay:!1,loop:!1,volume:1}),this.pain=new n.Howl({src:["assets/audio/effects/pain01.mp3"],autoplay:!1,loop:!1,volume:1}),this.jmpContact=new n.Howl({src:["assets/audio/effects/jmp-contact.mp3"],autoplay:!1,loop:!1,volume:1}),this.woosh=new n.Howl({src:["assets/audio/effects/woosh.mp3"],autoplay:!1,loop:!1,volume:1}),this.squish=new n.Howl({src:["assets/audio/effects/mob-squish.mp3"],autoplay:!1,loop:!1,volume:1}),this.fxDemoSnd=new n.Howl({src:["assets/audio/effects/fx-demo.mp3"],autoplay:!1,loop:!1,volume:1})}return Object.defineProperty(t.prototype,"MusicVolume",{get:function(){return this.musicVolume},set:function(t){this.musicVolume=t,this.backgroundSnd&&this.backgroundSnd.playing()&&this.backgroundSnd.volume(this.musicVolume)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"FxVolume",{get:function(){return this.fxVolume},set:function(t){this.fxVolume=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"IsFxOn",{get:function(){return this.fxVolume>0},set:function(t){t?this.FxVolume=this.previousFxVolume:(this.previousFxVolume=this.fxVolume,this.FxVolume=0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"IsMusicOn",{get:function(){return this.musicVolume>0},set:function(t){t?this.MusicVolume=this.previousMusicVolume:(this.previousMusicVolume=this.musicVolume,this.MusicVolume=0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"CurrentTrackId",{get:function(){return this.currentTrack},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fxDemo",{get:function(){return this.fxDemoSnd},enumerable:!0,configurable:!0}),t.prototype.jumpAttack=function(){this.walkSnd.pause(),this.jumpAtk.loop(!1),this.jumpAtk.play(),this.jumpAtk.volume(this.fxVolume)},t.prototype.jump=function(){this.walkSnd.pause(),this.jumpSnd1.play(),this.jumpSnd1.volume(this.fxVolume)},t.prototype.idle=function(){this.walkSnd.pause()},t.prototype.walk=function(t){this.walkSnd.rate(t?2:1.2),this.walkSnd.playing()||(this.walkSnd.volume(this.fxVolume),this.walkSnd.play())},t.prototype.atkMagic1=function(){this.atkMag1.volume(this.fxVolume),this.atkMag1.play()},t.prototype.hitMagic1=function(){this.hitMag1.volume(this.fxVolume),this.hitMag1.play()},t.prototype.hitPain=function(){this.pain.volume(this.fxVolume),this.pain.play()},t.prototype.mobSquish=function(){this.squish.volume(this.fxVolume),this.squish.play()},t.prototype.bulletHitWall=function(){this.woosh.volume(this.fxVolume),this.woosh.play()},t.prototype.coin=function(){this.coinSnd.volume(this.fxVolume),this.coinSnd.play()},t.prototype.gem=function(){this.gemSnd.volume(this.fxVolume),this.gemSnd.play()},t.prototype.hurt=function(){this.hurtSnd.volume(this.fxVolume),this.hurtSnd.play()},t.prototype.jumpContact=function(){this.jmpContact.volume(this.fxVolume),this.jmpContact.play()},t.prototype.questItem=function(){this.questItemSnd.volume(this.fxVolume),this.questItemSnd.play()},t.prototype.win=function(){this.backgroundSnd&&this.backgroundSnd.playing()&&this.backgroundSnd.fade(1,0,500),this.hurtSnd.stop(),this.walkSnd.stop(),this.jumpSnd1.stop(),this.jumpSnd2.stop(),this.burnSnd.stop(),this.winSnd.volume(this.fxVolume),this.winSnd.play()},t.prototype.burn=function(){this.burnSnd.playing()||(this.burnSnd.volume(this.fxVolume),this.burnSnd.play()),this.hurt()},t.prototype.burnStop=function(){var t=this;this.burnSnd.fade(1,0,200),setTimeout(function(){return t.burnSnd.stop()},200)},t.prototype.getTrack=function(t){for(var e=0,i=this.musicTrackNames.length;e<i;e++)if(this.musicTrackNames[e].indexOf(t)>=0)return e;return-1},t.prototype.stopTrack=function(){void 0!==this.backgroundSnd&&this.backgroundSnd.stop()},t.prototype.playTrack=function(t){var e=this;void 0===this.backgroundSnd&&(this.backgroundSnd=this.musicTracks[t],console.log("playTrack "+t,this.backgroundSnd)),this.backgroundSnd===this.musicTracks[t]&&this.backgroundSnd.playing()||(this.backgroundSnd.stop(),this.backgroundSnd=this.musicTracks[t],this.backgroundSnd.volume(this.musicVolume),this.backgroundSnd.play(),"unloaded"===this.backgroundSnd.state()&&(this.backgroundSnd.load(),this.backgroundSnd.once("load",function(){e.backgroundSnd.play()}))),this.currentTrack=t},t}();e.SoundMan=s,e.snd=new s},42:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(5),s=i(68),a=i(0),o=i(128),r=function(t){function e(){var e=t.call(this)||this;return e.animations=new s.Dictionary,e.currentSequence=null,e.play=function(t,i,n){void 0===n&&(n=!0),e.currentSequence&&e.currentSequence.sequenceName===t||(e.resetAnimation(),e.currentSequence=e.animations.get(t),e.texture=e.currentSequence.spriteSheet,e.texture.frame=e.currentSequence.frames[0],e.isPlaying=!0),e.fps=i||e.fps,e.isLooping=n},e.accumulator=0,e.isPlaying=!1,e.isLooping=!1,e.frameIndex=0,e.currentFps=8,e.pivot.set(.5),e.anchor.set(.5),e}return n.__extends(e,t),e.prototype.addAnimations=function(){for(var t=this,e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];e.forEach(function(e,i){t.animations.set(e.sequenceName,e),t.texture.valid||0!==i||(t.texture=e.spriteSheet,t.texture.frame=e.frames[0])})},e.prototype.clearAnimations=function(){this.stop(),this.currentSequence=null,this.animations.clear()},e.prototype.onUpdate=function(t){if(this.isPlaying&&this.texture.valid&&this.currentSequence){this.accumulator+=t;var e=1e3/this.fps;this.accumulator>e&&(this.accumulator-=e,this.texture.frame=this.currentSequence.frames[++this.frameIndex],this.frameIndex==this.currentSequence.frames.length-1&&(this.frameIndex=0,this.isLooping||(this.isPlaying=!1,this.onCompleteCallBack&&this.onCompleteCallBack(this.currentSequence))))}},Object.defineProperty(e.prototype,"onComplete",{get:function(){return this.onCompleteCallBack},set:function(t){this.onCompleteCallBack=t},enumerable:!0,configurable:!0}),e.prototype.stop=function(){this.isPlaying=!1},Object.defineProperty(e.prototype,"fps",{get:function(){return this.currentFps},set:function(t){this.currentFps=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"loop",{get:function(){return this.isLooping},set:function(t){this.isLooping=t},enumerable:!0,configurable:!0}),e.prototype.resetAnimation=function(){this.stop(),this.currentSequence=null,this.accumulator=0,this.frameIndex=-1},e}(a.Sprite);e.AnimatedSprite=r;var u=function(){function t(t,e,i,n,s){void 0===i&&(i=[]);var r=this;this.sequenceName=t,this.frames=[];var u=o.TextureLoader.Get(e),l=o.TextureLoader.IsAtlas(u);this.spriteSheet=new a.Texture(u.baseTexture);var c=l?Math.floor(u.frame.width/n):Math.floor(this.spriteSheet.width/n);i.forEach(function(t){var e=Math.floor(t/c),i=t%c,o=null;o=l?new a.Rectangle(u.frame.x+i*n,u.frame.y+e*s,n,s):new a.Rectangle(i*n,e*s,n,s),r.frames.push(o)})}return Object.defineProperty(t.prototype,"frameCount",{get:function(){return this.frames.length},enumerable:!0,configurable:!0}),t}();e.AnimationSequence=u},44:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(5),s=i(20),a=i(45),o=i(6),r=i(75),u=i(283),l=i(160),c=i(132),h=i(15),d=i(21),p=function(){function t(t){this.gameLevels=t}return t.registerFactory=function(t,e){this.factoryList.set(t,e)},t.prototype.buildLevel=function(t){for(var e,i=void 0,n=0;n<this.gameLevels.levels.length;n++)if(this.gameLevels.levels[n].id===t){i=this.gameLevels.levels[n];break}return i&&(e=this.createLevel(i)),e},t.prototype.createLevel=function(e){var i={parallax:[],entities:[],start:[],audioTrack:e.audioTrack,templates:[],spawnPoints:[]},n=new PIXI.Point(h.SCENE_WIDTH,h.SCENE_HEIGHT);e.parallax.forEach(function(t){var e=new o.Parallax(n,t.parallaxFactor,t.textures,t.scale);e.y=t.y,i.parallax.push(e)});var a=s.LevelDefinitions.templates.concat(e.map.templates);return i.templates=a,e.map.entities.forEach(function(e,n,s){var o=t.createEntity(a,e);i.entities.push(o)}),e.map.NPC=e.map.NPC||[],e.map.NPC.forEach(function(e,n,s){if(e.type&&"spawn_point"===e.type){var o=e,r=o.entity;i.spawnPoints.push(new u.SpawnPoint(o.name,o.xy[0],o.xy[1],o.area,o.maxMobCount,o.respawnSeconds,r))}else{var l=t.createMob(a,e);i.entities.push(l)}}),i.start=e.map.start,i},t.createEntity=function(e,i){var n,s=c.getEntityDefinition(e,i),o=t.buildDisplayObject(s.doDef);return o.name=i.name||i.template,o.templateName=s.templateName,s.bdDef?((n=t.buildPhysicsObject(s.bdDef,o)).shapes.every(function(t){return"ground"===s.bdDef.collisionType?(t.collisionGroup=r.COL_GRP_GROUND,t.collisionMask=r.COL_GRP_PLAYER|r.COL_GRP_NPC|r.COL_GRP_SCENE|r.COL_GRP_BULLET):(t.collisionGroup=r.COL_GRP_SCENE,t.collisionMask=r.COL_GRP_PLAYER|r.COL_GRP_NPC|r.COL_GRP_SCENE|r.COL_GRP_GROUND),!0}),n.DisplayObject=o,s.trigger&&(n.Trigger=s.trigger)):(n=new a.Body).DisplayObject=o,n},t.createMob=function(e,i){var n=c.getEntityDefinition(e,i),s=t.buildDisplayObject(n.doDef);s.name=i.name||i.template,s.templateName=n.templateName,s.attributes=i.attributes||n.doDef.attributes||[],s.createAI(i.ai||"basic_static"),s.atkTexture=i.attack||n.doDef.attack,n.bdDef.material=n.bdDef.material||"mob_default";var a=t.buildPhysicsObject(n.bdDef,s);return a.shapes.every(function(t){return t.collisionGroup=r.COL_GRP_NPC,t.collisionMask=r.COL_GRP_PLAYER|r.COL_GRP_GROUND|r.COL_GRP_SCENE,!0}),a.DisplayObject=s,n.trigger&&(a.Trigger=n.trigger),a},t.buildDisplayObject=function(t){var e;switch((t=n.__assign({anchor:.5,pivot:.5,scale:[1,1]},t)).typeName){case"Mob":var i=new l.Mob(t.texture);t.sequences&&(i.clearAnimations(),t.sequences.forEach(function(e){var n=e.texture||t.texture,s=new o.AnimationSequence(e.name,n,e.frames,e.framesize[0],e.framesize[1]);i.addAnimations(s)}),i.play(t.sequences[0].name)),t.fps&&(i.fps=t.fps),i.typeName="Mob",e=i;break;case"Sensor":(e=new PIXI.DisplayObject).typeName="Sensor";break;case"AnimatedSprite":var s=new o.AnimatedSprite;t.sequences.forEach(function(t,e,i){var n=new o.AnimationSequence(t.name,t.texture,t.frames,t.framesize[0],t.framesize[1]);s.addAnimations(n)}),s.play(t.sequences[0].name,t.fps),s.typeName="AnimatedSprite",e=s;break;case"Sprite":var a=d.TextureLoader.Get(t.texture),r=new PIXI.Sprite(a);r.typeName="Sprite",e=r;break;default:var u=this.factoryList.get(t.typeName);if(!u)throw"Factory not found for object name: "+t.typeName;e=u(t)}return e.scale.set(t.scale[0],-1*t.scale[1]),e.anchor&&e.anchor.set(t.anchor),e.pivot.set(t.pivot),void 0!==t.visible&&(e.visible=t.visible),e.rotation=t.rotation||0,t.xy&&e.position.set(t.xy[0],t.xy[1]),t.interactionType&&(e.interactionType=t.interactionType),t.drop&&(e.drop=t.drop),t.tint&&(e.tint=parseInt(t.tint,16)),e},t.buildPhysicsObject=function(t,e,i){var n;void 0===i&&(i=!1);var s=0,o=0;if(t){var r={mass:t.mass,position:t.xy?t.xy:[e.x,e.y],angle:t.angle||e.rotation,fixedRotation:t.fixedRotation||!1,angularDamping:t.angularDamping||.1,damping:t.damping||.1};(n=new a.Body(r)).type=t.type||a.Body.KINEMATIC;var u,l=e;switch(t.shape){case"Circle":var c=32;c=t.size?t.size.constructor===Array?t.size[0]:t.size:l.width,u=new a.Circle({radius:c});break;case"Platform":t.size?(s=t.size[0],o=t.size[1]):(s=Math.abs(l.width),o=Math.abs(l.height)),u=new a.Box({width:s,height:o}),n.position[0]=n.position[0]+s/2,n.position[1]=n.position[1]-o/2;break;case"Box":t.size?(s=t.size[0],o=t.size[1]):l.width?(s=Math.abs(l.width),o=Math.abs(l.height)):(s=e.scale.x*e.getLocalBounds().width,o=e.scale.y*e.getLocalBounds().height),u=new a.Box({width:s,height:o})}t.material&&(u.materialName=t.material),!i&&e.interactionType?(u.sensor=!0,n.type=a.Body.STATIC,n.collisionResponse=!1,n.setDensity(0),console.log("created collectible sensor",u)):"Sensor"===e.typeName&&(u.sensor=!0,n.type=a.Body.STATIC,n.collisionResponse=!1,n.setDensity(0)),n.addShape(u)}return n},t.factoryList=new d.Dictionary,t}();e.LevelLoader=p},6:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(5),s=i(0);e.PIXI=s;var a=i(20);e.Global=a,n.__exportStar(i(21),e),n.__exportStar(i(15),e)},68:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){this._values={},this._keys=[]}return t.prototype.get=function(t){return this._values[t]},t.prototype.contains=function(t){return t in this._values},t.prototype.remove=function(t){var e=this._keys.indexOf(t,0);this._keys.splice(e,1),delete this._values[t]},t.prototype.set=function(t,e){t in this._values||this._keys.push(t),this._values[t]=e},Object.defineProperty(t.prototype,"keys",{get:function(){return this._keys},enumerable:!0,configurable:!0}),t.prototype.getAll=function(){return this._values},t.prototype.getSet=function(t,e){return this.contains(t)||this.set(t,"function"==typeof e?e():e),this.get(t)},t.prototype.clear=function(){this._keys=[],this._values={}},t}();e.Dictionary=n},75:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.COL_GRP_PLAYER=1,e.COL_GRP_NPC=2,e.COL_GRP_SCENE=4,e.COL_GRP_BULLET=8,e.COL_GRP_GROUND=16}},[[162,0,1,5]]]);