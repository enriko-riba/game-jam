(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{128:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,s=i(5),a=i(0),o=i(42);!function(e){e[e.Texture=0]="Texture",e[e.Filter=1]="Filter"}(n=t.OutlineMode||(t.OutlineMode={}));var r=function(e){function t(t,i,n,s,a){void 0===i&&(i=0),void 0===n&&(n=0),void 0===s&&(s=128),void 0===a&&(a=32);var o=e.call(this)||this;return o._isHighlighted=!1,o._isPressed=!1,o._isDisabled=!1,o._isClickStarted=!1,o.requestedWidth=0,o.requestedHeight=0,o.onButtonDown=function(){o._isDisabled||(o._isClickStarted=!0,o.texture=o.textureDown)},o.onButtonUp=function(e){o._isDisabled||(o._isClickStarted&&(o._isClickStarted=!1,o.onClickHandler(e)),o.applyTexture())},o.onButtonUpOutside=function(){o._isDisabled||(o.applyTexture(),o._isClickStarted=!1)},o.onButtonOver=function(e){o._isDisabled||(o.texture=o.textureHighlight,o.mouseover&&o.mouseover(e))},o.onButtonOut=function(e){o._isDisabled||(o._isClickStarted=!1,o.applyTexture(),o.mouseout&&o.mouseout(e))},o.position.set(i||0,n||0),o.requestedHeight=a,o.requestedWidth=s,o.setTexture(t),o.buttonMode=!1,o.interactive=!0,o.cursor="hover",o.on("pointerdown",o.onButtonDown),o.on("pointerup",o.onButtonUp),o.on("pointerupoutside",o.onButtonUpOutside),o.on("pointerover",o.onButtonOver),o.on("pointerout",o.onButtonOut),o.isPressed=!1,o}return s.__extends(t,e),Object.defineProperty(t.prototype,"outlineMode",{get:function(){return this._outlineMode},set:function(e){this._outlineMode=e,this.filters=this._outlineMode==n.Filter?[new o.OutlineFilter(1,this._outlineColor,.5)]:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"outlineColor",{get:function(){return this._outlineColor},set:function(e){this._outlineColor=e,this.filters=this._outlineMode==n.Filter?[new o.OutlineFilter(1,this._outlineColor,.5)]:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"disabled",{get:function(){return this._isDisabled},set:function(e){this._isDisabled=e,this.cursor=e?"":"hover",this.applyTexture()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isPressed",{get:function(){return this._isPressed},set:function(e){this._isPressed=e,this.applyTexture()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isHighlighted",{get:function(){return this._isHighlighted},set:function(e){this._isHighlighted=e,this.applyTexture()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this._text},set:function(e){if(this._text&&this.removeChild(this._text),this._text=e,this._text){this._text.anchor.set(.5,.5);var t=this.width/this.scale.x/2,i=this.height/this.scale.y/2;this._text.position.set(t,i),this.addChild(this._text)}},enumerable:!0,configurable:!0}),t.prototype.onClickHandler=function(e){this.onClick?this.onClick(e):console.warn("onClick() empty, did you forget to attach a handler?")},t.prototype.applyTexture=function(){this._isDisabled?(this.texture=this.textureUp,this.tint=6316128):this._isHighlighted?(this.texture=this.textureHighlight,this.tint=6710886):(this.texture=this._isPressed?this.textureDown:this.textureUp,this.tint=16777215)},t.prototype.performClick=function(e){this.onClickHandler(e)},t.prototype.setTexture=function(e){var t=a.loader.resources[e].texture;t.baseTexture.scaleMode=a.SCALE_MODES.NEAREST;var i=t.height/3,n=t.width;this.textureUp=new a.Texture(t.baseTexture,new a.Rectangle(0,0*i,n,i)),this.textureHighlight=new a.Texture(t.baseTexture,new a.Rectangle(0,1*i,n,i)),this.textureDown=new a.Texture(t.baseTexture,new a.Rectangle(0,2*i,n,i));var s=(this.requestedWidth||n)/n,o=(this.requestedHeight||i)/i;this.scale.set(s,o),this.applyTexture()},t}(a.Sprite);t.Button=r},129:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(0),s=i(31);!function(e){e[e.GLOBAL=0]="GLOBAL",e[e.MENU=1]="MENU",e[e.IN_GAME=2]="IN_GAME",e[e.CUSTOM1=3]="CUSTOM1",e[e.CUSTOM2=4]="CUSTOM2",e[e.CUSTOM3=5]="CUSTOM3",e[e.CUSTOM4=6]="CUSTOM4",e[e.CUSTOM5=7]="CUSTOM5"}(t.State||(t.State={}));var a=function(){function e(e,t,i,a){var r=this;this.currentScene=null,this.scenes=[],this.startTime=null,this.animationFrameHandle=-1,this.Destroy=function(){cancelAnimationFrame(r.animationFrameHandle),r.currentScene&&r.currentScene.pause(),r.scenes.forEach(function(e){r.RemoveScene(e)}),r.renderer.destroy(!0)},this.resizeHandler=function(){var e=r.sceneResizer.GetAvailableSize(),t=r.sceneResizer.GetAspectRatio(),i=r.sceneResizer.CalculateSize(e,t);r.renderer.resize(i.x,i.y),r.currentScene&&(r.currentScene.scale.set(r.sceneResizer.CalculateScale(i)),r.currentScene.onResize()),r.masterHudOverlay&&r.masterHudOverlay.scale.set(r.sceneResizer.CalculateScale(i))},this.render=function(e){if(r.animationFrameHandle=requestAnimationFrame(r.render),s.update(e),r.currentScene&&!r.currentScene.isPaused()){r.startTime||(r.startTime=e);var t=e-r.startTime;t>50&&(t=50),r.currentScene.onUpdate(t),r.startTime=e,r.renderer.render(r.masterContainer,void 0,r.currentScene.clear)}},this.designWidth=e,this.designHeight=t,this.sceneResizer=a||new o(this.designWidth,this.designHeight),this.masterContainer=new n.Container,i||(i={antialias:!1,roundPixels:!0,backgroundColor:74037,transparent:!0}),this.renderer=n.autoDetectRenderer(e,t,i),this.renderer.autoResize=!0,this.render.textureGC&&(this.render.textureGC.mode=n.GC_MODES.AUTO),window.removeEventListener("resize",this.resizeHandler),window.addEventListener("resize",this.resizeHandler,!0),this.render(0)}return Object.defineProperty(e.prototype,"Renderer",{get:function(){return this.renderer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CurrentScene",{get:function(){return this.currentScene},enumerable:!0,configurable:!0}),e.prototype.AddScene=function(e){this.scenes.push(e),e.sceneManager=this},e.prototype.RemoveAllScenes=function(){this.scenes.forEach(function(e){e.sceneManager=void 0,e.onDestroy(!0)}),this.scenes=[],this.currentScene=null},e.prototype.RemoveScene=function(e){this.scenes=this.scenes.filter(function(t,i,n){return t!==e}),e.sceneManager=void 0},e.prototype.HasScene=function(e){var t=this.scenes.filter(function(t){return t.Name===e});return t&&t.length>0},e.prototype.GetScene=function(e){var t=this.scenes.filter(function(t){return t.Name===e});if(!t||0===t.length)throw Error("Scene: '"+e+"' not found");if(t.length>1)throw Error("Multiple scenes: '"+e+"' found");return t[0]},e.prototype.ActivateScene=function(e){var t;if("string"==typeof e){var i=this.scenes.filter(function(t){return t.Name===e});if(!i||0===i.length)throw Error("Scene: '"+e+"' not found");if(i.length>1)throw Error("Multiple scenes: '"+e+"' found");t=i[0]}else t=e;this.currentScene&&this.currentScene!==t&&(console.log("DeactivateScene "+this.currentScene.Name),this.currentScene.onDeactivate()),console.log("ActivateScene "+t.Name),this.startTime=null,this.lastScene=this.currentScene!=t?this.currentScene:this.lastScene,this.currentScene=t,this.renderer.backgroundColor=t.BackGroundColor,this.resizeHandler(),t.onActivate(),this.masterContainer.removeChildren(),this.masterContainer.addChild(this.currentScene),this.masterHudOverlay&&this.masterContainer.addChild(this.masterHudOverlay),n.settings.RESOLUTION=window.devicePixelRatio},e.prototype.ActivatePreviousScene=function(){this.ActivateScene(this.lastScene)},Object.defineProperty(e.prototype,"MasterHudOverlay",{get:function(){return this.masterHudOverlay},set:function(e){this.masterHudOverlay=e,this.masterContainer.removeChildren(),this.masterContainer.addChild(this.currentScene),this.masterHudOverlay&&this.masterContainer.addChild(this.masterHudOverlay),this.resizeHandler()},enumerable:!0,configurable:!0}),e.prototype.CaptureScene=function(){console.log("Capturing scene, width: "+this.renderer.width+", height: "+this.renderer.height);var e=n.RenderTexture.create(this.renderer.width,this.renderer.height);return this.renderer.render(this.currentScene,e),e},e}();t.SceneManager=a;var o=function(){function e(e,t){this.designedWidth=e,this.designedHeight=t}return e.prototype.GetAvailableSize=function(){return{x:window.innerWidth,y:window.innerHeight}},e.prototype.GetAspectRatio=function(){return this.designedWidth/this.designedHeight},e.prototype.CalculateSize=function(e,t){var i,n;return i=Math.floor(t*e.y),n=Math.floor(window.innerHeight),{x:Math.min(i,e.x),y:Math.min(n,e.y)}},e.prototype.CalculateScale=function(e){return e.x/this.designedWidth},e}();t.DefaultResizer=o},130:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(5),s=function(e){function t(t,i){var n=e.call(this)||this;return n.paused=!1,n.hudScene=null,n._clear=!0,n.sceneManager=t,n.backgroundColor=0,n.Name=i,n}return n.__extends(t,e),t.prototype.onActivate=function(){},t.prototype.onDeactivate=function(){},t.prototype.onResize=function(){},t.prototype.onUpdate=function(e){},t.prototype.onDestroy=function(e){},Object.defineProperty(t.prototype,"BackGroundColor",{get:function(){return this.backgroundColor},set:function(e){this.backgroundColor=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"HudOverlay",{get:function(){return this.hudScene},set:function(e){if(this.hudScene&&this.removeChild(this.hudScene),this.hudScene=e,this.hudScene){var t=this.children.length;this.addChildAt(this.hudScene,t)}},enumerable:!0,configurable:!0}),t.prototype.addChild=function(t){var i=e.prototype.addChild.call(this,t);if(this.hudScene){var n=this.children.length-1;this.setChildIndex(this.hudScene,n)}return i},t.prototype.addChildAt=function(t,i){var n=e.prototype.addChildAt.call(this,t,i);if(this.hudScene){var s=this.children.length-1;this.setChildIndex(this.hudScene,s)}return n},t.prototype.pause=function(){this.paused=!0},t.prototype.resume=function(){this.paused=!1},t.prototype.isPaused=function(){return this.paused},Object.defineProperty(t.prototype,"clear",{get:function(){return this._clear},set:function(e){this._clear=e},enumerable:!0,configurable:!0}),t}(i(0).Container);t.Scene=s},131:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(5);function s(e,t){var i=null,s=null,a={name:null,displayObject:{typeName:"Sprite"},body:null,trigger:null,drop:null},o=e.filter(function(e){return e.name===t.template});o&&o.length>0&&(a=o[0]),i=n.__assign({},a.displayObject,t),a.drop&&(i=n.__assign({},i,{drop:a.drop})),a.body&&(s=a.body);var r=void 0;return(a.trigger||i.trigger)&&(r=n.__assign({},a.trigger,i.trigger)),{templateName:a.name,doDef:i,bdDef:s,trigger:r}}function a(e){for(var t={},i=[],n=0;n<e.length;n++)t[e[n]]||(t[e[n]]=!0,i.push(e[n]));return i}t.GetLevelAssets=function(e,t){for(var i=[],o=void 0,r=0;r<e.levels.length;r++)if(e.levels[r].id===t){o=e.levels[r];break}if(o){o.parallax.forEach(function(e){i=i.concat(e.textures)}),o.assets&&o.assets.length>0&&(i=i.concat(o.assets));var u=e.templates.concat(o.map.templates);o.map.templates.forEach(function(e){if(!e.type||"spawn_point"!==e.type){var t=e.displayObject;t.texture&&("string"==typeof t.texture?i.push(t.texture):i=i.concat(t.texture)),t.sequences&&t.sequences.forEach(function(e){i.push(e.texture)})}}),o.map.entities.forEach(function(e){var t=s(u,e);t.doDef.texture&&("string"==typeof t.doDef.texture?i.push(t.doDef.texture):i=i.concat(t.doDef.texture)),t.doDef.sequences&&t.doDef.sequences.forEach(function(e){i.push(e.texture)})}),o.map.NPC=o.map.NPC||[],o.map.NPC.forEach(function(e){if(e.type&&"spawn_point"===e.type)   ;else{var t=e;t.attack&&(i=i.concat(t.attack));var s=u.filter(function(e){return e.name===t.template});if(s&&s.length>0){var a=s[0],o=n.__assign({},a.displayObject,t);o.texture&&("string"==typeof o.texture?i.push(o.texture):i=i.concat(o.texture)),o.attack&&(i=i.concat(o.attack)),o.sequences&&o.sequences.forEach(function(e){e.texture&&i.push(e.texture)})}}})}return i=a(i)},t.getEntityDefinition=s,t.getUniqueItems=a},159:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(5),s=i(41),a=i(160),o=i(35),r=i(284),u=i(24),l=i(17),c=48,h=function(e){function t(t){var i=e.call(this)||this;return i.textureName=t,i._isDead=!1,i.isLoading=!1,i.attack=function(){var e=i.currentSequence,t=i.fps;o.snd.atkMagic1(),i._direction==l.DirectionH.Left?i.play("latk",t,!1):i.play("ratk",t,!1),i.onComplete=function(n){i.onComplete=null,i.fireBullet(),i.play(e.sequenceName,t)}},i.addAnimations(new s.AnimationSequence("left",i.textureName,[0,1,2],c,c)),i.addAnimations(new s.AnimationSequence("right",i.textureName,[3,4,5],c,c)),i.addAnimations(new s.AnimationSequence("latk",i.textureName,[6,7,8],c,c)),i.addAnimations(new s.AnimationSequence("ratk",i.textureName,[9,10,11],c,c)),i.addAnimations(new s.AnimationSequence("lsquish",i.textureName,[12,13,14,15,16,17],c,c)),i.addAnimations(new s.AnimationSequence("rsquish",i.textureName,[18,19,20,21,22,23],c,c)),i.play("left"),i._direction=l.DirectionH.Left,i}return n.__extends(t,e),Object.defineProperty(t.prototype,"isDead",{get:function(){return this._isDead},set:function(e){e!=this._isDead&&(this._isDead=e,this._isDead&&this.onDeathCallBack&&this.onDeathCallBack())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onDeath",{get:function(){return this.onDeathCallBack},set:function(e){this.onDeathCallBack=e},enumerable:!0,configurable:!0}),t.prototype.squish=function(e){this.isDead=!0;var t=this._direction==l.DirectionH.Left?"lsquish":"rsquish";this.onComplete=e,this.play(t,12,!1),o.snd.mobSquish()},Object.defineProperty(t.prototype,"direction",{get:function(){return this._direction},set:function(e){this._direction!=e&&(this._direction=e,e===l.DirectionH.Left?this.play("left"):this.play("right"))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"attributes",{get:function(){return this._attributes},set:function(e){this._attributes=e},enumerable:!0,configurable:!0}),t.prototype.fireBullet=function(){this.atkTexture.constructor===Array||a.Bullet.emitBullet(this.atkTexture,this.position,u.wp2.playerBody.position,this._attributes[l.AtrType.Atk])},t.prototype.createAI=function(e){switch(e.toLowerCase()){case"basic_static":this._ai=new r.BasicStaticAI(this)}},t.prototype.onUpdate=function(t){e.prototype.onUpdate.call(this,t),this.isDead||this.isLoading||this._ai.onUpdate(t)},t}(s.AnimatedSprite);t.Mob=h},160:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(5),s=i(44),a=i(75),o=i(24),r=i(8),u=function(e){function t(t,i,n,s){var a=e.call(this,t)||this;return a.velocity=i,a.damage=s,a.direction=new PIXI.Point,a.interactionType=666,a.onUpdate=function(){if(!a.isDead){var e=performance.now()/1e3-a.startTime;a.IsDead=a.ttl<e}},a.ttl=n,a.IsDead=!1,a}return n.__extends(t,e),Object.defineProperty(t.prototype,"Direction",{get:function(){return this.direction},set:function(e){var t=e.x*e.x+e.y*e.y;t=1/Math.sqrt(t),this.direction.set(e.x*t,e.y*t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"IsDead",{get:function(){return this.isDead},set:function(e){e!=this.isDead&&(this.isDead=e,this.isDead?this.body&&(this.body.velocity=[0,0]):(this.startTime=performance.now()/1e3,this.body&&(this.body.position=[this.position.x,this.position.y])),this.isDead&&this.onDeath&&this.onDeath(),this.visible=!this.isDead)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"OnDeath",{get:function(){return this.onDeath},set:function(e){this.onDeath=e},enumerable:!0,configurable:!0}),t.reset=function(){t.bullets=[]},t.bullets=[],t.emitBullet=function(e,i,n,u){var l=t.findDeadBullet();if(!l){(l=new t(PIXI.loader.resources[e].texture,200,5,u)).anchor.set(.5),l.scale.set(.5),t.bullets.push(l),r.Global.worldContainer.addChild(l);var c=new s.Circle({radius:l.width/2});c.collisionGroup=a.COL_GRP_BULLET,c.collisionMask=a.COL_GRP_PLAYER|a.COL_GRP_SCENE|a.COL_GRP_GROUND,c.sensor=!0;var h={mass:0,position:[i.x,i.y],angle:0,fixedRotation:!1,angularDamping:0,damping:0},d=new s.Body(h);d.addShape(c),d.setDensity(0),d.gravityScale=0,d.angularVelocity=2,d.collisionResponse=!1,d.type=s.Body.DYNAMIC,d.DisplayObject=l,l.body=d,o.wp2.addBody(d)}l.position=i;var p=n instanceof Float32Array?new PIXI.Point(n[0]-i.x,n[1]-i.y):new PIXI.Point(n.x-i.x,n.y-i.y);return l.Direction=p,l.damage=u,l.IsDead=!1,l.body.velocity[0]=l.Direction.x*l.velocity,l.body.velocity[1]=l.Direction.y*l.velocity,l},t.findDeadBullet=function(){for(var e=0,i=t.bullets.length;e<i;e++){var n=t.bullets[e];if(n.IsDead)return n}return null},t}(PIXI.Sprite);t.Bullet=u},161:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(8),s=i(268),a=["Permanent Marker","Orbitron","Farsan"];console.log("initializing google webfont loader ...",a);try{var o={google:{families:a},active:function(){console.log("fonts preload finished!");var e=n.Global.getScm(),t=new s.BootScene(e);e.AddScene(t),e.ActivateScene(t)}};window.WebFontConfig=o}catch(e){console.log(e)}var r=("https:"===document.location.protocol?"https":"http")+"://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js",u=document.createElement("script");u.src=r,u.type="text/javascript",u.async=!0;var l=document.getElementsByTagName("script")[0];l.parentNode&&l.parentNode.insertBefore(u,l)},17:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.MaxHP=0]="MaxHP",e[e.MaxDust=1]="MaxDust",e[e.RegenHP=2]="RegenHP",e[e.RegenDust=3]="RegenDust"}(t.BaseStatType||(t.BaseStatType={})),function(e){e[e.MaxHP=0]="MaxHP",e[e.HP=1]="HP",e[e.MaxDust=2]="MaxDust",e[e.Dust=3]="Dust",e[e.RegenHP=4]="RegenHP",e[e.RegenDust=5]="RegenDust",e[e.Coins=6]="Coins",e[e.Gold=7]="Gold",e[e.LevelExp=8]="LevelExp",e[e.LevelMaxExp=9]="LevelMaxExp",e[e.TotalExp=10]="TotalExp",e[e.AttributePoints=11]="AttributePoints",e[e.CharacterLevel=12]="CharacterLevel"}(t.StatType||(t.StatType={})),function(e){e[e.LavaBorder=1e3]="LavaBorder",e[e.Lava=1001]="Lava",e[e.Poison=1002]="Poison"}(t.DamageType||(t.DamageType={})),function(e){e[e.HP=0]="HP",e[e.Atk=1]="Atk",e[e.AtkCD=2]="AtkCD",e[e.Def=3]="Def"}(t.AtrType||(t.AtrType={})),function(e){e[e.Left=0]="Left",e[e.Right=1]="Right"}(t.DirectionH||(t.DirectionH={}))},19:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,s=i(5),a=i(0),o=i(263),r=i(67),u=i(20);t.getScm=function(){if(!n){var e={view:document.getElementById("stage"),backgroundColor:0,antialias:!0,transparent:!1,roundPixels:!0,resolution:window.devicePixelRatio};n=new r.SceneManager(u.SCENE_WIDTH,u.SCENE_HEIGHT,e)}return n},t.deleteScm=function(){n&&n.Renderer.destroy(),n=void 0},t.position=new a.Point,t.createParticleEmitter=function(e,t,i){var n={alpha:{start:.8,end:.03},color:{start:"#dcff09",end:"#9f1f1f"},scale:{start:.1,end:.4,minimumScaleMultiplier:1},speed:{start:50,end:3,minimumSpeedMultiplier:1},acceleration:new a.Point,startRotation:{min:0,max:360},rotationSpeed:{min:5,max:20},lifetime:{min:.4,max:1},blendMode:"add",frequency:.01,emitterLifetime:-1,maxParticles:200,pos:new a.Point(0,-24),addAtBack:!1,spawnType:"circle",spawnCircle:{x:0,y:0,r:10}};i&&(n=s.__assign({},n,i));var r=new o.Emitter(e,t,n);return r.emit=!1,r},t.LevelDefinitions={templates:void 0,levels:void 0,quests:void 0}},20:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SCENE_WIDTH=1920,t.SCENE_HEIGHT=1080,t.SCENE_HALF_WIDTH=t.SCENE_WIDTH/2,t.SCENE_HALF_HEIGHT=t.SCENE_HEIGHT/2,t.BTN_WIDTH=120,t.BTN_HEIGHT=60,t.MENU_LINE_HEIGHT=60,t.GUI_FONT="Orbitron",t.SCENE_BACKCOLOR=1122867,t.ANIMATION_FPS_NORMAL=14,t.ANIMATION_FPS_SLOW=4,t.BTN_STYLE={align:"center",padding:0,fontSize:28,fontFamily:t.GUI_FONT,fill:4652029,strokeThickness:1,stroke:0},t.TEXT_STYLE={align:"left",padding:0,fontSize:21,fontFamily:t.GUI_FONT,fill:15066395,strokeThickness:3,stroke:986927},t.MSG_COIN_STYLE={align:"center",padding:0,fontSize:22,fontFamily:t.GUI_FONT,fill:11184640,strokeThickness:3,stroke:9456405},t.MSG_HP_STYLE={align:"center",padding:0,fontSize:24,fontFamily:t.GUI_FONT,fill:9456405,strokeThickness:3,stroke:1118481},t.MSG_EXP_STYLE={align:"center",padding:0,fontSize:24,fontFamily:t.GUI_FONT,fill:8700418,strokeThickness:3,stroke:1122577},t.MSG_WARN_STYLE={align:"center",padding:0,fontSize:27,fontFamily:t.GUI_FONT,fill:16711697,strokeThickness:4,stroke:2236962},t.EXP_BAR_STYLE={align:"center",padding:0,fontSize:13,fontFamily:t.GUI_FONT,fill:1118481,strokeThickness:4,stroke:16777215},t.QUEST_ITEM_STYLE={align:"center",padding:0,fontSize:28,fontFamily:"Farsan",fill:8700658,strokeThickness:4,stroke:1118497},t.QUEST_STYLE={align:"center",padding:0,fontSize:30,fontFamily:"Farsan",fill:16777215,strokeThickness:2,stroke:9077571,dropShadow:!0,dropShadowDistance:6,dropShadowBlur:3}},21:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(19),s=i(32),a=i(43),o=i(17),r=function(){function e(){var t=this;this.baseStats=[],this.attributeStats=[],this.stats=[],this.accumulator=0,this.dpsDecreaseAmount=0,this.hasJumpAttack=!1,this.hasMagicAttack=!1,this.characterLevel=0,this.currentGameLevel=0,this.expForNextLevel=0,this.isBurningBuff=!1,this.buffs=[],this.onUpdate=function(e){for(var i=performance.now()/1e3,n=1e3,a=t.buffs.length;n<a;n++)if(t.buffs[n]&&t.buffs[n]>i){var r=0;switch(n){case o.DamageType.LavaBorder:r=5;break;case o.DamageType.Lava:r=15;break;case o.DamageType.Poison:r=10}var u=.001*e*r;t.dpsDecreaseAmount+=u}if(t.accumulator+=e,t.accumulator>500){if(t.accumulator-=500,t.stats[o.StatType.Dust]<t.stats[o.StatType.MaxDust]){var l=.5*t.stats[o.StatType.RegenDust];t.increaseStat(o.StatType.Dust,l)}if(t.stats[o.StatType.HP]<t.stats[o.StatType.MaxHP]){l=.5*t.stats[o.StatType.RegenHP];t.increaseStat(o.StatType.HP,l)}if(t.dpsDecreaseAmount>=1){var c=Math.floor(t.dpsDecreaseAmount),h={OldValue:t.stats[o.StatType.HP],Amount:-c};s.eventEmitter.emit(s.DAMAGE_TOPIC,h),t.increaseStat(o.StatType.HP,-c),t.dpsDecreaseAmount-=c}}var d=t.isBurningBuff;t.isBurningBuff=t.buffs[o.DamageType.LavaBorder]>i||t.buffs[o.DamageType.Lava]>i,d!==t.isBurning&&s.eventEmitter.emit(s.BURN_TOPIC,{wasBurning:d,isBurning:t.isBurningBuff})},this.scevent={Type:o.StatType.Coins,OldValue:0,NewValue:0,Stats:[]},this.id=0,this.attributeStats[o.BaseStatType.RegenHP]=0,this.attributeStats[o.BaseStatType.RegenDust]=0,this.attributeStats[o.BaseStatType.MaxHP]=0,this.attributeStats[o.BaseStatType.MaxDust]=0,this.stats[o.StatType.Coins]=0,this.stats[o.StatType.Dust]=600,this.stats[o.StatType.TotalExp]=0,this.stats[o.StatType.AttributePoints]=0,this.stats[o.StatType.HP]=120;e.expForLevel[0]=0;for(var i=1;i<1e4;i++)e.expForLevel[i]=e.expForLevel[i-1]+1e3*i;this.rebuildStats()}return Object.defineProperty(e.prototype,"LevelLoader",{get:function(){return this.levelLoader||(this.levelLoader=new a.LevelLoader(n.LevelDefinitions)),this.levelLoader},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isBurning",{get:function(){return this.isBurningBuff},enumerable:!0,configurable:!0}),e.prototype.loadLevel=function(){this.loadUserState(),this.currentLevel=this.LevelLoader.buildLevel(this.currentGameLevel)},e.prototype.saveUserState=function(e){e&&(this.currentGameLevel+=1);this.id,this.stats[o.StatType.Coins],this.stats[o.StatType.Gold],Math.floor(this.stats[o.StatType.Dust]),this.stats[o.StatType.TotalExp],this.stats[o.StatType.AttributePoints],this.stats[o.StatType.HP],this.currentGameLevel},e.prototype.loadUserState=function(){this.id;var e={HP:this.getStat(o.StatType.MaxHP),Exp:this.getStat(o.StatType.TotalExp),Coins:this.getStat(o.StatType.Coins),Dust:this.getStat(o.StatType.MaxDust),Gold:0,AtrPts:0,LastLevel:this.currentGameLevel};console.log("loadUserState() response",e),t.stats.currentGameLevel=e.LastLevel,e.HP<=0&&(e.HP=this.stats[o.StatType.MaxHP]),this.setStat(o.StatType.HP,e.HP),this.setStat(o.StatType.Coins,e.Coins),this.setStat(o.StatType.Gold,e.Gold),this.setStat(o.StatType.Dust,e.Dust),this.setStat(o.StatType.AttributePoints,e.AtrPts),this.setStat(o.StatType.TotalExp,e.Exp),this.rebuildStats()},Object.defineProperty(e.prototype,"HasJumpAtack",{get:function(){return this.hasJumpAttack},set:function(e){this.hasJumpAttack=e},enumerable:!0,configurable:!0}),e.prototype.setStat=function(t,i){this.stats[t]=i,t===o.StatType.TotalExp&&(this.characterLevel=e.findExpLevel(i),this.stats[o.StatType.LevelMaxExp]=e.expForLevel[this.characterLevel+1]-e.expForLevel[this.characterLevel],this.stats[o.StatType.LevelExp]=this.stats[o.StatType.TotalExp]-e.expForLevel[this.characterLevel],this.expForNextLevel=e.expForLevel[this.characterLevel+1]),this.updateEvent(t,i),s.eventEmitter.emit(s.STATCHANGE_TOPIC,this.scevent)},e.prototype.getStat=function(e){return this.stats[e]},e.prototype.increaseStat=function(t,i,n){var a=this.stats[t]+i;n&&a>n&&(a=n),a<0&&(a=0),this.updateEvent(t,a),this.stats[t]=a,t===o.StatType.TotalExp&&(this.stats[o.StatType.LevelExp]=a-e.expForLevel[this.characterLevel],a>=this.expForNextLevel&&(this.characterLevel=e.findExpLevel(a),this.expForNextLevel=e.expForLevel[this.characterLevel+1],this.stats[o.StatType.LevelMaxExp]=this.expForNextLevel-e.expForLevel[this.characterLevel],this.stats[o.StatType.LevelExp]=a-e.expForLevel[this.characterLevel],this.scevent.Type=o.StatType.CharacterLevel,this.scevent.OldValue=this.characterLevel-1,this.scevent.NewValue=this.characterLevel,this.scevent.Stats=this.stats,s.eventEmitter.emit(s.STATCHANGE_TOPIC,this.scevent),a=this.stats[o.StatType.AttributePoints]+5,this.scevent.Type=o.StatType.AttributePoints,this.scevent.OldValue=this.getStat(o.StatType.AttributePoints),this.scevent.NewValue=a,this.setStat(o.StatType.AttributePoints,a),this.scevent.Stats=this.stats,s.eventEmitter.emit(s.STATCHANGE_TOPIC,this.scevent),this.setStat(o.StatType.Dust,this.stats[o.StatType.MaxDust]),this.setStat(o.StatType.HP,this.stats[o.StatType.MaxHP]),this.scevent.Type=t,this.scevent.OldValue=0,this.scevent.NewValue=this.stats[o.StatType.LevelExp],this.scevent.Stats=this.stats)),s.eventEmitter.emit(s.STATCHANGE_TOPIC,this.scevent)},e.findExpLevel=function(t){for(var i=0,n=e.expForLevel.length;i<n;i++)if(t<e.expForLevel[i])return i-1},e.prototype.rebuildStats=function(){this.baseStats[o.BaseStatType.MaxHP]=150+10*this.characterLevel,this.baseStats[o.BaseStatType.MaxDust]=600+50*this.characterLevel,this.baseStats[o.BaseStatType.RegenDust]=2+this.characterLevel/2,this.baseStats[o.BaseStatType.RegenHP]=1+this.characterLevel/2,this.stats[o.StatType.MaxHP]=this.baseStats[o.BaseStatType.MaxHP]*(1+this.attributeStats[o.BaseStatType.MaxHP]/10),this.stats[o.StatType.MaxDust]=this.baseStats[o.BaseStatType.MaxDust]*(1+this.attributeStats[o.BaseStatType.MaxDust]/10),this.stats[o.StatType.RegenHP]=this.baseStats[o.BaseStatType.RegenHP]*(1+this.attributeStats[o.BaseStatType.RegenHP]/10),this.stats[o.StatType.RegenDust]=this.baseStats[o.BaseStatType.RegenDust]*(1+this.attributeStats[o.BaseStatType.RegenDust]/10)},e.prototype.updateEvent=function(e,t){this.scevent.Type=e,this.scevent.OldValue=this.stats[e],this.scevent.NewValue=t,this.scevent.Stats=this.stats},e.expForLevel=[],e}();t.stats=new r},24:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(44),s=i(8),a=i(68),o=i(75),r=function(){return function(e,t){this.BodyA=e,this.BodyB=t}}();t.ContactPair=r;var u=function(){function e(){var e=this;this.contactPairs=[],this.contactWatch=[],this.playerBodyContacts=[],this.fixedTimeStep=1/60,this.beginContact=function(t){var i=null,n=null;if(t.bodyA.shapes[0].collisionGroup===o.COL_GRP_BULLET?(i=t.bodyA,n=t.bodyB):t.bodyB.shapes[0].collisionGroup===o.COL_GRP_BULLET&&(i=t.bodyB,n=t.bodyA),i)e.world.emit({type:"bulletContact",playerHit:n===e.playerBody,bulletBody:i,otherBody:n});else{if(e.playerBody===t.bodyA)return e.playerBodyContacts.push(t.bodyB),void e.world.emit({type:"playerContact",velocity:e.playerBody.velocity,body:t.bodyB});if(e.playerBody===t.bodyB)return e.playerBodyContacts.push(t.bodyA),void e.world.emit({type:"playerContact",velocity:e.playerBody.velocity,body:t.bodyA});var s=e.contactWatch.filter(function(e){return e===t.bodyA.id||e===t.bodyB.id});if(s&&s.length>0){var a=new r(t.bodyA,t.bodyB);e.contactPairs.push(a)}}},this.endContact=function(t){if(!(t.bodyA.shapes[0].collisionGroup===o.COL_GRP_BULLET||t.bodyB.shapes[0].collisionGroup===o.COL_GRP_BULLET)){if(e.playerBody===t.bodyA){var i=e.playerBodyContacts.indexOf(t.bodyB);return e.playerBodyContacts.splice(i,1),void e.world.emit({type:"playerContactEnd",velocity:e.playerBody.velocity,body:t.bodyB})}if(e.playerBody===t.bodyB){i=e.playerBodyContacts.indexOf(t.bodyB);return e.playerBodyContacts.splice(i,1),void e.world.emit({type:"playerContactEnd",velocity:e.playerBody.velocity,body:t.bodyA})}for(var n=-1,s=0;s<e.contactPairs.length;s++){var a=e.contactPairs[s];if(a.BodyA===t.bodyA&&a.BodyB===t.bodyB||a.BodyA===t.bodyB&&a.BodyB===t.bodyA){n=s;break}}n>=0&&e.contactPairs.splice(n,1)}},this.world=new n.World({gravity:[0,-1550]}),this.setupMaterials(),this.ground=new n.Body({mass:0});var t=new n.Plane;t.material=this.materials.get("ground_default"),t.collisionGroup=o.COL_GRP_GROUND,t.collisionMask=o.COL_GRP_SCENE|o.COL_GRP_NPC|o.COL_GRP_PLAYER|o.COL_GRP_BULLET,this.ground.addShape(t),this.world.addBody(this.ground),this.playerBody=new n.Body({mass:42,fixedRotation:!0}),this.playerBody.damping=.001,(t=new n.Circle({radius:24})).collisionGroup=o.COL_GRP_PLAYER,t.collisionMask=o.COL_GRP_GROUND|o.COL_GRP_SCENE|o.COL_GRP_NPC|o.COL_GRP_BULLET,t.material=this.materials.get("player"),this.playerBody.addShape(t),this.world.addBody(this.playerBody),this.world.sleepMode=n.World.BODY_SLEEPING,this.world.on("beginContact",this.beginContact,this),this.world.on("endContact",this.endContact,this)}return e.prototype.clearLevel=function(){for(var e=this.world.bodies,t=e.length-1;t>=0;t--){var i=e[t];i!==this.playerBody&&i!==this.ground&&this.world.removeBody(i)}},Object.defineProperty(e.prototype,"bodies",{get:function(){return this.world.bodies},enumerable:!0,configurable:!0}),e.prototype.on=function(e,t,i){i=i||this,this.world.on(e,t,i)},e.prototype.update=function(e){this.world.step(this.fixedTimeStep,e/1e3),s.Global.position.x=this.playerBody.interpolatedPosition[0],s.Global.position.y=this.playerBody.interpolatedPosition[1]},e.prototype.removeBody=function(e){this.world.removeBody(e)},e.prototype.addBody=function(e){if(e.shapes&&e.shapes.length>0)for(var t=0,i=e.shapes.length;t<i;t++){var n=e.shapes[t];n.materialName&&!n.material&&(n.material=this.materials.get(n.materialName))}this.world.addBody(e)},e.prototype.clearContactsForBody=function(e){if(e!==this.playerBody)for(var t=0;t>-1;){t=-1;for(var i=0;i<this.contactPairs.length;i++){var n=this.contactPairs[i];if(n.BodyA===e||n.BodyB===e){t=i;break}}t>=0&&this.contactPairs.splice(t,1)}else this.playerBodyContacts=[]},e.prototype.getContactsForBody=function(e){for(var t=[],i=0,n=this.contactPairs.length;i<n;i++){var s=this.contactPairs[i];s.BodyA!==e&&s.BodyB!==e||t.push(s)}return t},e.prototype.addContactWatch=function(e){this.contactWatch.push(e.id)},Object.defineProperty(e.prototype,"playerContacts",{get:function(){return this.playerBodyContacts},enumerable:!0,configurable:!0}),e.prototype.setupMaterials=function(){this.materials=new a.Dictionary,this.materials.set("player",new n.Material(n.Material.idCounter++)),this.materials.set("ground_default",new n.Material(n.Material.idCounter++)),this.materials.set("box_default",new n.Material(n.Material.idCounter++)),this.materials.set("box_highfriction",new n.Material(n.Material.idCounter++)),this.materials.set("mob_default",new n.Material(n.Material.idCounter++)),this.materials.set("bumper",new n.Material(n.Material.idCounter++));var e=new n.ContactMaterial(this.materials.get("player"),this.materials.get("ground_default"),{friction:.85,restitution:.1,stiffness:n.Equation.DEFAULT_STIFFNESS,relaxation:n.Equation.DEFAULT_RELAXATION,frictionStiffness:n.Equation.DEFAULT_STIFFNESS,frictionRelaxation:n.Equation.DEFAULT_RELAXATION,surfaceVelocity:0});this.world.addContactMaterial(e);var t=new n.ContactMaterial(this.materials.get("player"),this.materials.get("mob_default"),{friction:.2,restitution:.4,stiffness:n.Equation.DEFAULT_STIFFNESS,relaxation:n.Equation.DEFAULT_RELAXATION,frictionStiffness:n.Equation.DEFAULT_STIFFNESS,frictionRelaxation:n.Equation.DEFAULT_RELAXATION,surfaceVelocity:0});this.world.addContactMaterial(t);var i=new n.ContactMaterial(this.materials.get("player"),this.materials.get("box_default"),{friction:.5,restitution:.25,stiffness:n.Equation.DEFAULT_STIFFNESS,relaxation:n.Equation.DEFAULT_RELAXATION,frictionStiffness:n.Equation.DEFAULT_STIFFNESS,frictionRelaxation:n.Equation.DEFAULT_RELAXATION,surfaceVelocity:0});this.world.addContactMaterial(i);var s=new n.ContactMaterial(this.materials.get("player"),this.materials.get("box_highfriction"),{friction:.7,restitution:.2,stiffness:n.Equation.DEFAULT_STIFFNESS,relaxation:n.Equation.DEFAULT_RELAXATION,frictionStiffness:n.Equation.DEFAULT_STIFFNESS,frictionRelaxation:n.Equation.DEFAULT_RELAXATION,surfaceVelocity:0});this.world.addContactMaterial(s);var o=new n.ContactMaterial(this.materials.get("player"),this.materials.get("bumper"),{friction:.35,restitution:.85,stiffness:Number.MAX_VALUE,relaxation:n.Equation.DEFAULT_RELAXATION,frictionStiffness:Number.MAX_VALUE,frictionRelaxation:n.Equation.DEFAULT_RELAXATION,surfaceVelocity:0});this.world.addContactMaterial(o);var r=new n.ContactMaterial(this.materials.get("box_default"),this.materials.get("ground_default"),{friction:.8,restitution:.3,stiffness:n.Equation.DEFAULT_STIFFNESS,relaxation:n.Equation.DEFAULT_RELAXATION,frictionStiffness:n.Equation.DEFAULT_STIFFNESS,frictionRelaxation:n.Equation.DEFAULT_RELAXATION,surfaceVelocity:0});this.world.addContactMaterial(r)},e}();t.WorldP2=u,t.wp2=new u},264:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(129),s=function(){function e(){var e=this;this.ALT_KEY=18,this.SHIFT_KEY=16,this.CTRL_KEY=17,this.addKeyboardActionHandler=function(t,i){e.stateActions[i]||(e.stateActions[i]=[]),e.stateActions[i].push(t)},this.stateActions={},this.keyboard=[];for(var t=0;t<256;t++)this.keyboard[t]=!1;document.addEventListener("keydown",this.keydown.bind(this),!1),document.addEventListener("keyup",this.keyup.bind(this),!1)}return e.prototype.update=function(e){var t=this.stateActions[e];this.findHandlerAndInvoke(t),t=this.stateActions[n.State.GLOBAL],this.findHandlerAndInvoke(t)},e.prototype.findHandlerAndInvoke=function(e){if(e)for(var t=e.length,i=0;i<t;i++){var n=e[i];n&&n.isAssigned()&&n.handler&&this.keyboard[n.key]&&this.keyboard[this.ALT_KEY]==n.altKey&&this.keyboard[this.SHIFT_KEY]==n.shiftKey&&this.keyboard[this.CTRL_KEY]==n.ctrlKey&&(n.handler(),n.releaseKeyAfterInvoke&&(this.keyboard[n.key]=!1))}},e.prototype.keydown=function(e){this.keyboard[e.which]=!0},e.prototype.keyup=function(e){this.keyboard[e.which]=!1},e.prototype.isKeyDown=function(e){return this.keyboard[e]},e}();t.KeyboardMapper=s;var a=function(){function e(e,t,i,n,s,a,o){void 0===i&&(i=void 0),void 0===n&&(n=!0),void 0===s&&(s=!1),void 0===a&&(a=!1),void 0===o&&(o=!1),this.key=e,this.name=t,this.handler=i,this.releaseKeyAfterInvoke=n,this.shiftKey=s,this.ctrlKey=a,this.altKey=o}return e.prototype.isAssigned=function(){return void 0!==this.handler},e}();t.KeyboardAction=a},265:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){var e=this;this.first=null,this.last=null,this.length=0,this.AddNode=function(t){var i=new s;return i.data=t,i.previous=i.next=null,i.list=e,e.first?(i.previous=e.last,e.last.next=i,e.last=i):(e.first=i,e.last=i),e.length++,i},this.InsertNode=function(t){var i=new s;return i.data=t,i.previous=i.next=null,i.list=e,e.first?(i.next=e.first,e.first.previous=i,e.first=i):(e.first=i,e.last=i),e.length++,i}}return Object.defineProperty(e.prototype,"First",{get:function(){return this.first},set:function(e){this.first=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Last",{get:function(){return this.last},set:function(e){this.last=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Length",{get:function(){return this.length},enumerable:!0,configurable:!0}),e.prototype.RemoveNode=function(e){e.previous&&(e.previous.next=e.next),e.next&&(e.next.previous=e.previous),this.length--},e.prototype.RollLeft=function(){var e=this.first,t=this.first.next;e.next=null,e.previous=this.last,this.last.next=e,this.last=e,this.first=t,this.first.previous=null},e.prototype.forEach=function(e){for(var t=this.first;t;)e(t),t=t.next},e}();t.LinkedList=n;var s=function(){function e(){this.previous=null,this.next=null}return e.prototype.InsertBefore=function(e){var t=this.list.AddNode(e),i=this.previous;t.next=this,t.previous=i,this.previous=t,i&&(i.next=t),t.list=this.list,this.list.First=this.FindFirst()},e.prototype.InsertAfter=function(e){var t=this.list.AddNode(e),i=this.next;t.previous=this,t.next=i,this.next=t,i&&(i.previous=t),t.list=this.list,this.list.Last=this.FindLast()},e.prototype.FindFirst=function(){for(var e=this;e.previous;)e=e.previous;return e},e.prototype.FindLast=function(){for(var e=this;e.next;)e=e.next;return e},e}();t.LinkedListNode=s},266:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(5),s=i(0),a=function(e){function t(t,i,n,a){var o=e.call(this)||this;return o.textureScale=a,o.worldPosition=0,o.spriteBuffer=[],o.spriteOrderList=[],o.totalWidth=0,o.recalculatePosition=function(e){var t=o.spriteOrderList[0],i=o.spriteBuffer[t],n=o.spriteOrderList[o.spriteOrderList.length-1],s=o.spriteBuffer[n],a=(o.worldPosition-e)*o.parallaxFactor;o.updatePositions(a),e>o.worldPosition?i.x+i.width<0&&(o.spriteOrderList.push(o.spriteOrderList.shift()),i.x=s.x+s.width):s.x>o.viewPortSize.x&&(o.spriteOrderList.unshift(o.spriteOrderList.pop()),s.x=i.x-s.width),o.worldPosition=e},o.ViewPortSize=t||new s.Point(100,100),o.parallaxFactor=i||1,o.textureScale=o.textureScale||1,o.setTextures(n),o.worldPosition=0,o.SetViewPortX(1),o}return n.__extends(t,e),Object.defineProperty(t.prototype,"WorldPosition",{get:function(){return this.worldPosition},enumerable:!0,configurable:!0}),t.prototype.SetViewPortX=function(e){this.worldPosition!==e&&this.recalculatePosition(e)},Object.defineProperty(t.prototype,"ViewPortSize",{get:function(){return this.viewPortSize},set:function(e){this.viewPortSize=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ParallaxFactor",{get:function(){return this.parallaxFactor},set:function(e){this.parallaxFactor=e},enumerable:!0,configurable:!0}),t.prototype.setTextures=function(e){for(var t,i=0,n=this.getTexture(e,0),a=n.width*this.textureScale;this.spriteBuffer.length<3||this.spriteBuffer.length<e.length||this.totalWidth<=this.viewPortSize.x+a;){t=i%e.length,(n=this.getTexture(e,t)).rotate=8;var o=new s.Sprite(n);o.x=this.totalWidth,o.scale.set(this.textureScale,this.textureScale),o.anchor.set(0,0),this.spriteBuffer.push(o),this.spriteOrderList.push(this.spriteBuffer.length-1),this.addChild(o),this.totalWidth+=o.width,console.log(n.baseTexture.imageUrl+" -> width: "+n.width+" spr width: "+o.width+", total width: "+this.totalWidth),i++}},t.prototype.getTexture=function(e,t){var i;if("string"==typeof e[t]){var n=s.loader.resources[e[t]];n&&n.texture||console.error("texture not fouind: "+e[t]),i=n.texture}else i=e[t];return i},t.prototype.updatePositions=function(e){for(var t=0;t<this.spriteBuffer.length;t++)this.spriteBuffer[t].position.x+=e},t}(s.Container);t.Parallax=a},267:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(5),s=i(0),a=i(42),o=function(e){function t(t,i,n,a,o,r){void 0===n&&(n=0),void 0===a&&(a=0);var u=e.call(this)||this;return u.isPressed=!1,u.value=0,u.onClick=function(e){return u.setSliderFromeEvent(e),u.Value=u.getCalculatedValue(),!1},u.dragOffsetX=0,u.isDragging=!1,u.onDragStart=function(e){u.isDragging=!0;var t=e.data.getLocalPosition(u.handle);u.dragOffsetX=t.x},u.onDragEnd=function(e){u.isDragging=!1,u.Value=u.getCalculatedValue(),e.stopped=!0},u.onDragMove=function(e){if(u.isDragging)return u.setSliderFromeEvent(e),!1},u.onButtonDown=function(){u.textureControl.frame=u.frameDownControl,u.textureHandle.frame=u.frameDownHandle},u.onButtonUp=function(e){u.applyTextureFrames()},u.onButtonUpOutside=function(){u.applyTextureFrames()},u.onButtonOver=function(){u.control.texture.frame=u.frameHighlightControl,u.textureHandle.frame=u.frameHighlightHandle},u.onButtonOut=function(){u.applyTextureFrames()},u.position.set(n||0,a||0),u.requestedHeight=r,u.requestedWidth=o,u.control=new s.Sprite,u.control.anchor.set(0),u.control.interactive=!0,u.control.buttonMode=!1,u.control.cursor="hover",u.addChild(u.control),u.control.on("pointerdown",u.onButtonDown).on("pointerup",u.onButtonUp).on("pointertap",u.onClick).on("pointerupoutside",u.onButtonUpOutside).on("mouseover",u.onButtonOver).on("mouseout",u.onButtonOut),u.handleWidth=i,u.handle=new s.Sprite,u.handle.position.set(0,u.requestedHeight/2),u.handle.anchor.set(0,.5),u.addChild(u.handle),u.handle.interactive=!0,u.handle.buttonMode=!1,u.handle.cursor="hover",u.handle.on("pointerdown",u.onDragStart).on("pointerup",u.onDragEnd).on("pointerupoutside",u.onDragEnd).on("pointermove",u.onDragMove),u.SetTexture(t,i),u.IsPressed=!1,u.applyTextureFrames(),u.Value=.1,u}return n.__extends(t,e),Object.defineProperty(t.prototype,"Value",{get:function(){return this.value},set:function(e){this.value!==e&&(this.value=e,this.handle.position.x=this.maxX*e,this.emit("valueChange",e),this.emit("valueChanged",e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"outlineColor",{get:function(){return this._outlineColor},set:function(e){this._outlineColor=e,this.control.filters=[new a.OutlineFilter(1,this._outlineColor,.5)]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"IsPressed",{get:function(){return this.isPressed},set:function(e){this.isPressed=e,this.applyTextureFrames()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Text",{get:function(){return this.text},set:function(e){if(this.text&&this.removeChild(this.text),this.text=e,this.text){this.text.anchor.set(.5,.5);var t=this.width/this.scale.x/2,i=this.height/this.scale.y/2;this.text.position.set(t,i),this.addChild(this.text)}},enumerable:!0,configurable:!0}),t.prototype.getCalculatedValue=function(){var e=(this.handle.x-this.minX)/this.maxX;return this.precise_round(e,2)},t.prototype.setSliderFromeEvent=function(e){var t=e.data.getLocalPosition(this.handle.parent);this.isDragging&&this.dragOffsetX&&(t.x-=this.dragOffsetX),this.handle.x=Math.min(this.maxX,Math.max(this.minX,t.x)),this.emit("valueChange",this.getCalculatedValue())},t.prototype.precise_round=function(e,t){var i=Math.pow(10,t),n=(Math.round(e*i+(t>0?1:0)*(Math.sign(e)*(10/Math.pow(100,t))))/i).toFixed(t);return parseFloat(n)},t.prototype.applyTextureFrames=function(){this.textureControl.frame=this.isPressed?this.frameDownControl:this.frameUpControl,this.textureHandle.frame=this.isPressed?this.frameDownHandle:this.frameUpHandle},t.prototype.SetTexture=function(e,t){this.textureControl=new s.Texture(s.loader.resources[e].texture.baseTexture),this.textureControl.baseTexture.scaleMode=s.SCALE_MODES.NEAREST,this.textureHandle=new s.Texture(s.loader.resources[e].texture.baseTexture);var i=this.textureControl.height/3,n=this.textureControl.width-t-1;this.frameUpControl=new s.Rectangle(0,0*i,n,i),this.frameHighlightControl=new s.Rectangle(0,1*i,n,i),this.frameDownControl=new s.Rectangle(0,2*i,n,i);var a=n+1;this.frameUpHandle=new s.Rectangle(a,0*i,t,i),this.frameHighlightHandle=new s.Rectangle(a,1*i,t,i),this.frameDownHandle=new s.Rectangle(a,2*i,t,i),this.applyTextureFrames(),this.control.texture=this.textureControl,this.control.width=this.requestedWidth,this.control.height=this.requestedHeight,this.handle.texture=this.textureHandle,this.handle.height=this.requestedHeight,this.maxX=this.requestedWidth-this.handleWidth,this.minX=0},t}(s.Container);t.Slider=o},268:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(5),s=i(8),a=i(269),o=i(8),r=["assets/gui/cur_default.png","assets/gui/cur_hover.png","assets/gui/cur_target.png","assets/levels.json","assets/quests.json"],u=function(e){function t(t){var i=e.call(this,t,"Boot")||this;return i.onUpdate=function(e){i.spinner&&(i.spinner.rotation+=.05)},i.onActivate=function(){i.loadingMessage=new s.PIXI.Text("booting ...",{fontSize:"36px",fontFamily:"Permanent Marker",fill:65280,dropShadow:!0,stroke:4521796,strokeThickness:1}),i.loadingMessage.anchor.set(.5,.5),i.loadingMessage.position.set(o.SCENE_HALF_WIDTH,o.SCENE_HALF_HEIGHT-80),i.addChild(i.loadingMessage),s.PIXI.loader.reset().add("assets/loading.png").load(i.startPreloading)},i.startPreloading=function(){return n.__awaiter(i,void 0,void 0,function(){var e;return n.__generator(this,function(t){return e=s.PIXI.Texture.fromImage("assets/loading.png"),this.spinner=new s.PIXI.Sprite(e),this.spinner.position.set(o.SCENE_HALF_WIDTH,o.SCENE_HALF_HEIGHT),this.spinner.anchor.set(.5,.5),this.spinner.scale.set(.5),this.addChild(this.spinner),console.log("initializing common assets preloading ...",r),s.PIXI.loader.add(r).load(this.onPreloadFinished),[2]})})},i.onPreloadFinished=function(){return n.__awaiter(i,void 0,void 0,function(){var e,t,i;return n.__generator(this,function(n){return e="url('assets/gui/cur_default.png'),auto","url('assets/gui/cur_hover.png'),auto","url('assets/gui/cur_target.png') 24 24, auto",this.sceneManager.Renderer.plugins.interaction.cursorStyles.default=e,this.sceneManager.Renderer.plugins.interaction.cursorStyles.hover="url('assets/gui/cur_hover.png'),auto",this.sceneManager.Renderer.plugins.interaction.cursorStyles.target="url('assets/gui/cur_target.png') 24 24, auto",document.body.style.cursor=e,s.Global.LevelDefinitions=s.PIXI.loader.resources["assets/levels.json"].data,t=s.PIXI.loader.resources["assets/quests.json"].data,s.Global.LevelDefinitions.quests=t.quests,s.Global.LevelDefinitions.quests.forEach(function(e){e.itemId=e.itemId||0,e.itemsNeeded=e.itemsNeeded||0,e.itemsCollected=0,e.rewardCoins=e.rewardCoins||0,e.rewardExp=e.rewardExp||0}),i=new a.LoaderScene(this.sceneManager),this.sceneManager.AddScene(i),this.sceneManager.ActivateScene(i),[2]})})},i.BackGroundColor=0,i}return n.__extends(t,e),t}(s.Scene);t.BootScene=u},269:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(5),s=i(8),a=i(131),o=i(21),r=i(20),u=i(286),l=i(287),c=i(296),h=i(297),d=function(e){function t(t){var i=e.call(this,t,"Loader")||this;i.preloadAssets=["assets/gui/gui_fs_enter.png","assets/gui/gui_fs_exit.png","assets/gui/gui_options.png","assets/gui/gui_back.png","assets/gui/gui_button1.png","assets/gui/gui_slider1.png","assets/gui/gui_minus.png","assets/gui/heart.png","assets/gui/coin.png","assets/gui/rect.png","assets/gui/stat_panel.png","assets/gui/exp_panel.png","assets/gui/exp_prefill.png","assets/gui/exp_fill.png","assets/gui/panel.png","assets/hero.png","assets/hero-dead.png","assets/star.png","assets/img/effects/flame.png","assets/img/effects/jump_smoke.png","assets/img/effects/load.png"],i.onUpdate=function(e){i.spinner&&(i.spinner.rotation+=.05)},i.onActivate=function(){console.log("downloading level "+o.stats.currentGameLevel+"...");var e=a.GetLevelAssets(s.Global.LevelDefinitions,o.stats.currentGameLevel);e=e.concat(i.preloadAssets),s.PIXI.loader.reset().add(e).load(i.handleLevelLoading).on("progress",i.onProgress)},i.handleLevelLoading=function(){i.sceneManager.HasScene("Main")||(console.log("adding scenes..."),i.sceneManager.AddScene(new l.MainScene(i.sceneManager)),i.sceneManager.AddScene(new c.OptionsScene(i.sceneManager)),i.sceneManager.AddScene(new h.CutScene(i.sceneManager)),i.sceneManager.MasterHudOverlay=new u.MasterHud(i.sceneManager));try{i.sceneManager.GetScene("Main").startLevel()}catch(e){console.log("exception: ",e)}},i.onProgress=function(e,t){var n=e.progress;console.log("progress: "+n.toFixed(0)+"%, asset: "+t.name),i.loadingMessage.text="Loading "+n.toFixed(0)+" %"},i.BackGroundColor=0,i.loadingMessage=new s.PIXI.Text("loading ...",{fontSize:36,fontFamily:"Permanent Marker",fill:65280,dropShadow:!0,align:"center",stroke:4521796,strokeThickness:1}),i.loadingMessage.anchor.set(.5,.5),i.loadingMessage.position.set(r.SCENE_HALF_WIDTH,r.SCENE_HALF_HEIGHT-80),i.addChild(i.loadingMessage);var n=s.PIXI.Texture.fromImage("assets/loading.png");return i.spinner=new s.PIXI.Sprite(n),i.spinner.position.set(r.SCENE_HALF_WIDTH,r.SCENE_HALF_HEIGHT),i.spinner.anchor.set(.5,.5),i.spinner.scale.set(.5),i.addChild(i.spinner),i}return n.__extends(t,e),t}(s.Scene);t.LoaderScene=d},282:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(43),s=i(24),a=i(41),o=i(21),r=i(8),u=function(){function e(e,t,i,n,s,a,o,r){void 0===r&&(r=!0),this.name=e,this.x=t,this.y=i,this.area=n,this.maxMobCount=s,this.respawnSeconds=a,this.entity=o,this.active=r,this.mobCount=0,this.nextSpawn=0,this.nextSpawn=performance.now()/1e3}return Object.defineProperty(e.prototype,"IsActive",{get:function(){return this.active},set:function(e){this.active=e},enumerable:!0,configurable:!0}),e.prototype.onUpdate=function(e){var t=this;if(this.active&&this.mobCount<this.maxMobCount){var i=performance.now()/1e3;if(this.nextSpawn<=i){this.worldContainer||(this.worldContainer=r.Global.getScm().GetScene("Main").worldContainer);var u=n.LevelLoader.createMob(o.stats.currentLevel.templates,this.entity),l=u.DisplayObject,c=this.x+Math.random()*this.area-this.area/2,h=this.y;u.position=[c,h],s.wp2.addBody(u),l.position.set(c,h),l.visible=!1,l.isLoading=!0,this.worldContainer.addChild(l);var d=new a.AnimatedSprite;d.addAnimations(new a.AnimationSequence("load","assets/img/effects/load.png",[0,1,2,3],64,64)),d.anchor.set(.5),d.position.set(c,h+10),d.play("load",4,!0),this.worldContainer.addChild(d),setTimeout(function(){t.worldContainer.removeChild(d),l.isLoading=!1,l.visible=!0},3e3),l.onDeath=function(){console.log("mob died"),t.mobCount--},this.mobCount++,this.nextSpawn=performance.now()/1e3+this.respawnSeconds}}},e}();t.SpawnPoint=u},284:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(5),s=function(e){function t(t){return e.call(this,t)||this}return n.__extends(t,e),t.prototype.canFire=function(){var e=performance.now(),t=2e3*Math.random(),i=this.lastFire+this.attackCD+t<=e;if(i){var n=Math.random();i=i&&n>.3,this.lastFire=performance.now()}return i},t}(i(285).AI);t.BasicStaticAI=s},285:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(19),s=i(17),a=800,o=1050,r=function(){function e(e){var t=this;this.mobEntity=e,this.lastFire=0,this.onUpdate=function(e){t.calcDistance(),t.targetDistance<o&&t.turnTowardsTarget(),t.targetDistance<a?(t.hasTarget=!0,t.canFire()&&(t.mobEntity.attack(),t.lastFire=performance.now())):t.hasTarget=!1},this.attackCD=e.attributes[s.AtrType.AtkCD]}return e.prototype.calcDistance=function(){var e=n.position.x-this.mobEntity.x,t=n.position.y-this.mobEntity.y;this.targetDistance=Math.sqrt(e*e+t*t)},e.prototype.turnTowardsTarget=function(){var e=n.position.x-this.mobEntity.x;e<0&&this.mobEntity.direction!=s.DirectionH.Left?this.mobEntity.direction=s.DirectionH.Left:e>0&&this.mobEntity.direction!=s.DirectionH.Right&&(this.mobEntity.direction=s.DirectionH.Right)},e.prototype.canFire=function(){var e=performance.now();return this.lastFire+this.attackCD<=e},e}();t.AI=r},286:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(5),s=i(8),a=s.SCENE_WIDTH-48,o=4,r=1,u=function(e){function t(t){var i=e.call(this)||this;i.sceneManager=t,["","webkit","moz","ms"].forEach(function(e){return document.addEventListener(e+"fullscreenchange",function(e){i.isFullScreen?n.setTexture("assets/gui/gui_fs_exit.png"):n.setTexture("assets/gui/gui_fs_enter.png"),n.scale.set(r)},!1)});var n=new s.Button("assets/gui/gui_fs_enter.png",a,o);n.onClick=function(){return i.toggleFullScreen()},n.scale.set(r),i.addChild(n);var u=new s.Button("assets/gui/gui_options.png",a-48,o);return u.onClick=function(){return i.sceneManager.ActivateScene("Options")},u.name="BTN_OPTIONS",u.scale.set(r),i.addChild(u),i}return n.__extends(t,e),Object.defineProperty(t.prototype,"isFullScreen",{get:function(){var e=document;return!!(e.fullscreenElement||e.mozFullScreenElement||e.webkitFullscreenElement||e.msFullscreenElement)},enumerable:!0,configurable:!0}),t.prototype.toggleFullScreen=function(){var e=document,t=document.documentElement,i=t.requestFullscreen||t.mozRequestFullScreen||t.webkitRequestFullScreen||t.msRequestFullscreen,n=e.exitFullscreen||e.mozCancelFullScreen||e.webkitExitFullscreen||e.msExitFullscreen;this.isFullScreen?n.call(e):i.call(t)},t}(PIXI.Container);t.MasterHud=u},287:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(5),s=i(44),a=i(31),o=i(8),r=i(24),u=i(288),l=i(290),c=i(21),h=i(160),d=i(32),p=i(20),f=i(291),m=i(43),y=i(292),g=i(293),v=i(35),S=i(294),x=i(17),b=function(e){function t(t){var i=e.call(this,t,"Main")||this;return i.shakeDuration=0,i.shakeEnd=0,i.nextShake=0,i.magnitude=0,i.SHAKE_COUNT=15,i.startGroundShake=function(e){i.shakeEnd=performance.now()+e.milliSeconds,i.magnitude=e.magnitudeInPixels,i.shakeDuration=e.milliSeconds/i.SHAKE_COUNT},i.BackGroundColor=p.SCENE_BACKCOLOR,i.setup(),i}return n.__extends(t,e),t.prototype.onUpdate=function(e){r.wp2.update(e),this.worldContainer.x=p.SCENE_HALF_WIDTH-this.hero.x,this.worldContainer.y=p.SCENE_HEIGHT-70,c.stats.currentLevel.parallax.forEach(function(e){e.SetViewPortX(o.Global.position.x),e.position.x=o.Global.position.x-p.SCENE_HALF_WIDTH});for(var t=r.wp2.bodies,i=0,n=t.length;i<n;i++){var a=(d=t[i]).DisplayObject;if(a&&a.visible&&d.type!==s.Body.STATIC&&(a.position.set(Math.floor(d.interpolatedPosition[0]),Math.floor(d.interpolatedPosition[1])),a.rotation=d.interpolatedAngle),d.Trigger&&"distance"===d.Trigger.type&&this.questMngr.canActivateTrigger(d.Trigger)){var u=this.hero.position.x-d.position[0],l=this.hero.position.y-d.position[1],h=Math.sqrt(u*u+l*l);d.Trigger.distance>=h&&this.questMngr.handleTriggerEvent(d)}}for(i=0,n=r.wp2.playerContacts.length;i<n;i++){var d;(d=r.wp2.playerContacts[i]).DisplayObject&&d.DisplayObject.interactionType&&this.handleInteractiveCollision(d),d.Trigger&&"collision"===d.Trigger.type&&this.questMngr.handleTriggerEvent(d)}for(i=0,n=this.worldContainer.children.length;i<n;i++){var f=this.worldContainer.children[i];f&&f.onUpdate&&f.onUpdate(e)}for(i=0,n=c.stats.currentLevel.spawnPoints.length;i<n;i++)c.stats.currentLevel.spawnPoints[i].onUpdate(e);this.hud.onUpdate(e),c.stats.onUpdate(e);var m=performance.now();if(c.stats.getStat(x.StatType.HP)<=0){this.IsHeroInteractive=!1,this.hero.visible=!1;var y=this.sceneManager.GetScene("CutScene"),g=this.sceneManager.CaptureScene();y.SetBackGround(g,this.scale),y.DeathScene=!0,this.sceneManager.ActivateScene(y)}else if(this.shakeEnd>=m){if(this.nextShake<=m){u=p.SCENE_HALF_WIDTH-this.hero.x,l=p.SCENE_HEIGHT-70;this.shakeX=u+this.randomRange(-this.magnitude/2,this.magnitude/2),this.shakeY=l+this.randomRange(-this.magnitude,this.magnitude),this.magnitude-=this.magnitude/this.SHAKE_COUNT,this.nextShake=m+this.shakeDuration}this.worldContainer.x=this.shakeX,this.worldContainer.y=this.shakeY}},t.prototype.setup=function(){this.worldContainer=new o.PIXI.Container,this.worldContainer.scale.y=-1,this.addChild(this.worldContainer),o.Global.worldContainer=this.worldContainer,this.hero=new u.HeroCharacter(this.worldContainer),this.hero.name="hero",this.hero.x=p.SCENE_HALF_WIDTH,this.worldContainer.addChild(this.hero),this.hero.play("idle",p.ANIMATION_FPS_SLOW),this.hud=new l.StatsHud,this.HudOverlay=this.hud,m.LevelLoader.registerFactory("Lava",function(e){return new f.Lava(e.texture)}),m.LevelLoader.registerFactory("Platform",function(e){return"string"==typeof e.texture?new y.Platform(e.tilesX||1,1,[e.texture]):new y.Platform(e.tilesX||1,e.tilesY||1,e.texture)}),m.LevelLoader.registerFactory("Bumper",function(e){return new g.Bumper}),this.questMngr=new S.QuestManager(this),d.eventEmitter.on(d.BURN_TOPIC,function(e){return e.isBurning?v.snd.burn():v.snd.burnStop()}),d.eventEmitter.on(d.GROUND_SHAKE,this.startGroundShake)},t.prototype.startLevel=function(){var e=this;this.clearLevel(),c.stats.loadLevel(),v.snd.playTrack(c.stats.currentLevel.audioTrack||0),c.stats.currentLevel.parallax.forEach(function(t,i){e.worldContainer.addChildAt(t,i),t.SetViewPortX(c.stats.currentLevel.start[0])}),c.stats.currentLevel.entities.forEach(function(t){e.worldContainer.addChild(t.DisplayObject),t.shapes&&t.shapes.length>0&&r.wp2.addBody(t)}),r.wp2.playerBody.position[0]=c.stats.currentLevel.start[0],r.wp2.playerBody.position[1]=c.stats.currentLevel.start[1],this.questMngr.reset(),this.hero.visible=!0,this.IsHeroInteractive=!0,this.hud.visible=!0,this.sceneManager.ActivateScene(this)},Object.defineProperty(t.prototype,"IsHeroInteractive",{set:function(e){this.hero.IsInteractive!==e&&(this.hero.IsInteractive=e,this.hero.IsInteractive||(this.hero.play("idle",p.ANIMATION_FPS_SLOW),v.snd.idle()))},enumerable:!0,configurable:!0}),t.prototype.collectObject=function(e){var t=this,i=e.DisplayObject,n=i.scale.x,s=i.position.x+45,o=i.position.y+160,r=i.position.x-p.SCENE_HALF_WIDTH,u=p.SCENE_HEIGHT,l=new a.Tween(i.position).to({x:s,y:o},150),c=new a.Tween(i.scale).to({x:n+.5,y:n+.5},500).easing(a.Easing.Linear.None),h=new a.Tween(i.position).to({x:r,y:u},2e3).easing(a.Easing.Back.In).onComplete(function(){return t.worldContainer.removeChild(i)});l.chain(c,h).start(),this.removeEntity(e)},t.prototype.handleInteractiveCollision=function(e){var t=e.DisplayObject;switch(e.DisplayObject.interactionType){case 1:c.stats.increaseStat(x.StatType.Coins,1),this.collectObject(e),this.hud.addInfoMessage(t.position,"+1 coin",p.MSG_COIN_STYLE,-100),v.snd.coin();break;case 2:c.stats.increaseStat(x.StatType.Coins,10),this.collectObject(e),this.hud.addInfoMessage(t.position,"+10 coins",p.MSG_COIN_STYLE,-100),v.snd.coin();break;case 3:c.stats.increaseStat(x.StatType.Coins,100),this.collectObject(e),this.hud.addInfoMessage(t.position,"+100 coins",p.MSG_COIN_STYLE,-100),v.snd.gem();break;case 201:this.hud.addInfoMessage(t.position,"Kendo knowledge acquired!",p.MSG_COIN_STYLE),this.collectObject(e),v.snd.questItem(),this.questMngr.acquireItem(201);break;case 202:this.hud.addInfoMessage(t.position,"1 Ki acquired!",p.MSG_COIN_STYLE),this.collectObject(e),v.snd.questItem(),this.questMngr.acquireItem(202);break;case x.DamageType.LavaBorder:var i=performance.now()/1e3;(!c.stats.buffs[x.DamageType.LavaBorder]||c.stats.buffs[x.DamageType.LavaBorder]<i)&&this.hud.addInfoMessage(t.position,"Burning",p.MSG_WARN_STYLE,100),c.stats.buffs[x.DamageType.LavaBorder]=this.secondsFromNow(1);break;case x.DamageType.Lava:i=performance.now()/1e3;(!c.stats.buffs[x.DamageType.Lava]||c.stats.buffs[x.DamageType.Lava]<i)&&this.hud.addInfoMessage(t.position,"Burning",p.MSG_WARN_STYLE,100),c.stats.buffs[x.DamageType.Lava]=this.secondsFromNow(4)}},t.prototype.secondsFromNow=function(e){var t=performance.now()/1e3;return t+=e},t.prototype.removeEntity=function(e,t){void 0===t&&(t=!1),r.wp2.removeBody(e),t&&this.worldContainer.removeChild(e.DisplayObject),e.DisplayObject=null},t.prototype.clearLevel=function(){var e=this;c.stats.currentLevel&&(c.stats.currentLevel.parallax.forEach(function(t,i){e.worldContainer.removeChild(t)}),c.stats.currentLevel.entities.forEach(function(t){t!==r.wp2.playerBody&&(e.worldContainer.removeChild(t.DisplayObject),r.wp2.removeBody(t),t.DisplayObject=null)}),this.worldContainer.children.filter(function(e){return"hero"!==e.name}).forEach(function(t){e.worldContainer.removeChild(t)}),r.wp2.clearLevel(),h.Bullet.reset())},t.prototype.randomRange=function(e,t){return e+Math.random()*(t-e)},t}(o.Scene);t.MainScene=b},288:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(5),s=i(31),a=i(19),o=i(8),r=i(32),u=i(8),l=i(289),c=i(24),h=i(21),d=i(159),p=i(43),f=i(35),m=i(17),y=64,g=function(e){function t(t){var i=e.call(this)||this;i.container=t,i.onUpdate=function(t){switch(i.position.x=u.Global.position.x,i.position.y=u.Global.position.y,i.IsInteractive&&i.movementCtrl.update(t),i.movementCtrl.MovementState){case l.MovementState.Idle:i.emitterPixies.emit=!1;break;case l.MovementState.Left:case l.MovementState.JumpLeft:i.emitterPixies.emit=i.movementCtrl.IsRunning,i.emitterPixies.minStartRotation=-25,i.emitterPixies.maxStartRotation=25;break;case l.MovementState.Right:case l.MovementState.JumpRight:i.emitterPixies.emit=i.movementCtrl.IsRunning,i.emitterPixies.minStartRotation=155,i.emitterPixies.maxStartRotation=205;break;case l.MovementState.JumpUp:i.emitterPixies.emit=i.movementCtrl.IsRunning,i.emitterPixies.minStartRotation=245,i.emitterPixies.maxStartRotation=295}if(i.emitterPixies.update(.001*t),i.emitterPixies.updateOwnerPos(i.position.x,i.position.y),i.emitterBurn.update(.001*t),i.movementCtrl.IsRunning&&i.movementCtrl.MovementState!==l.MovementState.Idle){h.stats.increaseStat(m.StatType.Dust,.005*-t);var n=8*Math.PI/180;i.rotation=i.movementCtrl.MovementState===l.MovementState.Left?n:-n}else i.rotation=0;i.emitterBurn.emit=h.stats.isBurning,e.prototype.onUpdate.call(i,t)},i.onPlayerMove=function(e){var t=e.newState,n=e.isRunning?1.6*o.ANIMATION_FPS_NORMAL:o.ANIMATION_FPS_NORMAL;switch(t){case l.MovementState.Idle:i.idleAnimationTimeoutHandle&&clearTimeout(i.idleAnimationTimeoutHandle),i.idleAnimationTimeoutHandle=setTimeout(function(){i.play("idle",o.ANIMATION_FPS_SLOW),f.snd.idle()},300);break;case l.MovementState.Left:clearTimeout(i.idleAnimationTimeoutHandle),i.play("left",n),f.snd.walk(e.isRunning);break;case l.MovementState.Right:clearTimeout(i.idleAnimationTimeoutHandle),i.play("right",n),f.snd.walk(e.isRunning);break;case l.MovementState.JumpLeft:clearTimeout(i.idleAnimationTimeoutHandle),i.play("jumpleft",n),f.snd.jump();break;case l.MovementState.JumpRight:clearTimeout(i.idleAnimationTimeoutHandle),i.play("jumpright",n),f.snd.jump();break;case l.MovementState.JumpUp:clearTimeout(i.idleAnimationTimeoutHandle),i.play("jumpup",n),f.snd.jump();break;case l.MovementState.JumpDownLeft:clearTimeout(i.idleAnimationTimeoutHandle),i.play("jumpdownleft",n),f.snd.jumpAttack();break;case l.MovementState.JumpDownRight:clearTimeout(i.idleAnimationTimeoutHandle),i.play("jumpdownright",n),f.snd.jumpAttack()}},i.movementCtrl=new l.MovementController(c.wp2),c.wp2.on("playerContact",i.onPlayerContact,i),c.wp2.on("bulletContact",i.onBulletContact,i);var n={alpha:{start:.7,end:0},blendMode:"normal",frequency:.01,startRotation:{min:265,max:275},color:{start:"#ffffff",end:"#ff5050"},speed:{start:1,end:.5,minimumSpeedMultiplier:1},scale:{start:.2,end:.6},maxParticles:20,lifetime:{min:.25,max:.75},spawnType:"circle",spawnCircle:{x:0,y:y-25,r:25}};i.emitterBurn=a.createParticleEmitter(i,[PIXI.Texture.fromImage("assets/img/effects/flame.png")],n),i.emitterPixies=a.createParticleEmitter(t,[PIXI.Texture.fromImage("assets/star.png")]);var s="assets/hero.png";return i.addAnimations(new u.AnimationSequence("right",s,[18,19,20,21,22,23],y,y)),i.addAnimations(new u.AnimationSequence("left",s,[12,13,14,15,16,17],y,y)),i.addAnimations(new u.AnimationSequence("jumpleft",s,[24,25,26,27,28,29],y,y)),i.addAnimations(new u.AnimationSequence("jumpright",s,[30,31,32,33,34,35],y,y)),i.addAnimations(new u.AnimationSequence("jumpup",s,[1,3,4,6],y,y)),i.addAnimations(new u.AnimationSequence("idle",s,[1,1,0,1,2,3,,4,5,13,12,6,7,11,18,19,0],y,y)),i.addAnimations(new u.AnimationSequence("jumpdownleft",s,[36,37,38],y,y)),i.addAnimations(new u.AnimationSequence("jumpdownright",s,[39,40,41],y,y)),i.addAnimations(new u.AnimationSequence("jumpdown",s,[42,43,44],y,y)),i.anchor.set(.5,.58),r.eventEmitter.on(r.MOVE_TOPIC,i.onPlayerMove),i}return n.__extends(t,e),Object.defineProperty(t.prototype,"IsInteractive",{get:function(){return this.movementCtrl.isInteractive},set:function(e){this.movementCtrl.isInteractive=e},enumerable:!0,configurable:!0}),t.prototype.onPlayerContact=function(e){var t=this,i=e.body,n=e.body.DisplayObject,s=Math.abs(e.velocity[1]);if(s>550){n instanceof d.Mob&&(n.isLoading||this.handleMobInteraction(n,i));var a=this.movementCtrl.MovementState;if(a===l.MovementState.JumpDown||a===l.MovementState.JumpDownLeft||a===l.MovementState.JumpDownRight)return f.snd.jumpContact(),void r.eventEmitter.emit(r.GROUND_SHAKE,{milliSeconds:600,magnitudeInPixels:9})}if(s>450){console.log("Vert velocity: "+s);var o=new u.AnimatedSprite;o.addAnimations(new u.AnimationSequence("smoke","assets/img/effects/jump_smoke.png",[0,1,2,3,4,5],y,y)),o.anchor.set(.5),o.pivot.set(.5),o.x=this.x,o.y=this.y-25,o.alpha=.7,o.rotation=Math.random()*Math.PI,this.container.addChild(o),o.onComplete=function(){return t.container.removeChild(o)},o.play("smoke",6,!1)}s>400&&(f.snd.jumpContact(),console.log("velocity: "+e.velocity))},t.prototype.onBulletContact=function(e){var t=this,i=e.bulletBody.DisplayObject;if(!i.IsDead){if(e.playerHit)f.snd.hitPain(),h.stats.increaseStat(m.StatType.HP,-i.damage);else{var n=new u.AnimatedSprite;n.addAnimations(new u.AnimationSequence("exp","assets/img/effects/slime_atk_exp.png",[0,1,2,3,4,5],32,32)),n.anchor.set(.5),n.pivot.set(.5),n.x=i.x,n.y=i.y,n.alpha=.7,n.rotation=Math.random()*Math.PI,this.container.addChild(n),n.onComplete=function(){return t.container.removeChild(n)},n.play("exp",10,!1),f.snd.bulletHitWall()}i.IsDead=!0}},t.prototype.handleMobInteraction=function(e,t){var i=this,n=t.DisplayObject,s=n;if(s.drop&&Math.random()<=s.drop.chance){var a=p.LevelLoader.createEntity(h.stats.currentLevel.templates,s.drop.entity);this.addDropItem(e,a)}this.removeEntity(t),e.squish(function(){return i.container.removeChild(n)});var o=e.attributes[m.AtrType.HP]/2;h.stats.increaseStat(m.StatType.TotalExp,o)},t.prototype.addDropItem=function(e,t){var i=t.DisplayObject;i.x=e.x,i.y=e.y+40,this.container.addChild(i);var n=i.position.x+75,a=i.position.y+200,o=new s.Tween(i.position).to({x:n,y:a},400).onComplete(function(){t.position=[i.position.x,i.position.y],c.wp2.addBody(t)}),r=i.scale.x,u=i.scale.y,l=new s.Tween(i.scale).to({x:r+.3,y:r+.3},350).easing(s.Easing.Linear.None),h=this.x,d=this.y+8,p=new s.Tween(i.position).to({x:h,y:d},350).easing(s.Easing.Back.In).onUpdate(function(e){t.position=[i.position.x,i.position.y]}).onComplete(function(){return i.scale.set(r,u)});o.chain(l,p).start()},t.prototype.removeEntity=function(e,t){void 0===t&&(t=!1),c.wp2.removeBody(e),t&&this.container.removeChild(e.DisplayObject),e.DisplayObject=null},t}(u.AnimatedSprite);t.HeroCharacter=g},289:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,s=i(8),a=i(21),o=i(32),r=i(17),u=function(){function e(e){this.VELOCITY=150,this.JUMP_FORCE=17900,this.JUMP_ATTACK_FORCE=-14e3,this.JUMP_COOLDOWN=500,this.JUMP_ATTACK_COOLDOWN=2e3,this.JUMP_ATTACK_FREEZE=800,this.nextJumpAllowed=0,this.nextJumpDownAllowed=0,this.movementState=-1,this.kbd=new s.KeyboardMapper,this.isRunning=!1,this.isJumping=!1,this.newState=n.Idle,this._isInteractive=!0,this.world=e}return Object.defineProperty(e.prototype,"isInteractive",{get:function(){return this._isInteractive},set:function(e){this._isInteractive=e,this._isInteractive||(this.isRunning=!1,this.movementState=n.Idle)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsJumping",{get:function(){return this.isJumping},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CanJump",{get:function(){return!this.isJumping&&this.nextJumpAllowed<performance.now()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsRunning",{get:function(){return this.isRunning},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"MovementState",{get:function(){return this.movementState},enumerable:!0,configurable:!0}),e.prototype.StartJump=function(e){var t;e===n.JumpUp?t=[0,this.JUMP_FORCE]:e===n.JumpLeft?t=[.1*-this.JUMP_FORCE,this.JUMP_FORCE]:e===n.JumpRight&&(t=[.1*this.JUMP_FORCE,this.JUMP_FORCE]),this.world.playerBody.applyImpulse(t),this.world.clearContactsForBody(this.world.playerBody),this.nextJumpAllowed=performance.now()+this.JUMP_COOLDOWN},e.prototype.StartJumpDown=function(){var e=this;switch(this.movementState){case n.Left:case n.JumpLeft:this.newState=n.JumpDownLeft;break;case n.Right:case n.JumpRight:this.newState=n.JumpDownRight;break;default:this.newState=n.JumpDown}console.log("state change: "+n[this.movementState]+" -> "+n[this.newState]);var t=[0,this.JUMP_ATTACK_FORCE];this.world.playerBody.setZeroForce(),this.world.playerBody.applyImpulse(t),this.nextJumpDownAllowed=performance.now()+this.JUMP_ATTACK_COOLDOWN,this.isInteractive=!1,setTimeout(function(){return e.isInteractive=!0},this.JUMP_ATTACK_FREEZE),o.eventEmitter.emit(o.MOVE_TOPIC,{newState:this.newState,oldState:this.movementState,isJumping:!0,isRunning:!1}),this.movementState=this.newState},e.prototype.update=function(e){if(this.newState=n.Idle,Math.abs(this.world.playerBody.velocity[1])>.01){var t=this.world.playerContacts.every(function(e){return e.shapes[0].sensor});this.isJumping=t}else this.isJumping=!1;var i=this.calcMovementVelocity();if(this.isJumping&&this._isInteractive)return(this.kbd.isKeyDown(83)||this.kbd.isKeyDown(40))&&a.stats.HasJumpAtack&&this.nextJumpDownAllowed<performance.now()&&this.StartJumpDown(),void(this.world.playerBody.velocity[0]+=i);this.world.playerBody.velocity[0]=i;var s=a.stats.getStat(r.StatType.Dust)>1,u=this.kbd.isKeyDown(16)&&s&&this._isInteractive;if(this.kbd.isKeyDown(65)||this.kbd.isKeyDown(37)?this.newState=n.Left:(this.kbd.isKeyDown(68)||this.kbd.isKeyDown(39))&&(this.newState=n.Right),(this.kbd.isKeyDown(87)||this.kbd.isKeyDown(38)||this.kbd.isKeyDown(32))&&this.CanJump&&(this.movementState===n.Left?this.newState=n.JumpLeft:this.movementState===n.Right?this.newState=n.JumpRight:this.movementState===n.Idle&&(this.newState=n.JumpUp,u=!1)),this.newState!==this.movementState||u!==this.IsRunning){var l=!1;switch(this.newState){case n.JumpLeft:this.StartJump(n.JumpLeft),l=!0;break;case n.JumpRight:this.StartJump(n.JumpRight),l=!0;break;case n.JumpUp:this.StartJump(n.JumpUp),l=!0}o.eventEmitter.emit(o.MOVE_TOPIC,{newState:this.newState,oldState:this.movementState,isJumping:l,isRunning:u})}this.movementState=this.newState,this.isRunning=u},e.prototype.calcMovementVelocity=function(){var e=0;return this.movementState===n.Left||this.movementState===n.JumpLeft?e=-1:this.movementState!==n.Right&&this.movementState!==n.JumpRight||(e=1),this.IsJumping?.2*e:e*this.VELOCITY*(this.IsRunning?2:1)},e}();t.MovementController=u,function(e){e[e.Left=0]="Left",e[e.Right=1]="Right",e[e.Idle=2]="Idle",e[e.JumpLeft=3]="JumpLeft",e[e.JumpRight=4]="JumpRight",e[e.JumpUp=5]="JumpUp",e[e.JumpDownLeft=6]="JumpDownLeft",e[e.JumpDownRight=7]="JumpDownRight",e[e.JumpDown=8]="JumpDown"}(n=t.MovementState||(t.MovementState={}))},290:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(5),s=i(31),a=i(8),o=i(19),r=i(21),u=i(32),l=i(20),c=i(17),h=function(e){function t(){var t=e.call(this)||this;return t.questMsgEndTime=0,t.handleDpsChange=function(e){t.addInfoMessage(a.Global.position,e.Amount+" HP",l.MSG_HP_STYLE,50)},t.handleStatChange=function(e){switch(e.Type){case c.StatType.Coins:t.txtCoins.text=e.NewValue.toString();break;case c.StatType.Dust:t.txtDust.text=e.NewValue.toFixed(0)+" / "+e.Stats[c.StatType.MaxDust].toFixed(0);break;case c.StatType.MaxDust:t.txtDust.text=Math.floor(e.Stats[c.StatType.Dust])+" / "+e.NewValue.toFixed(0);break;case c.StatType.HP:t.txtHP.text=Math.round(e.NewValue)+" / "+e.Stats[c.StatType.MaxHP];break;case c.StatType.MaxHP:t.txtHP.text=Math.round(e.Stats[c.StatType.HP])+" / "+e.NewValue;break;case c.StatType.TotalExp:var i=e.NewValue-e.OldValue;0!=i&&t.addInfoMessage({x:0,y:90},"+"+i+" exp",l.MSG_EXP_STYLE,-50),t.renderExp(e);break;case c.StatType.CharacterLevel:t.handleLevelUp(e)}},t.handleLevelUp=function(e){t.txtExp.text=Math.round(e.Stats[c.StatType.LevelExp])+" / "+e.Stats[c.StatType.LevelMaxExp],t.expFiller.width=1,t.addLvlUpMessage("Level "+e.NewValue),t.txtLevel.text="Level "+r.stats.characterLevel},t.setup(),t}return n.__extends(t,e),t.prototype.setup=function(){this.txtPlayerPosition=new PIXI.Text("",l.QUEST_STYLE),this.txtPlayerPosition.position=new PIXI.Point(l.SCENE_WIDTH,l.SCENE_HEIGHT),this.txtPlayerPosition.anchor.set(1,1),this.addChild(this.txtPlayerPosition),this.panel=new PIXI.Sprite(PIXI.Texture.fromImage("assets/gui/panel.png")),this.panel.texture.baseTexture.scaleMode=PIXI.SCALE_MODES.NEAREST,this.panel.position.set(4),this.panel.name="TriggerMessage",this.panel.anchor.set(0),this.addChild(this.panel),this.txtQuestMessage=new PIXI.Text("",l.QUEST_STYLE),this.txtQuestMessage.position.set(384,100),this.txtQuestMessage.anchor.set(.5,0),this.panel.addChild(this.txtQuestMessage);var e,t;(t=new PIXI.Sprite(PIXI.loader.resources["assets/gui/stat_panel.png"].texture)).texture.baseTexture.scaleMode=PIXI.SCALE_MODES.LINEAR,t.position.set(5,5),this.panel.addChild(t),this.txtHP=new PIXI.Text("0",l.TEXT_STYLE),this.txtHP.position=new PIXI.Point(70,15),t.addChild(this.txtHP),(e=new PIXI.Sprite(PIXI.loader.resources["assets/gui/heart.png"].texture)).position.set(8,9),t.addChild(e),(t=new PIXI.Sprite(PIXI.loader.resources["assets/gui/stat_panel.png"].texture)).texture.baseTexture.scaleMode=PIXI.SCALE_MODES.LINEAR,t.position.set(261,5),this.panel.addChild(t),this.txtDust=new PIXI.Text("0",l.TEXT_STYLE),this.txtDust.position=new PIXI.Point(70,15),t.addChild(this.txtDust),this.emitter=o.createParticleEmitter(t,[PIXI.Texture.fromImage("assets/star.png")]),this.emitter.updateOwnerPos(32,55),this.emitter.maxLifetime=.6,this.emitter.maxParticles=50,this.emitter.emit=!0,(t=new PIXI.Sprite(PIXI.loader.resources["assets/gui/stat_panel.png"].texture)).texture.baseTexture.scaleMode=PIXI.SCALE_MODES.LINEAR,t.position.set(517,5),this.panel.addChild(t),this.txtCoins=new PIXI.Text("0",l.TEXT_STYLE),this.txtCoins.position=new PIXI.Point(70,15),t.addChild(this.txtCoins),(e=new PIXI.Sprite(PIXI.loader.resources["assets/gui/coin.png"].texture)).position.set(8,9),t.addChild(e),(t=new PIXI.Sprite(PIXI.loader.resources["assets/gui/exp_panel.png"].texture)).texture.baseTexture.scaleMode=PIXI.SCALE_MODES.LINEAR,t.position.set(0,l.SCENE_HEIGHT-t.height),this.addChild(t),this.expPreFiller=new PIXI.Sprite(PIXI.loader.resources["assets/gui/exp_prefill.png"].texture),this.expPreFiller.position.set(3,3),t.addChild(this.expPreFiller),this.expFiller=new PIXI.Sprite(PIXI.loader.resources["assets/gui/exp_fill.png"].texture),this.expFiller.position.set(3,3),t.addChild(this.expFiller),this.fillLen=t.width-6,this.txtExp=new PIXI.Text("0 / 1000",l.EXP_BAR_STYLE),this.txtExp.pivot.set(.5),this.txtExp.anchor.set(.5),this.txtExp.position=new PIXI.Point(t.width/2,t.height/2),t.addChild(this.txtExp),this.txtLevel=new PIXI.Text("Level "+r.stats.characterLevel,l.TEXT_STYLE),this.txtLevel.anchor.set(0,.2),this.txtLevel.position.set(t.x+t.width+4,t.y),this.addChild(this.txtLevel),u.eventEmitter.on(u.STATCHANGE_TOPIC,this.handleStatChange),u.eventEmitter.on(u.DAMAGE_TOPIC,this.handleDpsChange)},t.prototype.onUpdate=function(e){this.emitter.update(.001*e),this.txtQuestMessage.visible&&this.questMsgEndTime<performance.now()&&(this.txtQuestMessage.visible=!1,this.onCompleteCB&&this.onCompleteCB()),this.txtPlayerPosition.text=a.Global.position.x.toFixed(0)+", "+a.Global.position.y.toFixed(0)},t.prototype.addInfoMessage=function(e,t,i,n){var a=this,o=i||l.TEXT_STYLE,r=new PIXI.Text(t,o);n=n||0,r.position.set(l.SCENE_HALF_WIDTH+n,l.SCENE_HEIGHT-e.y-70),r.scale.set(1,1),this.addChild(r);var u=e.y>l.SCENE_HALF_HEIGHT?250:-250,c=l.SCENE_HEIGHT-e.y+u;new s.Tween(r.position).to({y:c},2e3).start();var h=new s.Tween(r.scale).to({x:1.6,y:1.6},2200).easing(s.Easing.Linear.None),d=new s.Tween(r).to({alpha:0},3e3).onComplete(function(){return a.removeChild(r)});h.chain(d).start()},t.prototype.addQuestItemMessage=function(e,t){var i=this,n=t||l.QUEST_ITEM_STYLE,a=new PIXI.Text(e,n);a.anchor.set(.5,.5),a.position.set(l.SCENE_HALF_WIDTH,150),this.addChild(a);var o=new s.Tween(a.scale).to({x:1.8,y:1.8},2200).easing(s.Easing.Linear.None),r=new s.Tween(a).to({alpha:0},3e3).onComplete(function(){return i.removeChild(a)});o.chain(r).start()},t.prototype.setQuestMessage=function(e,t,i){void 0===t&&(t=8e3),void 0===i&&(i=null),this.txtQuestMessage.text=e,this.panel.visible=!0,this.txtQuestMessage.visible=!0,this.questMsgEndTime=performance.now()+t,this.onCompleteCB=i},t.prototype.addLvlUpMessage=function(e){var t=this,i={align:"center",padding:0,fontSize:"64px",fontFamily:l.GUI_FONT,fill:3364147,strokeThickness:6,stroke:13421823},n=new PIXI.Text(e,i);n.scale.set(1),n.anchor.set(.5),n.position.set(l.SCENE_HALF_WIDTH,l.SCENE_HEIGHT-a.Global.position.y-70),this.addChild(n);var o=a.Global.position.y>l.SCENE_HALF_HEIGHT?450:-450,r=l.SCENE_HEIGHT-a.Global.position.y+o;new s.Tween(n.position).to({y:r},2e3).start();var u=new s.Tween(n.scale).to({x:1.6,y:1.6},1500).easing(s.Easing.Linear.None),c=new s.Tween(n).to({alpha:.4},6e3).onComplete(function(){return t.removeChild(n)});u.chain(c).start()},t.prototype.renderExp=function(e){this.txtExp.text=Math.round(e.Stats[c.StatType.LevelExp])+" / "+e.Stats[c.StatType.LevelMaxExp],this.txtLevel.text="Level "+r.stats.characterLevel;var t=Math.min(e.Stats[c.StatType.LevelExp]/e.Stats[c.StatType.LevelMaxExp],1);if(0===t)return this.expFiller.width=1,void(this.expPreFiller.position.x=1+this.expFiller.x);this.expPreFiller.position.x=this.expFiller.width+this.expFiller.x;var i=this.fillLen*t|0,n=i-this.expFiller.width;this.expPreFiller.width=1;var a=new s.Tween(this.expPreFiller).to({width:n},1500).easing(s.Easing.Linear.None),o=new s.Tween(this.expFiller).to({width:i},2e3).easing(s.Easing.Bounce.Out);a.chain(o).start()},t}(PIXI.Container);t.StatsHud=h},291:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(5),s=i(41),a=function(e){function t(t){var i=e.call(this)||this;return i.FRAME_SIZE_X=64,i.FRAME_SIZE_Y=128,i.addAnimations(new s.AnimationSequence("lava",t,[0,1,2,3],i.FRAME_SIZE_X,i.FRAME_SIZE_Y)),i.anchor.set(.5,.7),i.play("lava",3),i}return n.__extends(t,e),t}(s.AnimatedSprite);t.Lava=a},292:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(5),s=function(e){function t(t,i,n){void 0===t&&(t=1),void 0===i&&(i=1);var s,a,o,r,u,l=e.call(this)||this;l.scale.set(1,-1);var c,h=n[0];(t>1||n.length>1)&&(s=n[1],a=n[2]),i>1&&(o=n[3],r=n[4],u=n[5]);var d=0;s&&(p=PIXI.loader.resources[s].texture,(c=new PIXI.Sprite(p)).position.set(d+1,0),d+=p.width,l.addChild(c));var p=PIXI.loader.resources[h].texture;if(t>1){var f=p.width*t,m=p.height;(c=new PIXI.extras.TilingSprite(p,f,m)).position.set(d,0),d+=f}else(c=new PIXI.Sprite(p)).position.set(d,0),d+=c.width;l.addChild(c),a&&(p=PIXI.loader.resources[a].texture,(c=new PIXI.Sprite(p)).position.set(d-1,0),d+=c.width,l.addChild(c));var y=t+2;if(i>1)for(d=0;d<y;d++){var g;g=0===d?r:d===y-1?u:o;for(var v=1;v<i;v++)p=PIXI.loader.resources[g].texture,(c=new PIXI.Sprite(p)).position.set(d*c.width,v*c.height),l.addChild(c)}return l}return n.__extends(t,e),t}(PIXI.Container);t.Platform=s},293:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(5),s="assets/img/objects/bumper_01.png",a="assets/img/objects/bumper_rotor_01.png",o=Math.PI/8,r=function(e){function t(){var t=e.call(this,PIXI.loader.resources[s].texture)||this;return t.onUpdate=function(e){var i=t.rotor.rotation-o*e/1e3;t.rotor.rotation=i%Math.PI},t.rotor=new PIXI.Sprite(PIXI.loader.resources[a].texture),t.rotor.anchor.set(.5),t.rotor.pivot.set(.5),t.addChild(t.rotor),t.anchor.set(.5),t}return n.__extends(t,e),t}(PIXI.Sprite);t.Bumper=r},294:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(19),s=i(295),a=i(21),o=i(24),r=i(35),u=i(8),l=i(17),c=function(){function e(e){this.gameScene=e,this.questState=[],this.hud=this.gameScene.HudOverlay}return e.prototype.reset=function(){var e=this;this.questState.forEach(function(t,i){t!=s.QuestState.None&&(e.findQuest(i).itemsCollected=0)}),this.questState=[]},e.prototype.acquireItem=function(e){var t=this.findQuestWithItem(e);t&&(t.itemsCollected++,this.hud.addQuestItemMessage("collected "+t.itemsCollected+" / "+t.itemsNeeded),t.itemsCollected>=t.itemsNeeded&&(this.setQuestState(t.id,s.QuestState.Completed),t.completedMsg&&this.hud.setQuestMessage(t.completedMsg)))},e.prototype.canActivateTrigger=function(e){if(!e||!e.questId)return!1;if(Array.isArray(e.dependsOn))for(var t=0;t<e.dependsOn.length;t++){var i=e.dependsOn[t],n=this.questState[i];if(!n||n!=s.QuestState.Rewarded)return!1}return(e.lastActive||-1e4)+1e4<performance.now()},e.prototype.handleTriggerEvent=function(e){var t=this,i=n.getScm(),o=e.Trigger,l=Math.max(this.getQuestState(o.questId),o.state||0);if(this.canActivateTrigger(o)){o.lastActive=performance.now();var c=this.findQuest(o.questId);switch(o.questId){case 1:l===s.QuestState.None&&(this.setQuestState(o.questId,s.QuestState.Completed),this.gameScene.IsHeroInteractive=!1,this.hud.setQuestMessage(c.welcomeMsg,2e3,function(){t.hud.setQuestMessage(c.completedMsg,2e3,function(){t.gameScene.IsHeroInteractive=!0,t.setQuestState(o.questId,s.QuestState.Finished),t.giveRewards(c),t.setQuestState(o.questId+1,s.QuestState.InProgress),c=t.findQuest(o.questId+1),t.hud.setQuestMessage(c.welcomeMsg,4e3)})}));break;case 2:this.getQuestState(1)>s.QuestState.Finished&&(l===s.QuestState.InProgress?(this.setQuestState(o.questId,s.QuestState.Completed),this.hud.setQuestMessage(c.completedMsg,4e3,function(){t.gameScene.IsHeroInteractive=!0,t.setQuestState(o.questId,s.QuestState.Finished),t.giveRewards(c),c=t.findQuest(o.questId+1),t.setQuestState(o.questId+1,s.QuestState.InProgress),t.hud.setQuestMessage(c.welcomeMsg)})):l>=s.QuestState.Finished&&(c=this.findQuest(o.questId+1),this.hud.setQuestMessage(c.welcomeMsg,4e3)));break;case 3:l===s.QuestState.InProgress&&(this.setQuestState(o.questId,s.QuestState.Finished),this.giveRewards(c),this.gameScene.IsHeroInteractive=!1,this.hud.setQuestMessage(c.completedMsg,4e3,function(){n.getScm().ActivateScene("Loader")}),a.stats.saveUserState(!0),r.snd.win());break;case 201:this.genericQuestHandler(c,l,e,[function(){n.worldContainer.getChildByName("quest_item_201").visible=!0;var e=t.findBodyByName("lock");t.gameScene.removeEntity(e,!0)},function(){},function(){t.setQuestState(o.questId,s.QuestState.Finished),t.giveRewards(c),t.gameScene.IsHeroInteractive=!1,a.stats.saveUserState(!0),r.snd.win(),t.hud.visible=!1;var e=i.GetScene("CutScene");e.SetText(c.finishedMsg,u.QUEST_STYLE);var n=i.CaptureScene();e.SetBackGround(n,t.gameScene.scale),i.ActivateScene(e)}]);break;case 203:this.genericQuestHandler(c,l,e,[function(){a.stats.HasJumpAtack=!0},function(){},function(){},function(){}]);break;default:this.genericQuestHandler(c,l,e)}}},e.prototype.genericQuestHandler=function(e,t,i,n){var a=i.Trigger;switch(t){case s.QuestState.None:this.setQuestState(e.id,s.QuestState.InProgress),this.hud.setQuestMessage(e.welcomeMsg);break;case s.QuestState.InProgress:this.hud.setQuestMessage(e.objectiveMsg);break;case s.QuestState.Completed:e.itemId&&e.itemsCollected>=e.itemsNeeded?(this.setQuestState(e.id,s.QuestState.Finished),a.lastActive=0):this.hud.setQuestMessage(e.completedMsg);break;case s.QuestState.Finished:this.hud.setQuestMessage(e.finishedMsg),this.giveRewards(e),this.gameScene.removeEntity(i,!0)}n&&n[t]&&n[t]()},e.prototype.giveRewards=function(e){r.snd.questItem(),e.rewardExp&&a.stats.increaseStat(l.StatType.TotalExp,e.rewardExp),e.rewardCoins&&a.stats.increaseStat(l.StatType.Coins,e.rewardCoins),this.setQuestState(e.id,s.QuestState.Rewarded)},e.prototype.findQuest=function(e){return n.LevelDefinitions.quests.filter(function(t){return t.id===e})[0]},e.prototype.findQuestWithItem=function(e){var t=this,i=n.LevelDefinitions.quests.filter(function(i){if(i.itemId===e){var n=t.getQuestState(i.id);return n<s.QuestState.Completed&&n>s.QuestState.None}return!1});return i.length>0?i[0]:null},e.prototype.setQuestState=function(e,t){this.questState[e]=t},e.prototype.getQuestState=function(e){return this.questState[e]||s.QuestState.None},e.prototype.findBodyByName=function(e){var t=void 0;return o.wp2.bodies.forEach(function(i){var n=i.DisplayObject;n&&n.name===e&&(t=i)}),t},e}();t.QuestManager=c},295:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.None=0]="None",e[e.InProgress=1]="InProgress",e[e.Completed=2]="Completed",e[e.Finished=3]="Finished",e[e.Rewarded=4]="Rewarded"}(t.QuestState||(t.QuestState={}))},296:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(5),s=i(8),a=i(20),o=function(e){function t(t){var i=e.call(this,t,"Options")||this;return i.currentMusicTrack=0,i.onActivate=function(){i.sceneManager.MasterHudOverlay.children.find(function(e,t){return"BTN_OPTIONS"==e.name}).visible=!1},i.onDeactivate=function(){i.sceneManager.MasterHudOverlay.children.find(function(e,t){return"BTN_OPTIONS"==e.name}).visible=!0},i.setup=function(){var e=new s.PIXI.Text("Options",a.TEXT_STYLE);i.addChild(e),e.anchor.set(.5),e.x=a.SCENE_HALF_WIDTH,e.y=20;var t=a.BTN_WIDTH/3,n=a.SCENE_HEIGHT-a.BTN_HEIGHT-t,o=new s.Button("assets/gui/gui_button1.png",t,n,a.BTN_WIDTH,a.BTN_HEIGHT);o.text=new s.PIXI.Text("Back to game",a.BTN_STYLE),o.onClick=function(){i.sceneManager.ActivatePreviousScene()},i.addChild(o)},i.BackGroundColor=a.SCENE_BACKCOLOR,i.setup(),i}return n.__extends(t,e),t}(s.Scene);t.OptionsScene=o},297:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(5),s=i(130),a=i(128),o=i(35),r=i(8),u=function(e){function t(t){var i=e.call(this,t,"CutScene")||this;return i.deathScene=!1,i.onActivate=function(){if(i.btnContinue.visible=!i.deathScene,i.callout.visible=!i.deathScene,i.corpse.visible=i.deathScene,i.corpse.scale.set(.1),i.btnContinue.text.text=i.deathScene?"Retry":"Continue",i.deathScene){var e=o.snd.getTrack("Carrousel");o.snd.playTrack(e)}},i.deathMessages=["Life sucks and you just died!","You decided to check the\nafterlife. Guess what?\n\nYou are dead!","Owned!\nMore luck next time.","You have died!\nRest in peace.","Your quest has failed.\nMay you find more peace\nin that world than\nyou found in this one.","Here's a picture of\nyour corpse.\n\nNot pretty!","Yep, you're dead.\nMaybe you should consider\nplaying a Barbie game!","Died..."],i.BackGroundColor=1087931,i.corpse=new PIXI.Sprite(PIXI.loader.resources["assets/hero-dead.png"].texture),i.corpse.anchor.set(.5),i.corpse.pivot.set(.5),i.corpse.position.set(r.SCENE_HALF_WIDTH,r.SCENE_HALF_HEIGHT),i.addChild(i.corpse),i.corpseBlurFilter=new PIXI.filters.BlurFilter,i.corpse.filters=[i.corpseBlurFilter],i.callout=new PIXI.Sprite(PIXI.loader.resources["assets/gui/rect.png"].texture),i.callout.anchor.set(.5),i.callout.position.set(r.SCENE_HALF_WIDTH,r.SCENE_HEIGHT/5),i.addChild(i.callout),i.textMessage=new PIXI.Text(""),i.textMessage.anchor.set(.5),i.textMessage.position.set(0,0),i.callout.addChild(i.textMessage),i.btnContinue=new a.Button("assets/gui/gui_button1.png",(r.SCENE_WIDTH-r.BTN_WIDTH)/2,i.callout.height+r.BTN_HEIGHT,r.BTN_WIDTH,r.BTN_HEIGHT),i.btnContinue.text=new PIXI.Text("Continue",r.BTN_STYLE),i.btnContinue.onClick=function(){i.sceneManager.ActivateScene("Loader")},i.addChild(i.btnContinue),i}return n.__extends(t,e),t.prototype.onUpdate=function(e){if(this.deathScene)if(this.corpse.scale.x<2.5){this.corpse.rotation+=.03;var t=this.corpse.scale.x+.01;this.corpse.scale.set(t)}else this.deathScene=!1,this.textMessage.text=this.deathMessages[0|Math.random()*this.deathMessages.length],this.callout.visible=!0,this.btnContinue.visible=!0;else this.corpse.rotation+=.005;var i=Math.max(5,this.corpseBlurFilter.blur+4e-5);this.corpseBlurFilter.blur=i},Object.defineProperty(t.prototype,"DeathScene",{get:function(){return this.deathScene},set:function(e){if(this.deathScene=e,this.deathScene){this.corpseBlurFilter.blur=0;var t=new PIXI.filters.ColorMatrixFilter;t.sepia(),this.backSprite.filters=[t]}else this.backSprite.filters=null},enumerable:!0,configurable:!0}),t.prototype.SetBackGround=function(e,t){this.backSprite?this.backSprite.texture=e:(this.backSprite=new PIXI.Sprite(e),this.addChildAt(this.backSprite,0)),this.backSprite.scale.set(1/t.x,1/t.y)},t.prototype.SetText=function(e,t){this.textMessage.text=e,t&&(this.textMessage.style=new PIXI.TextStyle(t))},t}(s.Scene);t.CutScene=u},32:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.eventEmitter=new PIXI.utils.EventEmitter,t.MOVE_TOPIC="MOVE",t.BURN_TOPIC="BURN",t.STATCHANGE_TOPIC="STATCHANGE",t.DAMAGE_TOPIC="DAMAGE",t.GROUND_SHAKE="SHAKE"},35:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(283),s=function(){function e(){this.musicTrackNames=["assets/audio/Two-Finger-Johnny.mp3","assets/audio/Bumbling-Burglars_Looping.mp3","assets/audio/Bama-Country.mp3","assets/audio/Beachfront-Celebration.mp3","assets/audio/Easy-Jam.mp3","assets/audio/Whiskey-on-the-Mississippi.mp3","assets/audio/ZigZag.mp3","assets/audio/Carrousel.mp3","assets/audio/Disco-Break.mp3"],this.musicTracks=[],this.currentTrack=0,this.previousMusicVolume=.6,this.previousFxVolume=1,this.musicVolume=.6,this.fxVolume=1;for(var e=0,t=this.musicTrackNames.length;e<t;e++){var i=this.musicTrackNames[e];this.musicTracks.push(new n.Howl({src:[i],autoplay:!1,loop:!0,volume:.6}))}this.walkSnd=new n.Howl({src:["assets/audio/effects/step.mp3"],preload:!0,autoplay:!1,loop:!0,volume:1}),this.jumpSnd1=new n.Howl({src:["assets/audio/effects/jump1.mp3"],preload:!0,autoplay:!1,loop:!1,volume:1}),this.jumpSnd2=new n.Howl({src:["assets/audio/effects/jump2.mp3"],preload:!0,autoplay:!1,loop:!1,volume:1}),this.burnSnd=new n.Howl({src:["assets/audio/effects/burn.mp3"],preload:!0,autoplay:!1,loop:!0,volume:1}),this.hurtSnd=new n.Howl({src:["assets/audio/effects/hurt.mp3"],preload:!0,autoplay:!1,loop:!1,volume:1}),this.coinSnd=new n.Howl({src:["assets/audio/effects/coin.mp3"],preload:!0,autoplay:!1,loop:!1,volume:1}),this.gemSnd=new n.Howl({src:["assets/audio/effects/gem.mp3"],preload:!0,autoplay:!1,loop:!1,volume:1}),this.questItemSnd=new n.Howl({src:["assets/audio/effects/quest-item.mp3"],autoplay:!1,loop:!1,volume:1}),this.winSnd=new n.Howl({src:["assets/audio/effects/win.mp3"],autoplay:!1,loop:!1,volume:1}),this.atkMag1=new n.Howl({src:["assets/audio/effects/atk-mag01.mp3"],autoplay:!1,loop:!1,volume:1}),this.hitMag1=new n.Howl({src:["assets/audio/effects/hit-mag01.mp3"],autoplay:!1,loop:!1,volume:1}),this.jumpAtk=new n.Howl({src:["assets/audio/effects/jump-atk01.mp3"],autoplay:!1,loop:!1,volume:1}),this.pain=new n.Howl({src:["assets/audio/effects/pain01.mp3"],autoplay:!1,loop:!1,volume:1}),this.jmpContact=new n.Howl({src:["assets/audio/effects/jmp-contact.mp3"],autoplay:!1,loop:!1,volume:1}),this.woosh=new n.Howl({src:["assets/audio/effects/woosh.mp3"],autoplay:!1,loop:!1,volume:1}),this.squish=new n.Howl({src:["assets/audio/effects/mob-squish.mp3"],autoplay:!1,loop:!1,volume:1}),this.fxDemoSnd=new n.Howl({src:["assets/audio/effects/fx-demo.mp3"],autoplay:!1,loop:!1,volume:1})}return Object.defineProperty(e.prototype,"MusicVolume",{get:function(){return this.musicVolume},set:function(e){this.musicVolume=e,this.backgroundSnd&&this.backgroundSnd.playing()&&this.backgroundSnd.volume(this.musicVolume)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"FxVolume",{get:function(){return this.fxVolume},set:function(e){this.fxVolume=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsFxOn",{get:function(){return this.fxVolume>0},set:function(e){e?this.FxVolume=this.previousFxVolume:(this.previousFxVolume=this.fxVolume,this.FxVolume=0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsMusicOn",{get:function(){return this.musicVolume>0},set:function(e){e?this.MusicVolume=this.previousMusicVolume:(this.previousMusicVolume=this.musicVolume,this.MusicVolume=0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CurrentTrackId",{get:function(){return this.currentTrack},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fxDemo",{get:function(){return this.fxDemoSnd},enumerable:!0,configurable:!0}),e.prototype.jumpAttack=function(){this.walkSnd.pause(),this.jumpAtk.loop(!1),this.jumpAtk.play(),this.jumpAtk.volume(this.fxVolume)},e.prototype.jump=function(){this.walkSnd.pause(),this.jumpSnd1.play(),this.jumpSnd1.volume(this.fxVolume)},e.prototype.idle=function(){this.walkSnd.pause()},e.prototype.walk=function(e){this.walkSnd.rate(e?2:1.2),this.walkSnd.playing()||(this.walkSnd.volume(this.fxVolume),this.walkSnd.play())},e.prototype.atkMagic1=function(){this.atkMag1.volume(this.fxVolume),this.atkMag1.play()},e.prototype.hitMagic1=function(){this.hitMag1.volume(this.fxVolume),this.hitMag1.play()},e.prototype.hitPain=function(){this.pain.volume(this.fxVolume),this.pain.play()},e.prototype.mobSquish=function(){this.squish.volume(this.fxVolume),this.squish.play()},e.prototype.bulletHitWall=function(){this.woosh.volume(this.fxVolume),this.woosh.play()},e.prototype.coin=function(){this.coinSnd.volume(this.fxVolume),this.coinSnd.play()},e.prototype.gem=function(){this.gemSnd.volume(this.fxVolume),this.gemSnd.play()},e.prototype.hurt=function(){this.hurtSnd.volume(this.fxVolume),this.hurtSnd.play()},e.prototype.jumpContact=function(){this.jmpContact.volume(this.fxVolume),this.jmpContact.play()},e.prototype.questItem=function(){this.questItemSnd.volume(this.fxVolume),this.questItemSnd.play()},e.prototype.win=function(){this.backgroundSnd&&this.backgroundSnd.playing()&&this.backgroundSnd.fade(1,0,500),this.hurtSnd.stop(),this.walkSnd.stop(),this.jumpSnd1.stop(),this.jumpSnd2.stop(),this.burnSnd.stop(),this.winSnd.volume(this.fxVolume),this.winSnd.play()},e.prototype.burn=function(){this.burnSnd.playing()||(this.burnSnd.volume(this.fxVolume),this.burnSnd.play()),this.hurt()},e.prototype.burnStop=function(){var e=this;this.burnSnd.fade(1,0,200),setTimeout(function(){return e.burnSnd.stop()},200)},e.prototype.getTrack=function(e){for(var t=0,i=this.musicTrackNames.length;t<i;t++)if(this.musicTrackNames[t].indexOf(e)>=0)return t;return-1},e.prototype.stopTrack=function(){void 0!==this.backgroundSnd&&this.backgroundSnd.stop()},e.prototype.playTrack=function(e){void 0===this.backgroundSnd&&(this.backgroundSnd=this.musicTracks[e],console.log("playTrack "+e,this.backgroundSnd)),this.backgroundSnd!==this.musicTracks[e]?(this.backgroundSnd.stop(),this.backgroundSnd=this.musicTracks[e],this.backgroundSnd.volume(this.musicVolume),this.backgroundSnd.play()):this.backgroundSnd.playing()||(this.backgroundSnd.volume(this.musicVolume),this.backgroundSnd.play()),this.currentTrack=e},e}();t.SoundMan=s,t.snd=new s},41:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(5),s=i(68),a=i(0),o=function(e){function t(){var t=e.call(this)||this;return t.animations=new s.Dictionary,t.currentSequence=null,t.play=function(e,i,n){void 0===n&&(n=!0),t.currentSequence&&t.currentSequence.sequenceName===e||(t.resetAnimation(),t.currentSequence=t.animations.get(e),t.texture=t.currentSequence.textureAtlas,t.texture.frame=t.currentSequence.frames[0],t.isPlaying=!0),t.fps=i||t.fps,t.isLooping=n},t.accumulator=0,t.isPlaying=!1,t.isLooping=!1,t.frameIndex=0,t.currentFps=8,t.pivot.set(.5),t.anchor.set(.5),t.scale.set(1,-1),t}return n.__extends(t,e),t.prototype.addAnimations=function(){for(var e=this,t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];t.forEach(function(t,i){e.animations.set(t.sequenceName,t),e.texture.valid||0!==i||(e.texture=t.textureAtlas,e.texture.frame=t.frames[0])})},t.prototype.clearAnimations=function(){this.stop(),this.currentSequence=null,this.animations.clear()},t.prototype.onUpdate=function(e){if(this.isPlaying&&this.texture.valid&&this.currentSequence){this.accumulator+=e;var t=1e3/this.fps;this.accumulator>t&&(this.accumulator-=t,this.texture.frame=this.currentSequence.frames[++this.frameIndex],this.frameIndex==this.currentSequence.frames.length-1&&(this.frameIndex=0,this.isLooping||(this.isPlaying=!1,this.onCompleteCallBack&&this.onCompleteCallBack(this.currentSequence))))}},Object.defineProperty(t.prototype,"onComplete",{get:function(){return this.onCompleteCallBack},set:function(e){this.onCompleteCallBack=e},enumerable:!0,configurable:!0}),t.prototype.stop=function(){this.isPlaying=!1},Object.defineProperty(t.prototype,"fps",{get:function(){return this.currentFps},set:function(e){this.currentFps=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"loop",{get:function(){return this.isLooping},set:function(e){this.isLooping=e},enumerable:!0,configurable:!0}),t.prototype.resetAnimation=function(){this.stop(),this.currentSequence=null,this.accumulator=0,this.frameIndex=-1},t}(a.Sprite);t.AnimatedSprite=o;var r=function(){function e(e,t,i,n,s){void 0===i&&(i=[]);var o=this;this.sequenceName=e,this.frames=[];var r=a.utils.TextureCache[t];this.textureAtlas=new a.Texture(r.baseTexture);var u=Math.floor(this.textureAtlas.baseTexture.width/n);i.forEach(function(e){var t=Math.floor(e/u),i=e%u,r=new a.Rectangle(i*n,t*s,n,s);o.frames.push(r)})}return Object.defineProperty(e.prototype,"frameCount",{get:function(){return this.frames.length},enumerable:!0,configurable:!0}),e}();t.AnimationSequence=r},43:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(19),s=i(44),a=i(8),o=i(75),r=i(282),u=i(159),l=i(131),c=i(20),h=i(67),d=function(){function e(e){this.gameLevels=e}return e.registerFactory=function(e,t){this.factoryList.set(e,t)},e.prototype.buildLevel=function(e){for(var t,i=void 0,n=0;n<this.gameLevels.levels.length;n++)if(this.gameLevels.levels[n].id===e){i=this.gameLevels.levels[n];break}return i&&(t=this.createLevel(i)),t},e.prototype.createLevel=function(t){var i={parallax:[],entities:[],start:[],audioTrack:t.audioTrack,templates:[],spawnPoints:[]},s=new PIXI.Point(c.SCENE_WIDTH,c.SCENE_HEIGHT);t.parallax.forEach(function(e){var t=new a.Parallax(s,e.parallaxFactor,e.textures,e.scale);t.y=e.y,i.parallax.push(t)});var o=n.LevelDefinitions.templates.concat(t.map.templates);return i.templates=o,t.map.entities.forEach(function(t,n,s){var a=e.createEntity(o,t);i.entities.push(a)}),t.map.NPC=t.map.NPC||[],t.map.NPC.forEach(function(t,n,s){if(t.type&&"spawn_point"===t.type){var a=t,u=a.entity;i.spawnPoints.push(new r.SpawnPoint(a.name,a.xy[0],a.xy[1],a.area,a.maxMobCount,a.respawnSeconds,u))}else{var l=e.createMob(o,t);i.entities.push(l)}}),i.start=t.map.start,i},e.createEntity=function(t,i){var n,a=l.getEntityDefinition(t,i),r=e.buildDisplayObject(a.doDef);return r.name=i.name||i.template,r.templateName=a.templateName,a.bdDef?((n=e.buildPhysicsObject(a.bdDef,r)).shapes.every(function(e){return"ground"===a.bdDef.collisionType?(e.collisionGroup=o.COL_GRP_GROUND,e.collisionMask=o.COL_GRP_PLAYER|o.COL_GRP_NPC|o.COL_GRP_SCENE|o.COL_GRP_BULLET):(e.collisionGroup=o.COL_GRP_SCENE,e.collisionMask=o.COL_GRP_PLAYER|o.COL_GRP_NPC|o.COL_GRP_SCENE|o.COL_GRP_GROUND),!0}),n.DisplayObject=r,a.trigger&&(n.Trigger=a.trigger)):(n=new s.Body).DisplayObject=r,n},e.createMob=function(t,i){var n=l.getEntityDefinition(t,i),s=e.buildDisplayObject(n.doDef);s.name=i.name||i.template,s.templateName=n.templateName,s.attributes=i.attributes||n.doDef.attributes||[],s.createAI(i.ai||"basic_static"),s.atkTexture=i.attack||n.doDef.attack,n.bdDef.material=n.bdDef.material||"mob_default";var a=e.buildPhysicsObject(n.bdDef,s);return a.shapes.every(function(e){return e.collisionGroup=o.COL_GRP_NPC,e.collisionMask=o.COL_GRP_PLAYER|o.COL_GRP_GROUND|o.COL_GRP_SCENE,!0}),a.DisplayObject=s,n.trigger&&(a.Trigger=n.trigger),a},e.buildDisplayObject=function(e){var t;switch(e.typeName){case"Mob":var i=new u.Mob(e.texture);e.sequences&&(i.clearAnimations(),e.sequences.forEach(function(t){var n=t.texture||e.texture,s=new a.AnimationSequence(t.name,n,t.frames,t.framesize[0],t.framesize[1]);i.addAnimations(s)}),i.play(e.sequences[0].name)),e.fps&&(i.fps=e.fps),i.anchor.set(.5,.5),i.typeName="Mob",t=i;break;case"Sensor":(t=new PIXI.DisplayObject).typeName="Sensor";break;case"AnimatedSprite":var n=new a.AnimatedSprite;e.sequences.forEach(function(e,t,i){var s=new a.AnimationSequence(e.name,e.texture,e.frames,e.framesize[0],e.framesize[1]);n.addAnimations(s)}),n.play(e.sequences[0].name,e.fps),n.anchor.set(.5,.5),n.typeName="AnimatedSprite",t=n;break;case"Sprite":var s=PIXI.loader.resources[e.texture].texture,o=new PIXI.Sprite(s);void 0===e.anchor&&(e.anchor=.5),o.anchor.set(e.anchor),void 0===e.pivot&&(e.pivot=.5),void 0===e.scale&&(e.scale=[1,-1]),o.pivot.set(e.pivot),o.typeName="Sprite",t=o;break;default:var r=this.factoryList.get(e.typeName);if(!r)throw"Factory not found for object name: "+e.typeName;t=r(e)}return void 0!==e.visible&&(t.visible=e.visible),t.rotation=e.rotation||0,e.xy&&t.position.set(e.xy[0],e.xy[1]),e.scale&&t.scale.set(e.scale[0],e.scale[1]),e.interactionType&&(t.interactionType=e.interactionType),e.drop&&(t.drop=e.drop),e.tint&&(t.tint=parseInt(e.tint,16)),t},e.buildPhysicsObject=function(e,t,i){var n;void 0===i&&(i=!1);var a=0,o=0;if(e){var r={mass:e.mass,position:e.xy?e.xy:[t.x,t.y],angle:e.angle||t.rotation,fixedRotation:e.fixedRotation||!1,angularDamping:e.angularDamping||.1,damping:e.damping||.1};(n=new s.Body(r)).type=e.type||s.Body.KINEMATIC;var u,l=t;switch(e.shape){case"Circle":var c=32;c=e.size?e.size.constructor===Array?e.size[0]:e.size:l.width,u=new s.Circle({radius:c});break;case"Platform":e.size?(a=e.size[0],o=e.size[1]):(a=Math.abs(l.width),o=Math.abs(l.height)),u=new s.Box({width:a,height:o}),n.position[0]=n.position[0]+a/2,n.position[1]=n.position[1]-o/2;break;case"Box":e.size?(a=e.size[0],o=e.size[1]):l.width?(a=Math.abs(l.width),o=Math.abs(l.height)):(a=t.scale.x*t.getLocalBounds().width,o=t.scale.y*t.getLocalBounds().height),u=new s.Box({width:a,height:o})}e.material&&(u.materialName=e.material),!i&&t.interactionType?(u.sensor=!0,n.type=s.Body.STATIC,n.collisionResponse=!1,n.setDensity(0),console.log("created collectible sensor",u)):"Sensor"===t.typeName&&(u.sensor=!0,n.type=s.Body.STATIC,n.collisionResponse=!1,n.setDensity(0)),n.addShape(u)}return n},e.factoryList=new h.Dictionary,e}();t.LevelLoader=d},67:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(41);t.AnimatedSprite=n.AnimatedSprite,t.AnimationSequence=n.AnimationSequence;var s=i(128);t.Button=s.Button,t.OutlineMode=s.OutlineMode;var a=i(68);t.Dictionary=a.Dictionary;var o=i(264);t.KeyboardMapper=o.KeyboardMapper;var r=i(265);t.LinkedList=r.LinkedList;var u=i(266);t.Parallax=u.Parallax;var l=i(130);t.Scene=l.Scene;var c=i(129);t.SceneManager=c.SceneManager,t.DefaultResizer=c.DefaultResizer;var h=i(267);t.Slider=h.Slider},68:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this._values={},this._keys=[]}return e.prototype.get=function(e){return this._values[e]},e.prototype.contains=function(e){return e in this._values},e.prototype.remove=function(e){var t=this._keys.indexOf(e,0);this._keys.splice(t,1),delete this._values[e]},e.prototype.set=function(e,t){e in this._values||this._keys.push(e),this._values[e]=t},Object.defineProperty(e.prototype,"keys",{get:function(){return this._keys},enumerable:!0,configurable:!0}),e.prototype.getAll=function(){return this._values},e.prototype.getSet=function(e,t){return this.contains(e)||this.set(e,"function"==typeof t?t():t),this.get(e)},e.prototype.clear=function(){this._keys=[],this._values={}},e}();t.Dictionary=n},75:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.COL_GRP_PLAYER=1,t.COL_GRP_NPC=2,t.COL_GRP_SCENE=4,t.COL_GRP_BULLET=8,t.COL_GRP_GROUND=16},8:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(5),s=i(0);t.PIXI=s;var a=i(19);t.Global=a,n.__exportStar(i(67),t),n.__exportStar(i(20),t)}},[[161,0,1,5]]]);
//# sourceMappingURL=main.daf5de28b2b089eeec23.js.map